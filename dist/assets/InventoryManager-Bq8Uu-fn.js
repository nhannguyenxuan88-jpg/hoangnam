import{c as Ue,p as ss,q as ns,u as nr,t as Ra,r as k,j as e,i as W,l as at,v as xt,n as xe,o as br,w as $a,x as ft,a as kr,y as ls,s as q,R as mt,z as os,X as gr,E as Pr,A as ut,C as is,P as rr,D as ds,F as cs,G as us,H as yr,I as hs,h as Ia,B as cr,J as ur,T as Or}from"./index-9wxNecOd.js";import{c as ht}from"./permissions-BO4i-gjC.js";import{g as we}from"./categoryColors-BepW_45H.js";import{r as xs,u as We,w as Da}from"./xlsx-BBWTpfDg.js";import{u as ms,a as jr,C as fs,b as bs,c as qa}from"./CategoriesManager-UoyXuoph.js";import gs from"./LookupManager-D6dHp_Qw.js";import{u as ps,a as vs,b as ks}from"./useInventoryTransactionsRepository-DIEmQzQ3.js";import{b as Ba}from"./useDebtsRepository-Dok2KRq3.js";import{v as pr}from"./validation-CmPBxZwi.js";import{B as za}from"./BarcodeScannerModal-HI1_VeOw.js";import{P as sr}from"./printer-CZA7AzvW.js";import{M as ys}from"./minus-CRXpUkq6.js";import{P as ar}from"./plus-DCVw7leC.js";import"./Icons-Dya5WI08.js";import"./palette-D9yCaBLf.js";import"./cog-DDnvKWbr.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=Ue("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=Ue("CloudDownload",[["path",{d:"M12 13v8l-4-4",key:"1f5nwf"}],["path",{d:"m12 21 4-4",key:"1lfcce"}],["path",{d:"M4.393 15.269A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.436 8.284",key:"ui1hmy"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=Ue("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=Ue("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=Ue("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=Ue("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=Ue("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=Ue("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),Ss=(d,m,b="inventory-export.xlsx")=>{const i=d.map((c,h)=>{var l;return{STT:h+1,"T√™n s·∫£n ph·∫©m":c.name,SKU:c.sku,"Danh m·ª•c":c.category||"","T·ªìn kho":c.stock[m]||0,"Gi√° b√°n l·∫ª":c.retailPrice[m]||0,"Gi√° b√°n s·ªâ":((l=c.wholesalePrice)==null?void 0:l[m])||0,"Gi√° tr·ªã t·ªìn":(c.stock[m]||0)*(c.retailPrice[m]||0),"M√¥ t·∫£":c.description||""}}),x=We.json_to_sheet(i);x["!cols"]=[{wch:5},{wch:30},{wch:15},{wch:20},{wch:10},{wch:15},{wch:15},{wch:15},{wch:40}];const f=We.book_new();We.book_append_sheet(f,x,"T·ªìn kho"),Da(f,b)},Cs=(d="inventory-template.xlsx")=>{const m=[{"T√™n s·∫£n ph·∫©m":"VD: Nh·ªõt Motul 7100 10W40",SKU:"A3B7K9M2 (ho·∫∑c ƒë·ªÉ tr·ªëng - h·ªá th·ªëng t·ª± t·∫°o)","Danh m·ª•c":"Nh·ªõt ƒë·ªông c∆°","S·ªë l∆∞·ª£ng nh·∫≠p":50,"Gi√° b√°n l·∫ª":18e4,"Gi√° b√°n s·ªâ":15e4,"M√¥ t·∫£":"Nh·ªõt cao c·∫•p cho xe c√¥n tay"}],b=We.json_to_sheet(m);b["!cols"]=[{wch:30},{wch:15},{wch:20},{wch:15},{wch:15},{wch:15},{wch:40}];const i=We.book_new();We.book_append_sheet(i,b,"Template"),Da(i,d)},Es=(d,m)=>new Promise((b,i)=>{const x=new FileReader;x.onload=f=>{var c;try{const h=(c=f.target)==null?void 0:c.result,l=/\.csv$/i.test(d.name),t=xs(h,{type:l?"string":"binary"}),r=t.SheetNames[0],s=t.Sheets[r],a=We.sheet_to_json(s,{defval:"",blankrows:!1}),n=E=>E.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").replace(/ƒë/gi,M=>M==="ƒë"?"d":"D"),o=E=>n(String(E).toLowerCase().trim()).replace(/[^a-z0-9]+/g,""),u=E=>{if(E==null||E==="")return 0;if(typeof E=="number")return E;let M=String(E).trim();M=M.replace(/\s+/g,""),M.includes(".")&&M.includes(",")?M=M.replace(/\./g,"").replace(/,/g,"."):M.includes(",")&&!M.includes(".")?M=M.replace(/,/g,"."):M=M.replace(/,/g,"");const H=parseFloat(M);return isNaN(H)?0:H},g={name:["tensanpham","ten","productname","name","tenhang","tenmh"],sku:["sku","mahang","mah","code","ma","masp","mavt"],category:["danhmuc","nhom","loai","category"],quantity:["soluongnhap","soluong","ton","tonkho","sl","qty"],costPrice:["dongianhap","gianhap","costprice","giavon"],retailPrice:["giabanle","giale","giaban","gia","retailprice","giabanra","dongiabanle"],wholesalePrice:["giabansi","giasi","wholesaleprice","giabuon","dongiabansi"],description:["mota","ghichu","note","description"]},j=[],p=a.map((E,M)=>{const H=E||{},w={};Object.keys(H).forEach(F=>{w[o(F)]=H[F]});const C=(F,se)=>{for(const he of g[F]){const de=w[he];if(de!=null&&de!=="")return de}return se},S=String(C("name","")).trim();let N=String(C("sku","")).trim().toUpperCase();(!N||!ss(N))&&(N=ns(),console.log(`üîÑ Generated SKU for "${S}": ${N}`));const A=C("category"),L=u(C("quantity",0)),O=u(C("costPrice",0)),D=u(C("retailPrice",0)),R=u(C("wholesalePrice",0)),z=C("description");if(!S&&Object.values(H).some(F=>F!=="")){const F=Object.values(H).map(se=>String(se).trim()).filter(se=>se!=="");if(F.length>0&&F[0].length>0)return j.push(`H√†ng ${M+2}: Thi·∫øu t√™n s·∫£n ph·∫©m, t·∫°o SKU: ${N}`),null}return S?{name:S,sku:N,category:A,quantity:L,costPrice:O,retailPrice:D,wholesalePrice:R,description:z}:null}).filter(Boolean);b({items:p,errors:j})}catch(h){const l=h instanceof Error?h.message:"Kh√¥ng ƒë·ªçc ƒë∆∞·ª£c d·ªØ li·ªáu";i(new Error(l))}},x.onerror=()=>{i(new Error("L·ªói ƒë·ªçc file"))},/\.csv$/i.test(d.name)?x.readAsText(d,"utf-8"):x.readAsBinaryString(d)}),Ps=()=>{const{sales:d,workOrders:m,currentBranchId:b}=nr(),{data:i,isLoading:x}=Ra({page:1,pageSize:20}),f=(i==null?void 0:i.data)||[],[c,h]=k.useState(""),[l,t]=k.useState("all"),[r,s]=k.useState(null),[a,n]=k.useState("all"),[o,u]=k.useState(null),[g,j]=k.useState(!1),[p,E]=k.useState(!1),M=k.useMemo(()=>{const S=new Set;return f.forEach(N=>{N.category&&S.add(N.category)}),Array.from(S).sort()},[f]),H=k.useMemo(()=>f.filter(S=>{var A,L;if(c){const O=c.toLowerCase(),D=S.name.toLowerCase().includes(O),R=(A=S.sku)==null?void 0:A.toLowerCase().includes(O),z=(L=S.description)==null?void 0:L.toLowerCase().includes(O);if(!D&&!R&&!z)return!1}if(l!=="all"&&S.category!==l)return!1;if(r){const O=S.retailPrice[b]||0;if(O<r.min||O>r.max)return!1}const N=S.stock[b]||0;return!(a==="in-stock"&&N<=0||a==="low-stock"&&N>10||a==="out-of-stock"&&N>0)}),[f,c,l,r,a,b]),C=o?(S=>{const N=f.find(R=>R.id===S);if(!N)return null;const A=d.filter(R=>R.items.some(z=>z.partId===S)),L=m.filter(R=>{var z;return(z=R.partsUsed)==null?void 0:z.some(F=>F.partId===S)}),O=A.reduce((R,z)=>{const F=z.items.find(se=>se.partId===S);return R+((F==null?void 0:F.quantity)||0)},0),D=A.reduce((R,z)=>{const F=z.items.find(se=>se.partId===S);return R+((F==null?void 0:F.sellingPrice)||0)*((F==null?void 0:F.quantity)||0)},0);return{part:N,salesCount:A.length,totalSold:O,revenue:D,lastSold:A.length>0?A.sort((R,z)=>new Date(z.date).getTime()-new Date(R.date).getTime())[0].date:null,workOrdersCount:L.length}})(o):null;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col h-full bg-slate-50 dark:bg-[#0f172a]",children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white dark:bg-[#1e293b] border-b border-slate-200 dark:border-slate-700 p-3 space-y-2",children:[e.jsx("input",{type:"text",value:c,onChange:S=>h(S.target.value),placeholder:"T√¨m s·∫£n ph·∫©m...",className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-slate-100 placeholder-slate-400 text-sm"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>j(!0),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"B·ªô l·ªçc"]}),e.jsxs("div",{className:"px-4 py-2 bg-slate-100 dark:bg-slate-700 rounded-lg text-sm font-medium text-slate-700 dark:text-slate-300",children:[H.length," sp"]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:H.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center",children:[e.jsxs("svg",{className:"w-16 h-16 text-slate-300 dark:text-slate-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"11",cy:"11",r:"7"}),e.jsx("path",{d:"m21 21-4.35-4.35"})]}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-2",children:"Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Th·ª≠ thay ƒë·ªïi b·ªô l·ªçc ho·∫∑c t·ª´ kh√≥a t√¨m ki·∫øm"})]}):e.jsx("div",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:H.map(S=>{const N=S.stock[b]||0,A=S.retailPrice[b]||0;return e.jsxs("button",{onClick:()=>{u(S.id),E(!0)},className:"w-full p-4 flex items-center gap-3 bg-white dark:bg-[#1e293b] hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors text-left",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-slate-100 truncate",children:S.name}),e.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-mono",children:["SKU: ",S.sku]}),S.category&&e.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded-full text-[9px] font-medium mt-0.5 ${we(S.category).bg} ${we(S.category).text}`,children:S.category})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("div",{className:"text-base font-bold text-blue-600 dark:text-blue-400",children:W(A)}),e.jsx("div",{className:"flex items-center gap-1 justify-end mt-1",children:N<=0?e.jsx("span",{className:"px-2 py-0.5 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 text-xs rounded",children:"H·∫øt"}):N<=10?e.jsx("span",{className:"px-2 py-0.5 bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 text-xs rounded",children:N}):e.jsx("span",{className:"px-2 py-0.5 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 text-xs rounded",children:N})})]})]},S.id)})})})]}),g&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>j(!1)}),e.jsxs("div",{className:"relative bg-white dark:bg-[#1e293b] rounded-t-2xl w-full max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"B·ªô l·ªçc t√¨m ki·∫øm"}),e.jsx("button",{onClick:()=>j(!1),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Danh m·ª•c"}),e.jsxs("select",{value:l,onChange:S=>t(S.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-slate-100",children:[e.jsx("option",{value:"all",children:"T·∫•t c·∫£ danh m·ª•c"}),M.map(S=>e.jsx("option",{value:S,children:S},S))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"T·ªìn kho"}),e.jsx("div",{className:"space-y-2",children:[{value:"all",label:"T·∫•t c·∫£"},{value:"in-stock",label:"C√≤n h√†ng"},{value:"low-stock",label:"S·∫Øp h·∫øt (‚â§10)"},{value:"out-of-stock",label:"H·∫øt h√†ng"}].map(S=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"stock",value:S.value,checked:a===S.value,onChange:N=>n(N.target.value),className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:S.label})]},S.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Kho·∫£ng gi√°"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",placeholder:"T·ª´",onChange:S=>s(N=>({min:Number(S.target.value)||0,max:(N==null?void 0:N.max)||999999999})),className:"flex-1 px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-slate-100 text-sm"}),e.jsx("input",{type:"number",placeholder:"ƒê·∫øn",onChange:S=>s(N=>({min:(N==null?void 0:N.min)||0,max:Number(S.target.value)||999999999})),className:"flex-1 px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-slate-100 text-sm"})]}),r&&e.jsx("button",{onClick:()=>s(null),className:"text-xs text-blue-600 dark:text-blue-400 hover:underline",children:"X√≥a b·ªô l·ªçc gi√°"})]})]})]}),e.jsxs("div",{className:"p-4 border-t border-slate-200 dark:border-slate-700 flex gap-2",children:[e.jsx("button",{onClick:()=>{t("all"),n("all"),s(null)},className:"flex-1 px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg text-sm font-medium text-slate-700 dark:text-slate-300",children:"ƒê·∫∑t l·∫°i"}),e.jsx("button",{onClick:()=>j(!1),className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-lg text-sm font-medium",children:"√Åp d·ª•ng"})]})]})]}),p&&C&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>E(!1)}),e.jsxs("div",{className:"relative bg-white dark:bg-[#1e293b] rounded-t-2xl w-full max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Chi ti·∫øt s·∫£n ph·∫©m"}),e.jsx("button",{onClick:()=>E(!1),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 mb-1",children:C.part.name}),e.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-mono",children:["SKU: ",C.part.sku]}),C.part.category&&e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-medium mt-1.5 ${we(C.part.category).bg} ${we(C.part.category).text}`,children:C.part.category})]}),C.part.description&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 dark:text-slate-400 mb-1",children:"M√¥ t·∫£"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:C.part.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800 rounded-lg",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-1",children:"T·ªìn kho"}),e.jsx("div",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:C.part.stock[b]||0})]}),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 mb-1",children:"Gi√° b√°n l·∫ª"}),e.jsx("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:W(C.part.retailPrice[b]||0)})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100 mb-3",children:"Th·ªëng k√™ b√°n h√†ng"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-blue-600 dark:text-blue-400 mb-1",children:"T·ªïng ƒë√£ b√°n"}),e.jsx("div",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:C.totalSold})]}),e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-emerald-100 dark:from-emerald-900/20 dark:to-emerald-800/20 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-emerald-600 dark:text-emerald-400 mb-1",children:"Doanh thu"}),e.jsx("div",{className:"text-xl font-bold text-emerald-900 dark:text-emerald-100",children:W(C.revenue)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-amber-100 dark:from-amber-900/20 dark:to-amber-800/20 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-amber-600 dark:text-amber-400 mb-1",children:"S·ªë ƒë∆°n h√†ng"}),e.jsx("div",{className:"text-2xl font-bold text-amber-900 dark:text-amber-100",children:C.salesCount})]}),C.lastSold&&e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800 rounded-lg",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-1",children:"B√°n g·∫ßn nh·∫•t"}),e.jsx("div",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:at(C.lastSold)})]})]})]})]})]})]})]})},vr="suppliers";async function Os(){try{const{data:d,error:m}=await xe.from(vr).select("*").order("name");return m?xt({code:"supabase",message:"Kh√¥ng th·ªÉ t·∫£i nh√† cung c·∫•p",cause:m}):$a(d||[])}catch(d){return xt({code:"network",message:"L·ªói k·∫øt n·ªëi",cause:d})}}async function Ms(d){var m;try{if(!d.name)return xt({code:"validation",message:"Thi·∫øu t√™n nh√† cung c·∫•p"});const b={id:typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Math.random().toString(36).slice(2)}-${Date.now()}`,name:d.name,phone:d.phone,address:d.address,created_at:new Date().toISOString()},{data:i,error:x}=await xe.from(vr).insert([b]).select().single();if(x||!i){const c=(x==null?void 0:x.message)||(x==null?void 0:x.details)||"T·∫°o nh√† cung c·∫•p th·∫•t b·∫°i";return xt({code:"supabase",message:c,cause:x})}let f=null;try{const{data:c}=await xe.auth.getUser();f=((m=c==null?void 0:c.user)==null?void 0:m.id)||null}catch{}return await br(f,{action:"supplier.create",tableName:vr,recordId:i.id,oldData:null,newData:i}),$a(i)}catch(b){return xt({code:"network",message:"L·ªói k·∫øt n·ªëi khi t·∫°o nh√† cung c·∫•p",cause:b})}}const wr=()=>ft({queryKey:["suppliers"],queryFn:async()=>{const d=await Os();if(!d.ok)throw d.error;return d.data}}),Fa=()=>{const d=kr();return ls({mutationFn:async m=>{const b=await Ms(m);if(!b.ok)throw b.error;return b.data},onSuccess:()=>{d.invalidateQueries({queryKey:["suppliers"]}),q.success("ƒê√£ th√™m nh√† cung c·∫•p")},onError:m=>q.error((m==null?void 0:m.message)||"L·ªói th√™m nh√† cung c·∫•p")})},hr=new Intl.NumberFormat("vi-VN",{minimumFractionDigits:0,maximumFractionDigits:2});function Ts(d){let m=d.replace(/[^0-9.,-]/g,"");const b=m.includes("."),i=m.includes(",");b&&i?m=m.replace(/\./g,"").replace(",","."):i&&!b&&(m=m.replace(",","."));const x=Number(m);return Number.isFinite(x)?x:0}const He=({value:d,onValue:m,placeholder:b,className:i,min:x,max:f,disabled:c,ariaLabel:h})=>{const[l,t]=mt.useState(d?hr.format(d):""),[r,s]=mt.useState(!1);mt.useEffect(()=>{r||t(d?hr.format(d):"")},[d,r]);const a=o=>{const u=o.target.value;t(u);const g=Ts(u);if(x!==void 0&&g<x){m(x);return}if(f!==void 0&&g>f){m(f);return}m(g)},n=()=>{s(!1),t(d?hr.format(d):"")};return e.jsx("input",{type:"text",inputMode:"decimal",value:l,onChange:a,onFocus:()=>s(!0),onBlur:n,placeholder:b,className:i,disabled:c,"aria-label":h})},Ls=({isOpen:d,onClose:m,selectedSupplierId:b,onSelectSupplier:i})=>{const[x,f]=k.useState(""),[c,h]=k.useState(!1),{data:l=[]}=wr(),t=Fa(),[r,s]=k.useState({name:"",phone:"",address:"",note:""}),a=l.filter(o=>{var g,j;const u=x.toLowerCase();return((g=o.name)==null?void 0:g.toLowerCase().includes(u))||((j=o.phone)==null?void 0:j.toLowerCase().includes(u))}),n=async()=>{if(!r.name.trim()){q.error("Vui l√≤ng nh·∫≠p t√™n nh√† cung c·∫•p");return}try{const o=await t.mutateAsync(r);q.success("ƒê√£ th√™m nh√† cung c·∫•p"),i(o.id),s({name:"",phone:"",address:"",note:""}),h(!1),m()}catch(o){q.error((o==null?void 0:o.message)||"L·ªói th√™m nh√† cung c·∫•p")}};return d?e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[110] flex items-end sm:items-center justify-center",onClick:m,children:e.jsxs("div",{onClick:o=>o.stopPropagation(),className:"bg-white dark:bg-slate-800 w-full sm:max-w-md h-[85vh] sm:h-auto sm:max-h-[80vh] rounded-t-3xl sm:rounded-xl overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 p-4 flex items-center justify-between flex-shrink-0",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:c?"Th√™m NCC m·ªõi":"Ch·ªçn nh√† cung c·∫•p"}),e.jsx("button",{onClick:m,className:"text-white text-2xl leading-none",children:"√ó"})]}),c?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:["T√™n nh√† cung c·∫•p ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.name,onChange:o=>s({...r,name:o.target.value}),placeholder:"Nh·∫≠p t√™n NCC",className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"S·ªë ƒëi·ªán tho·∫°i"}),e.jsx("input",{type:"tel",inputMode:"numeric",value:r.phone,onChange:o=>s({...r,phone:o.target.value}),placeholder:"Nh·∫≠p SƒêT",className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"ƒê·ªãa ch·ªâ"}),e.jsx("textarea",{value:r.address,onChange:o=>s({...r,address:o.target.value}),placeholder:"Nh·∫≠p ƒë·ªãa ch·ªâ",rows:3,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Ghi ch√∫"}),e.jsx("textarea",{value:r.note,onChange:o=>s({...r,note:o.target.value}),placeholder:"Ghi ch√∫ th√™m",rows:2,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 resize-none"})]})]}),e.jsxs("div",{className:"p-3 border-t border-slate-200 dark:border-slate-700 flex gap-2 flex-shrink-0",children:[e.jsx("button",{onClick:()=>{h(!1),s({name:"",phone:"",address:"",note:""})},className:"flex-1 py-3 border-2 border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 rounded-xl font-medium active:scale-98 transition-transform",children:"H·ªßy"}),e.jsx("button",{onClick:n,disabled:!r.name.trim()||t.isPending,className:"flex-1 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-300 dark:disabled:bg-slate-600 text-white rounded-xl font-bold active:scale-98 transition-transform disabled:cursor-not-allowed",children:t.isPending?"ƒêang th√™m...":"Th√™m NCC"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-3 border-b border-slate-200 dark:border-slate-700 flex-shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"T√¨m theo t√™n, SƒêT...",value:x,onChange:o=>f(o.target.value),className:"w-full px-4 py-3 pl-10 border border-slate-300 dark:border-slate-600 rounded-xl bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-slate-100"}),e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:a.length===0?e.jsxs("div",{className:"text-center text-slate-500 py-12",children:[e.jsx("div",{className:"text-5xl mb-3",children:"üë§"}),e.jsx("div",{children:"Kh√¥ng t√¨m th·∫•y nh√† cung c·∫•p"})]}):a.map(o=>e.jsxs("div",{onClick:()=>{i(o.id),m()},className:`p-4 rounded-xl border-2 cursor-pointer transition-all ${b===o.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 active:scale-98"}`,children:[e.jsx("div",{className:"font-bold text-slate-900 dark:text-slate-100",children:o.name}),o.phone&&e.jsxs("div",{className:"text-sm text-slate-600 dark:text-slate-400 mt-1",children:["üìû ",o.phone]}),o.address&&e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:["üìç ",o.address]})]},o.id))}),e.jsx("div",{className:"p-3 border-t border-slate-200 dark:border-slate-700 flex-shrink-0",children:e.jsxs("button",{onClick:()=>h(!0),className:"w-full py-4 bg-green-600 hover:bg-green-700 active:scale-98 text-white rounded-xl font-bold flex items-center justify-center gap-2 transition-transform",children:[e.jsx("span",{className:"text-xl",children:"+"}),e.jsx("span",{children:"Th√™m nh√† cung c·∫•p m·ªõi"})]})})]})]})}):null},As=({isOpen:d,onClose:m,parts:b,receiptItems:i,setReceiptItems:x,selectedSupplier:f,setSelectedSupplier:c,searchTerm:h,setSearchTerm:l,onSave:t,discount:r,setDiscount:s,discountType:a,setDiscountType:n,paymentMethod:o,setPaymentMethod:u,paymentType:g,setPaymentType:j,partialAmount:p,setPartialAmount:E,showAddProductModal:M,setShowAddProductModal:H,onAddNewProduct:w,currentBranchId:C})=>{var Oe,ye,Ge;const[S,N]=k.useState(1),[A,L]=k.useState(!1),[O,D]=k.useState(""),R=k.useRef(null),[z,F]=k.useState(!1),[se,he]=k.useState(!1),{data:de=[]}=wr();console.log("üîç GoodsReceiptMobileModal - parts:",(b==null?void 0:b.length)||0,b==null?void 0:b.slice(0,2)),console.log("üîç searchTerm:",h);const Y=(b==null?void 0:b.filter(T=>{var Z,le;if(!h||h.trim()==="")return!0;const te=h.toLowerCase().trim();return((Z=T.name)==null?void 0:Z.toLowerCase().includes(te))||((le=T.sku)==null?void 0:le.toLowerCase().includes(te))}))||[];console.log("üîç filteredParts:",(Y==null?void 0:Y.length)||0);const ee=T=>{i.find(Z=>Z.partId===T.id)?(x(Z=>Z.map(le=>le.partId===T.id?{...le,quantity:le.quantity+1}:le)),q.success(`ƒê√£ tƒÉng s·ªë l∆∞·ª£ng ${T.name}`)):(x(Z=>{var le,ie,_;return[...Z,{partId:T.id,partName:T.name,sku:T.sku,quantity:1,importPrice:((le=T.costPrice)==null?void 0:le[C])||0,sellingPrice:((ie=T.retailPrice)==null?void 0:ie[C])||0,wholesalePrice:((_=T.wholesalePrice)==null?void 0:_[C])||0}]}),q.success(`ƒê√£ th√™m ${T.name} v√†o phi·∫øu nh·∫≠p`)),l(""),setTimeout(()=>{var Z;return(Z=R.current)==null?void 0:Z.focus()},100)},Q=T=>{if(T.preventDefault(),!O.trim())return;const te=O.trim(),Z=b.find(le=>{var ie,_;return((ie=le.sku)==null?void 0:ie.toLowerCase())===te.toLowerCase()||((_=le.name)==null?void 0:_.toLowerCase().includes(te.toLowerCase()))});Z?(ee(Z),D("")):(q.info(`S·∫£n ph·∫©m m√£ ${te} ch∆∞a c√≥. Vui l√≤ng th√™m th√¥ng tin s·∫£n ph·∫©m m·ªõi.`,{autoClose:3e3}),setTimeout(()=>{H(!0)},500))},ue=T=>{console.log("üì∑ Camera scanned:",T);const te=ie=>ie.toLowerCase().replace(/[-\s./\\]/g,""),Z=te(T),le=b.find(ie=>{var _,V;return te(ie.barcode||"")===Z||((_=ie.barcode)==null?void 0:_.toLowerCase())===T.toLowerCase()||te(ie.sku||"")===Z||((V=ie.sku)==null?void 0:V.toLowerCase())===T.toLowerCase()});le?(i.find(_=>_.partId===le.id)?x(_=>_.map(V=>V.partId===le.id?{...V,quantity:V.quantity+1}:V)):(x(_=>{var V,J,K;return[..._,{partId:le.id,partName:le.name,sku:le.sku,quantity:1,importPrice:((V=le.costPrice)==null?void 0:V[C])||0,sellingPrice:((J=le.retailPrice)==null?void 0:J[C])||0,wholesalePrice:((K=le.wholesalePrice)==null?void 0:K[C])||0}]}),q.success(`ƒê√£ th√™m ${le.name}`)),l("")):(q.info(`S·∫£n ph·∫©m m√£ ${T} ch∆∞a c√≥.`),D(T),setTimeout(()=>{H(!0)},500))};k.useEffect(()=>{se&&setTimeout(()=>{var T;return(T=R.current)==null?void 0:T.focus()},100)},[se]);const P=T=>{x(te=>te.filter((Z,le)=>le!==T))},v=i.reduce((T,te)=>T+te.quantity*te.importPrice,0),$=a==="percent"?Math.round(v*r/100):r,G=Math.max(0,v-$),ce=()=>{if(!f){alert("Vui l√≤ng ch·ªçn nh√† cung c·∫•p");return}N(2)},Re=()=>{alert("Ch·ª©c nƒÉng l∆∞u nh√°p ƒëang ph√°t tri·ªÉn")};return d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[100] flex items-end justify-center sm:hidden",children:e.jsx("div",{className:"bg-white dark:bg-slate-800 w-full h-[95vh] rounded-t-3xl overflow-hidden flex flex-col",children:S===1?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 p-4 flex items-center justify-between flex-shrink-0",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:m,className:"text-white text-2xl leading-none",children:"√ó"}),e.jsx("h2",{className:"text-lg font-bold text-white",children:"T·∫°o phi·∫øu nh·∫≠p kho"})]})}),e.jsx("div",{className:"p-3 bg-slate-50 dark:bg-slate-900 border-b border-slate-200 dark:border-slate-700 flex-shrink-0",children:e.jsx("div",{onClick:()=>L(!0),className:`p-4 rounded-xl border-2 cursor-pointer active:scale-98 transition-transform ${f?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-dashed border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-1",children:"NH√Ä CUNG C·∫§P"}),e.jsx("div",{className:"font-bold text-slate-900 dark:text-slate-100",children:((Oe=de.find(T=>T.id===f))==null?void 0:Oe.name)||""}),((ye=de.find(T=>T.id===f))==null?void 0:ye.phone)&&e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-400 mt-1",children:(Ge=de.find(T=>T.id===f))==null?void 0:Ge.phone})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"üë§"}),e.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Ch·ªçn nh√† cung c·∫•p"})]})}),e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 sticky top-0 z-10 flex-shrink-0 space-y-2",children:[se&&e.jsxs("form",{onSubmit:Q,className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),e.jsx("input",{ref:R,type:"text",placeholder:"Nh·∫≠p SKU ho·∫∑c qu√©t...",value:O,onChange:T=>D(T.target.value),className:"w-full px-4 py-3 pl-11 border-2 border-blue-400 dark:border-blue-600 rounded-xl bg-blue-50 dark:bg-blue-900/20 text-slate-900 dark:text-slate-100 text-base font-mono placeholder:text-blue-500/70"}),O&&e.jsx("button",{type:"button",onClick:()=>D(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("button",{type:"button",onClick:()=>{he(!1),D("")},className:"w-12 h-[50px] flex items-center justify-center border-2 border-slate-300 dark:border-slate-600 rounded-xl text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-700 transition-all",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",placeholder:"Ho·∫∑c t√¨m ki·∫øm th·ªß c√¥ng...",value:h,onChange:T=>l(T.target.value),className:"w-full px-4 py-3 pl-10 border border-slate-300 dark:border-slate-600 rounded-xl bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-slate-100"}),e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),!se&&e.jsx("button",{type:"button",onClick:()=>{he(!0)},className:"w-12 h-[50px] flex items-center justify-center border-2 border-blue-400 dark:border-blue-600 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 rounded-xl transition-all active:scale-95",title:"Qu√©t m√£ v·∫°ch",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})})}),e.jsx("button",{type:"button",onClick:()=>F(!0),className:"w-12 h-[50px] flex items-center justify-center bg-gradient-to-br from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl shadow-lg transition-all active:scale-95",children:e.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-3 bg-slate-50 dark:bg-slate-900",children:[!b||b.length===0?e.jsxs("div",{className:"text-center text-slate-500 py-12",children:[e.jsx("div",{className:"text-5xl mb-3",children:"‚è≥"}),e.jsx("div",{children:"ƒêang t·∫£i danh s√°ch s·∫£n ph·∫©m..."})]}):Y.length===0?e.jsxs("div",{className:"text-center text-slate-500 py-12",children:[e.jsx("div",{className:"text-5xl mb-3",children:"üì¶"}),e.jsx("div",{children:"Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m"}),h&&e.jsxs("div",{className:"text-sm mt-2",children:['T√¨m ki·∫øm: "',h,'"']})]}):e.jsx("div",{className:"space-y-2",children:Y.map(T=>{var Z,le;const te=i.find(ie=>ie.partId===T.id);return e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-bold text-slate-900 dark:text-slate-100 text-base leading-tight mb-1",children:T.name}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400 font-mono",children:T.sku}),T.category&&e.jsx("span",{className:`inline-flex items-center px-1.5 py-0 rounded-full text-[9px] font-medium ${we(T.category).bg} ${we(T.category).text}`,children:T.category})]}),e.jsxs("div",{className:"mt-2 flex gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500 dark:text-slate-400",children:["Nh·∫≠p:"," "]}),e.jsx("span",{className:"font-medium text-orange-600 dark:text-orange-400",children:W(((Z=T.costPrice)==null?void 0:Z[C])||0)})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500 dark:text-slate-400",children:["B√°n:"," "]}),e.jsx("span",{className:"font-medium text-green-600 dark:text-green-400",children:W(((le=T.retailPrice)==null?void 0:le[C])||0)})]})]}),te&&e.jsx("div",{className:"mt-2 text-sm",children:e.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:["ƒê√£ th√™m: ",te.quantity," √ó"," ",W(te.importPrice)]})})]}),e.jsx("button",{onClick:()=>ee(T),className:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-600 text-white flex items-center justify-center text-2xl leading-none active:scale-95 transition-transform",children:"+"})]})},T.id)})}),e.jsxs("button",{onClick:()=>H(!0),className:"w-full mt-3 py-4 border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-xl text-slate-500 dark:text-slate-400 hover:border-blue-400 hover:text-blue-600 transition-colors flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"+"}),e.jsx("span",{className:"font-medium",children:"T·∫°o s·∫£n ph·∫©m m·ªõi"})]})]}),i.length>0&&e.jsx("div",{className:"flex-shrink-0 bg-gradient-to-t from-white via-white dark:from-slate-800 dark:via-slate-800 to-transparent pt-6 pb-safe pb-4 px-3",children:e.jsxs("button",{onClick:ce,className:"w-full bg-blue-600 hover:bg-blue-700 active:scale-98 text-white py-4 rounded-xl font-bold text-lg flex items-center justify-between px-6 shadow-lg transition-transform",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-white/20 rounded-full w-8 h-8 flex items-center justify-center font-bold",children:i.reduce((T,te)=>T+te.quantity,0)}),e.jsx("span",{children:"Ti·∫øp t·ª•c"})]}),e.jsx("span",{className:"font-bold",children:W(v)})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 p-4 flex items-center justify-between flex-shrink-0",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>N(1),className:"text-white text-xl leading-none",children:"‚Üê"}),e.jsx("h2",{className:"text-lg font-bold text-white",children:"X√°c nh·∫≠n nh·∫≠p kho"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto bg-slate-50 dark:bg-slate-900",children:[e.jsx("div",{className:"p-3 space-y-2",children:i.map((T,te)=>e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-slate-900 dark:text-slate-100 leading-tight",children:T.partName}),e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:["SKU: ",T.sku]})]}),e.jsx("button",{onClick:()=>P(te),className:"text-red-500 hover:text-red-600 text-xl",children:"√ó"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{if(T.quantity>1){const Z=[...i];Z[te].quantity-=1,x(Z)}},className:"w-8 h-8 rounded-lg border-2 border-slate-300 dark:border-slate-600 flex items-center justify-center text-slate-600 dark:text-slate-400 font-bold active:scale-95 transition-transform",children:"‚àí"}),e.jsx("div",{className:"w-12 text-center font-bold text-lg text-slate-900 dark:text-slate-100",children:T.quantity}),e.jsx("button",{onClick:()=>{const Z=[...i];Z[te].quantity+=1,x(Z)},className:"w-8 h-8 rounded-lg border-2 border-blue-500 flex items-center justify-center text-blue-600 font-bold active:scale-95 transition-transform",children:"+"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:[W(T.importPrice)," / c√°i"]}),e.jsx("div",{className:"font-bold text-orange-600 dark:text-orange-400",children:W(T.quantity*T.importPrice)})]})]})]},te))}),e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-slate-700 dark:text-slate-300",children:[e.jsx("span",{children:"T·ªïng ti·ªÅn h√†ng"}),e.jsx("span",{className:"font-medium",children:W(v)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:"Gi·∫£m gi√°"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",inputMode:"numeric",value:r,onChange:T=>s(Number(T.target.value)),placeholder:"0",className:"w-24 px-3 py-1.5 border border-slate-300 dark:border-slate-600 rounded-lg text-right bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"}),e.jsxs("select",{value:a,onChange:T=>n(T.target.value),className:"px-2 py-1.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-sm",children:[e.jsx("option",{value:"amount",children:"‚Ç´"}),e.jsx("option",{value:"percent",children:"%"})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-3 border-t-2 border-slate-200 dark:border-slate-700",children:[e.jsx("span",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:"C·∫¶N THANH TO√ÅN"}),e.jsx("span",{className:"text-xl font-bold text-red-600 dark:text-red-400",children:W(G)})]})]})}),e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Ph∆∞∆°ng th·ª©c thanh to√°n"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>u("cash"),className:`flex-1 py-3 rounded-xl font-medium transition-all ${o==="cash"?"bg-green-600 text-white shadow-lg":"bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-300 border border-slate-300 dark:border-slate-600"}`,children:"üíµ Ti·ªÅn m·∫∑t"}),e.jsx("button",{onClick:()=>u("bank"),className:`flex-1 py-3 rounded-xl font-medium transition-all ${o==="bank"?"bg-blue-600 text-white shadow-lg":"bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-300 border border-slate-300 dark:border-slate-600"}`,children:"üè¶ Chuy·ªÉn kho·∫£n"})]})]}),e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"bg-slate-200 dark:bg-slate-700 rounded-xl p-1 flex gap-1",children:[e.jsx("button",{onClick:()=>{j("full"),E(0)},className:`flex-1 py-2.5 rounded-lg font-medium transition-all ${g==="full"?"bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 shadow":"text-slate-600 dark:text-slate-400"}`,children:"ƒê·ªß"}),e.jsx("button",{onClick:()=>j("partial"),className:`flex-1 py-2.5 rounded-lg font-medium transition-all ${g==="partial"?"bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 shadow":"text-slate-600 dark:text-slate-400"}`,children:"1 Ph·∫ßn"}),e.jsx("button",{onClick:()=>{j("note"),E(0)},className:`flex-1 py-2.5 rounded-lg font-medium transition-all ${g==="note"?"bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 shadow":"text-slate-600 dark:text-slate-400"}`,children:"N·ª£"})]})}),g==="partial"&&e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-300 dark:border-slate-600",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Ti·ªÅn tr·∫£ NCC"}),e.jsx("input",{type:"number",inputMode:"numeric",value:p,onChange:T=>{const te=Number(T.target.value);te<=G?E(te):alert("S·ªë ti·ªÅn tr·∫£ kh√¥ng ƒë∆∞·ª£c v∆∞·ª£t qu√° t·ªïng ti·ªÅn")},placeholder:"Nh·∫≠p s·ªë ti·ªÅn",className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 rounded-lg text-right text-lg font-bold bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-slate-100"}),e.jsxs("div",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:["C√≤n n·ª£: ",W(G-p)]})]})}),g==="note"&&e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4",children:[e.jsx("div",{className:"text-sm text-red-700 dark:text-red-400 mb-1",children:"S·ªë ti·ªÅn n·ª£"}),e.jsx("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:W(G)})]})})]}),e.jsx("div",{className:"p-3 bg-white dark:bg-slate-800 border-t border-slate-200 dark:border-slate-700 space-y-2 flex-shrink-0",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:Re,className:"flex-1 py-3 border-2 border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 rounded-xl font-medium active:scale-98 transition-transform",children:"üíæ L∆∞u Nh√°p"}),e.jsx("button",{onClick:t,disabled:!f||i.length===0,className:"flex-1 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-300 dark:disabled:bg-slate-600 text-white rounded-xl font-bold active:scale-98 transition-transform disabled:cursor-not-allowed",children:"‚úÖ NH·∫¨P KHO"})]})})]})})}),e.jsx(Ls,{isOpen:A,onClose:()=>L(!1),selectedSupplierId:f,onSelectSupplier:c}),e.jsx(za,{isOpen:z,onClose:()=>F(!1),onScan:ue,title:"Qu√©t m√£ v·∫°ch s·∫£n ph·∫©m"})]}):null},Rs=({transactions:d})=>{const{currentBranchId:m}=nr(),{data:b=[]}=Ba(),[i,x]=k.useState("7days"),[f,c]=k.useState(at(new Date,!0)),[h,l]=k.useState(at(new Date,!0)),[t,r]=k.useState(""),[s,a]=k.useState(!1),[n,o]=k.useState(null),u=k.useMemo(()=>{let p=d.filter(M=>M.type==="Nh·∫≠p kho");const E=new Date;switch(i){case"7days":const M=new Date(E.getTime()-6048e5);p=p.filter(C=>new Date(C.date)>=M);break;case"30days":const H=new Date(E.getTime()-720*60*60*1e3);p=p.filter(C=>new Date(C.date)>=H);break;case"thisMonth":const w=new Date(E.getFullYear(),E.getMonth(),1);p=p.filter(C=>new Date(C.date)>=w);break;case"custom":p=p.filter(C=>{const S=new Date(C.date);return S>=new Date(f)&&S<=new Date(h)});break}if(t){const M=t.toLowerCase();p=p.filter(H=>H.partName.toLowerCase().includes(M)||H.notes&&H.notes.toLowerCase().includes(M))}return p.sort((M,H)=>new Date(H.date).getTime()-new Date(M.date).getTime())},[d,i,f,h,t]),g=k.useMemo(()=>u.reduce((p,E)=>p+E.totalPrice,0),[u]),j=k.useMemo(()=>{const p=new Map;return u.forEach(E=>{var S,N;const M=new Date(E.date),H=`${M.getFullYear()}-${String(M.getMonth()+1).padStart(2,"0")}-${String(M.getDate()).padStart(2,"0")}`,w=(S=E.notes)!=null&&S.includes("NCC:")?(N=E.notes.split("NCC:")[1])==null?void 0:N.trim():"Kh√¥ng x√°c ƒë·ªãnh",C=`${H}_${w}_${M.getHours()}_${M.getMinutes()}`;p.has(C)||p.set(C,[]),p.get(C).push(E)}),Array.from(p.entries()).map(([E,M],H)=>{var N,A,L;const w=M[0],C=new Date(w.date);let S="";if(w.notes){const O=w.notes.match(/NH-\d{8}-\d{3}/);O&&(S=O[0])}return S||(S=`NH-${`${C.getFullYear()}${String(C.getMonth()+1).padStart(2,"0")}${String(C.getDate()).padStart(2,"0")}`}-${String(p.size-H).padStart(3,"0")}`),{receiptCode:S,date:w.date,supplier:(N=w.notes)!=null&&N.includes("NCC:")?(L=(A=w.notes.split("NCC:")[1])==null?void 0:A.split("|")[0])==null?void 0:L.trim():"Kh√¥ng x√°c ƒë·ªãnh",items:M,total:M.reduce((O,D)=>O+D.totalPrice,0)}}).sort((E,M)=>new Date(M.date).getTime()-new Date(E.date).getTime())},[u]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col h-full bg-slate-50 dark:bg-[#0f172a]",children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white dark:bg-[#1e293b] border-b border-slate-200 dark:border-slate-700 p-3 space-y-2",children:[e.jsx("input",{type:"text",value:t,onChange:p=>r(p.target.value),placeholder:"T√¨m NCC, ph·ª• t√πng...",className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-slate-100 placeholder-slate-400 text-sm"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>a(!0),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"B·ªô l·ªçc"]}),e.jsx("div",{className:"px-4 py-2 bg-slate-100 dark:bg-slate-700 rounded-lg text-sm font-medium text-slate-700 dark:text-slate-300",children:j.length})]})]}),e.jsx("div",{className:"px-3 py-3 bg-blue-50 dark:bg-blue-900/20 border-b border-blue-100 dark:border-blue-800",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"T·ªïng gi√° tr·ªã nh·∫≠p"}),e.jsx("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:W(g)})]})}),e.jsx("div",{className:"flex-1 overflow-auto",children:j.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üì¶"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-2",children:"Kh√¥ng c√≥ d·ªØ li·ªáu"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Th·ª≠ thay ƒë·ªïi b·ªô l·ªçc ho·∫∑c th·ªùi gian"})]}):e.jsx("div",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:j.map(p=>{const E=new Date(p.date),M=E.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}),H=E.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}),w=b.find(N=>{var A;return(A=N.description)==null?void 0:A.includes(p.receiptCode)}),C=(w==null?void 0:w.remainingAmount)||0,S=C>0;return e.jsxs("button",{onClick:()=>o({...p,date:new Date(p.date)}),className:"w-full p-4 bg-white dark:bg-[#1e293b] hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors text-left",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-cyan-600 dark:text-cyan-400",children:p.receiptCode}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:[M," ¬∑ ",H]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"T·ªïng ti·ªÅn"}),e.jsx("div",{className:"text-base font-bold text-slate-900 dark:text-white",children:W(p.total)})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center text-lg",children:"üè¢"}),e.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-white",children:p.supplier})]}),e.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:[p.items.length," s·∫£n ph·∫©m"]}),S&&e.jsx("div",{className:"mt-2",children:e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-200",children:["‚ö†Ô∏è C√≤n n·ª£ ",W(C)]})})]},p.receiptCode)})})})]}),s&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>a(!1)}),e.jsxs("div",{className:"relative bg-white dark:bg-[#1e293b] rounded-t-2xl w-full max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"B·ªô l·ªçc th·ªùi gian"}),e.jsx("button",{onClick:()=>a(!1),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Th·ªùi gian"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{key:"7days",label:"7 ng√†y qua"},{key:"30days",label:"30 ng√†y qua"},{key:"thisMonth",label:"Th√°ng n√†y"},{key:"custom",label:"T√πy ch·ªçn"}].map(p=>e.jsx("button",{onClick:()=>x(p.key),className:`px-4 py-2.5 rounded-lg text-sm font-medium transition-colors ${i===p.key?"bg-blue-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300"}`,children:p.label},p.key))})]}),i==="custom"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"T·ª´ ng√†y"}),e.jsx("input",{type:"date",value:f,onChange:p=>c(p.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-slate-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"ƒê·∫øn ng√†y"}),e.jsx("input",{type:"date",value:h,onChange:p=>l(p.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-slate-100"})]})]})]}),e.jsx("div",{className:"p-4 border-t border-slate-200 dark:border-slate-700",children:e.jsx("button",{onClick:()=>a(!1),className:"w-full px-4 py-2.5 bg-blue-600 text-white rounded-lg text-sm font-medium",children:"√Åp d·ª•ng"})})]})]}),n&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>o(null)}),e.jsxs("div",{className:"relative bg-white dark:bg-[#1e293b] rounded-t-2xl w-full max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Chi ti·∫øt phi·∫øu nh·∫≠p"}),e.jsx("button",{onClick:()=>o(null),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:[e.jsxs("div",{className:"bg-cyan-50 dark:bg-cyan-900/20 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-cyan-600 dark:text-cyan-400 mb-1",children:"M√£ phi·∫øu"}),e.jsx("div",{className:"text-lg font-bold text-cyan-600 dark:text-cyan-400",children:n.receiptCode})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Ng√†y nh·∫≠p"}),e.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-white",children:at(new Date(n.date))})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 mb-1",children:"T·ªïng ti·ªÅn"}),e.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:W(n.total)})]})]}),e.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-orange-600 dark:text-orange-400 mb-1",children:"Nh√† cung c·∫•p"}),e.jsx("div",{className:"text-base font-semibold text-orange-900 dark:text-orange-100",children:n.supplier})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100 mb-2",children:["Danh s√°ch s·∫£n ph·∫©m (",n.items.length,")"]}),e.jsx("div",{className:"space-y-2",children:n.items.map(p=>e.jsxs("div",{className:"flex items-start justify-between p-3 bg-slate-50 dark:bg-slate-800 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-sm font-medium text-slate-900 dark:text-white",children:[p.quantity," x ",p.partName]}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:[W(p.unitPrice||0)," / SP"]})]}),e.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white",children:W(p.quantity*(p.unitPrice||0))})]},p.id))})]})]})]})]})]})};var kt={},nt={},yt={},Rr;function Ce(){if(Rr)return yt;Rr=1,Object.defineProperty(yt,"__esModule",{value:!0});function d(b,i){if(!(b instanceof i))throw new TypeError("Cannot call a class as a function")}var m=function b(i,x){d(this,b),this.data=i,this.text=x.text||i,this.options=x};return yt.default=m,yt}var $r;function $s(){if($r)return nt;$r=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.CODE39=void 0;var d=(function(){function u(g,j){for(var p=0;p<j.length;p++){var E=j[p];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(g,E.key,E)}}return function(g,j,p){return j&&u(g.prototype,j),p&&u(g,p),g}})(),m=Ce(),b=i(m);function i(u){return u&&u.__esModule?u:{default:u}}function x(u,g){if(!(u instanceof g))throw new TypeError("Cannot call a class as a function")}function f(u,g){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:u}function c(u,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);u.prototype=Object.create(g&&g.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(u,g):u.__proto__=g)}var h=(function(u){c(g,u);function g(j,p){return x(this,g),j=j.toUpperCase(),p.mod43&&(j+=a(o(j))),f(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,j,p))}return d(g,[{key:"encode",value:function(){for(var p=r("*"),E=0;E<this.data.length;E++)p+=r(this.data[E])+"0";return p+=r("*"),{data:p,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)!==-1}}]),g})(b.default),l=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],t=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function r(u){return s(n(u))}function s(u){return t[u].toString(2)}function a(u){return l[u]}function n(u){return l.indexOf(u)}function o(u){for(var g=0,j=0;j<u.length;j++)g+=n(u[j]);return g=g%43,g}return nt.CODE39=h,nt}var Te={},jt={},wt={},fe={},Ir;function bt(){if(Ir)return fe;Ir=1,Object.defineProperty(fe,"__esModule",{value:!0});var d;function m(l,t,r){return t in l?Object.defineProperty(l,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):l[t]=r,l}var b=fe.SET_A=0,i=fe.SET_B=1,x=fe.SET_C=2;fe.SHIFT=98;var f=fe.START_A=103,c=fe.START_B=104,h=fe.START_C=105;return fe.MODULO=103,fe.STOP=106,fe.FNC1=207,fe.SET_BY_CODE=(d={},m(d,f,b),m(d,c,i),m(d,h,x),d),fe.SWAP={101:b,100:i,99:x},fe.A_START_CHAR="√ê",fe.B_START_CHAR="√ë",fe.C_START_CHAR="√í",fe.A_CHARS="[\0-_√à-√è]",fe.B_CHARS="[ -√à-√è]",fe.C_CHARS="(√è*[0-9]{2}√è*)",fe.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011],fe}var Dr;function lr(){if(Dr)return wt;Dr=1,Object.defineProperty(wt,"__esModule",{value:!0});var d=(function(){function t(r,s){for(var a=0;a<s.length;a++){var n=s[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,s,a){return s&&t(r.prototype,s),a&&t(r,a),r}})(),m=Ce(),b=x(m),i=bt();function x(t){return t&&t.__esModule?t:{default:t}}function f(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function c(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function h(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var l=(function(t){h(r,t);function r(s,a){f(this,r);var n=c(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,s.substring(1),a));return n.bytes=s.split("").map(function(o){return o.charCodeAt(0)}),n}return d(r,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var a=this.bytes,n=a.shift()-105,o=i.SET_BY_CODE[n];if(o===void 0)throw new RangeError("The encoding does not start with a start character.");this.shouldEncodeAsEan128()===!0&&a.unshift(i.FNC1);var u=r.next(a,1,o);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:r.getBar(n)+u.result+r.getBar((u.checksum+n)%i.MODULO)+r.getBar(i.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var a=this.options.ean128||!1;return typeof a=="string"&&(a=a.toLowerCase()==="true"),a}}],[{key:"getBar",value:function(a){return i.BARS[a]?i.BARS[a].toString():""}},{key:"correctIndex",value:function(a,n){if(n===i.SET_A){var o=a.shift();return o<32?o+64:o-32}else return n===i.SET_B?a.shift()-32:(a.shift()-48)*10+a.shift()-48}},{key:"next",value:function(a,n,o){if(!a.length)return{result:"",checksum:0};var u=void 0,g=void 0;if(a[0]>=200){g=a.shift()-105;var j=i.SWAP[g];j!==void 0?u=r.next(a,n+1,j):((o===i.SET_A||o===i.SET_B)&&g===i.SHIFT&&(a[0]=o===i.SET_A?a[0]>95?a[0]-96:a[0]:a[0]<32?a[0]+96:a[0]),u=r.next(a,n+1,o))}else g=r.correctIndex(a,o),u=r.next(a,n+1,o);var p=r.getBar(g),E=g*n;return{result:p+u.result,checksum:E+u.checksum}}}]),r})(b.default);return wt.default=l,wt}var Nt={},qr;function Is(){if(qr)return Nt;qr=1,Object.defineProperty(Nt,"__esModule",{value:!0});var d=bt(),m=function(h){return h.match(new RegExp("^"+d.A_CHARS+"*"))[0].length},b=function(h){return h.match(new RegExp("^"+d.B_CHARS+"*"))[0].length},i=function(h){return h.match(new RegExp("^"+d.C_CHARS+"*"))[0]};function x(c,h){var l=h?d.A_CHARS:d.B_CHARS,t=c.match(new RegExp("^("+l+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(t)return t[1]+"√å"+f(c.substring(t[1].length));var r=c.match(new RegExp("^"+l+"+"))[0];return r.length===c.length?c:r+String.fromCharCode(h?205:206)+x(c.substring(r.length),!h)}function f(c){var h=i(c),l=h.length;if(l===c.length)return c;c=c.substring(l);var t=m(c)>=b(c);return h+String.fromCharCode(t?206:205)+x(c,t)}return Nt.default=function(c){var h=void 0,l=i(c).length;if(l>=2)h=d.C_START_CHAR+f(c);else{var t=m(c)>b(c);h=(t?d.A_START_CHAR:d.B_START_CHAR)+x(c,t)}return h.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,function(r,s){return"√ã"+s})},Nt}var Br;function Ds(){if(Br)return jt;Br=1,Object.defineProperty(jt,"__esModule",{value:!0});var d=lr(),m=x(d),b=Is(),i=x(b);function x(t){return t&&t.__esModule?t:{default:t}}function f(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function c(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function h(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var l=(function(t){h(r,t);function r(s,a){if(f(this,r),/^[\x00-\x7F\xC8-\xD3]+$/.test(s))var n=c(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,(0,i.default)(s),a));else var n=c(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,s,a));return c(n)}return r})(m.default);return jt.default=l,jt}var _t={},zr;function qs(){if(zr)return _t;zr=1,Object.defineProperty(_t,"__esModule",{value:!0});var d=(function(){function t(r,s){for(var a=0;a<s.length;a++){var n=s[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,s,a){return s&&t(r.prototype,s),a&&t(r,a),r}})(),m=lr(),b=x(m),i=bt();function x(t){return t&&t.__esModule?t:{default:t}}function f(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function c(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function h(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var l=(function(t){h(r,t);function r(s,a){return f(this,r),c(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,i.A_START_CHAR+s,a))}return d(r,[{key:"valid",value:function(){return new RegExp("^"+i.A_CHARS+"+$").test(this.data)}}]),r})(b.default);return _t.default=l,_t}var St={},Fr;function Bs(){if(Fr)return St;Fr=1,Object.defineProperty(St,"__esModule",{value:!0});var d=(function(){function t(r,s){for(var a=0;a<s.length;a++){var n=s[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,s,a){return s&&t(r.prototype,s),a&&t(r,a),r}})(),m=lr(),b=x(m),i=bt();function x(t){return t&&t.__esModule?t:{default:t}}function f(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function c(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function h(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var l=(function(t){h(r,t);function r(s,a){return f(this,r),c(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,i.B_START_CHAR+s,a))}return d(r,[{key:"valid",value:function(){return new RegExp("^"+i.B_CHARS+"+$").test(this.data)}}]),r})(b.default);return St.default=l,St}var Ct={},Hr;function zs(){if(Hr)return Ct;Hr=1,Object.defineProperty(Ct,"__esModule",{value:!0});var d=(function(){function t(r,s){for(var a=0;a<s.length;a++){var n=s[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,s,a){return s&&t(r.prototype,s),a&&t(r,a),r}})(),m=lr(),b=x(m),i=bt();function x(t){return t&&t.__esModule?t:{default:t}}function f(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function c(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function h(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var l=(function(t){h(r,t);function r(s,a){return f(this,r),c(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,i.C_START_CHAR+s,a))}return d(r,[{key:"valid",value:function(){return new RegExp("^"+i.C_CHARS+"+$").test(this.data)}}]),r})(b.default);return Ct.default=l,Ct}var Gr;function Fs(){if(Gr)return Te;Gr=1,Object.defineProperty(Te,"__esModule",{value:!0}),Te.CODE128C=Te.CODE128B=Te.CODE128A=Te.CODE128=void 0;var d=Ds(),m=l(d),b=qs(),i=l(b),x=Bs(),f=l(x),c=zs(),h=l(c);function l(t){return t&&t.__esModule?t:{default:t}}return Te.CODE128=m.default,Te.CODE128A=i.default,Te.CODE128B=f.default,Te.CODE128C=h.default,Te}var ke={},Et={},Fe={},Vr;function gt(){return Vr||(Vr=1,Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.SIDE_BIN="101",Fe.MIDDLE_BIN="01010",Fe.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]},Fe.EAN2_STRUCTURE=["LL","LG","GL","GG"],Fe.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"],Fe.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"]),Fe}var Pt={},Ot={},Ur;function pt(){if(Ur)return Ot;Ur=1,Object.defineProperty(Ot,"__esModule",{value:!0});var d=gt(),m=function(i,x,f){var c=i.split("").map(function(l,t){return d.BINARIES[x[t]]}).map(function(l,t){return l?l[i[t]]:""});if(f){var h=i.length-1;c=c.map(function(l,t){return t<h?l+f:l})}return c.join("")};return Ot.default=m,Ot}var Kr;function Ha(){if(Kr)return Pt;Kr=1,Object.defineProperty(Pt,"__esModule",{value:!0});var d=(function(){function s(a,n){for(var o=0;o<n.length;o++){var u=n[o];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(a,u.key,u)}}return function(a,n,o){return n&&s(a.prototype,n),o&&s(a,o),a}})(),m=gt(),b=pt(),i=c(b),x=Ce(),f=c(x);function c(s){return s&&s.__esModule?s:{default:s}}function h(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}function l(s,a){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:s}function t(s,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);s.prototype=Object.create(a&&a.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(s,a):s.__proto__=a)}var r=(function(s){t(a,s);function a(n,o){h(this,a);var u=l(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,n,o));return u.fontSize=!o.flat&&o.fontSize>o.width*10?o.width*10:o.fontSize,u.guardHeight=o.height+u.fontSize/2+o.textMargin,u}return d(a,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(o,u){return this.text.substr(o,u)}},{key:"leftEncode",value:function(o,u){return(0,i.default)(o,u)}},{key:"rightText",value:function(o,u){return this.text.substr(o,u)}},{key:"rightEncode",value:function(o,u){return(0,i.default)(o,u)}},{key:"encodeGuarded",value:function(){var o={fontSize:this.fontSize},u={height:this.guardHeight};return[{data:m.SIDE_BIN,options:u},{data:this.leftEncode(),text:this.leftText(),options:o},{data:m.MIDDLE_BIN,options:u},{data:this.rightEncode(),text:this.rightText(),options:o},{data:m.SIDE_BIN,options:u}]}},{key:"encodeFlat",value:function(){var o=[m.SIDE_BIN,this.leftEncode(),m.MIDDLE_BIN,this.rightEncode(),m.SIDE_BIN];return{data:o.join(""),text:this.text}}}]),a})(f.default);return Pt.default=r,Pt}var Xr;function Hs(){if(Xr)return Et;Xr=1,Object.defineProperty(Et,"__esModule",{value:!0});var d=(function(){function s(a,n){for(var o=0;o<n.length;o++){var u=n[o];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(a,u.key,u)}}return function(a,n,o){return n&&s(a.prototype,n),o&&s(a,o),a}})(),m=function s(a,n,o){a===null&&(a=Function.prototype);var u=Object.getOwnPropertyDescriptor(a,n);if(u===void 0){var g=Object.getPrototypeOf(a);return g===null?void 0:s(g,n,o)}else{if("value"in u)return u.value;var j=u.get;return j===void 0?void 0:j.call(o)}},b=gt(),i=Ha(),x=f(i);function f(s){return s&&s.__esModule?s:{default:s}}function c(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}function h(s,a){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:s}function l(s,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);s.prototype=Object.create(a&&a.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(s,a):s.__proto__=a)}var t=function(a){var n=a.substr(0,12).split("").map(function(o){return+o}).reduce(function(o,u,g){return g%2?o+u*3:o+u},0);return(10-n%10)%10},r=(function(s){l(a,s);function a(n,o){c(this,a),n.search(/^[0-9]{12}$/)!==-1&&(n+=t(n));var u=h(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,n,o));return u.lastChar=o.lastChar,u}return d(a,[{key:"valid",value:function(){return this.data.search(/^[0-9]{13}$/)!==-1&&+this.data[12]===t(this.data)}},{key:"leftText",value:function(){return m(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var o=this.data.substr(1,6),u=b.EAN13_STRUCTURE[this.data[0]];return m(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"leftEncode",this).call(this,o,u)}},{key:"rightText",value:function(){return m(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var o=this.data.substr(7,6);return m(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"rightEncode",this).call(this,o,"RRRRRR")}},{key:"encodeGuarded",value:function(){var o=m(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(o.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(o.push({data:"00"}),o.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),o}}]),a})(x.default);return Et.default=r,Et}var Mt={},Wr;function Gs(){if(Wr)return Mt;Wr=1,Object.defineProperty(Mt,"__esModule",{value:!0});var d=(function(){function r(s,a){for(var n=0;n<a.length;n++){var o=a[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}return function(s,a,n){return a&&r(s.prototype,a),n&&r(s,n),s}})(),m=function r(s,a,n){s===null&&(s=Function.prototype);var o=Object.getOwnPropertyDescriptor(s,a);if(o===void 0){var u=Object.getPrototypeOf(s);return u===null?void 0:r(u,a,n)}else{if("value"in o)return o.value;var g=o.get;return g===void 0?void 0:g.call(n)}},b=Ha(),i=x(b);function x(r){return r&&r.__esModule?r:{default:r}}function f(r,s){if(!(r instanceof s))throw new TypeError("Cannot call a class as a function")}function c(r,s){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s&&(typeof s=="object"||typeof s=="function")?s:r}function h(r,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof s);r.prototype=Object.create(s&&s.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),s&&(Object.setPrototypeOf?Object.setPrototypeOf(r,s):r.__proto__=s)}var l=function(s){var a=s.substr(0,7).split("").map(function(n){return+n}).reduce(function(n,o,u){return u%2?n+o:n+o*3},0);return(10-a%10)%10},t=(function(r){h(s,r);function s(a,n){return f(this,s),a.search(/^[0-9]{7}$/)!==-1&&(a+=l(a)),c(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,a,n))}return d(s,[{key:"valid",value:function(){return this.data.search(/^[0-9]{8}$/)!==-1&&+this.data[7]===l(this.data)}},{key:"leftText",value:function(){return m(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var n=this.data.substr(0,4);return m(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"leftEncode",this).call(this,n,"LLLL")}},{key:"rightText",value:function(){return m(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var n=this.data.substr(4,4);return m(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"rightEncode",this).call(this,n,"RRRR")}}]),s})(i.default);return Mt.default=t,Mt}var Tt={},Qr;function Vs(){if(Qr)return Tt;Qr=1,Object.defineProperty(Tt,"__esModule",{value:!0});var d=(function(){function a(n,o){for(var u=0;u<o.length;u++){var g=o[u];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(n,g.key,g)}}return function(n,o,u){return o&&a(n.prototype,o),u&&a(n,u),n}})(),m=gt(),b=pt(),i=c(b),x=Ce(),f=c(x);function c(a){return a&&a.__esModule?a:{default:a}}function h(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function l(a,n){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:a}function t(a,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(a,n):a.__proto__=n)}var r=function(n){var o=n.split("").map(function(u){return+u}).reduce(function(u,g,j){return j%2?u+g*9:u+g*3},0);return o%10},s=(function(a){t(n,a);function n(o,u){return h(this,n),l(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,o,u))}return d(n,[{key:"valid",value:function(){return this.data.search(/^[0-9]{5}$/)!==-1}},{key:"encode",value:function(){var u=m.EAN5_STRUCTURE[r(this.data)];return{data:"1011"+(0,i.default)(this.data,u,"01"),text:this.text}}}]),n})(f.default);return Tt.default=s,Tt}var Lt={},Yr;function Us(){if(Yr)return Lt;Yr=1,Object.defineProperty(Lt,"__esModule",{value:!0});var d=(function(){function s(a,n){for(var o=0;o<n.length;o++){var u=n[o];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(a,u.key,u)}}return function(a,n,o){return n&&s(a.prototype,n),o&&s(a,o),a}})(),m=gt(),b=pt(),i=c(b),x=Ce(),f=c(x);function c(s){return s&&s.__esModule?s:{default:s}}function h(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}function l(s,a){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:s}function t(s,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);s.prototype=Object.create(a&&a.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(s,a):s.__proto__=a)}var r=(function(s){t(a,s);function a(n,o){return h(this,a),l(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,n,o))}return d(a,[{key:"valid",value:function(){return this.data.search(/^[0-9]{2}$/)!==-1}},{key:"encode",value:function(){var o=m.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,i.default)(this.data,o,"01"),text:this.text}}}]),a})(f.default);return Lt.default=r,Lt}var lt={},Jr;function Ga(){if(Jr)return lt;Jr=1,Object.defineProperty(lt,"__esModule",{value:!0});var d=(function(){function s(a,n){for(var o=0;o<n.length;o++){var u=n[o];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(a,u.key,u)}}return function(a,n,o){return n&&s(a.prototype,n),o&&s(a,o),a}})();lt.checksum=r;var m=pt(),b=f(m),i=Ce(),x=f(i);function f(s){return s&&s.__esModule?s:{default:s}}function c(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}function h(s,a){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:s}function l(s,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);s.prototype=Object.create(a&&a.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(s,a):s.__proto__=a)}var t=(function(s){l(a,s);function a(n,o){c(this,a),n.search(/^[0-9]{11}$/)!==-1&&(n+=r(n));var u=h(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,n,o));return u.displayValue=o.displayValue,o.fontSize>o.width*10?u.fontSize=o.width*10:u.fontSize=o.fontSize,u.guardHeight=o.height+u.fontSize/2+o.textMargin,u}return d(a,[{key:"valid",value:function(){return this.data.search(/^[0-9]{12}$/)!==-1&&this.data[11]==r(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var o="";return o+="101",o+=(0,b.default)(this.data.substr(0,6),"LLLLLL"),o+="01010",o+=(0,b.default)(this.data.substr(6,6),"RRRRRR"),o+="101",{data:o,text:this.text}}},{key:"guardedEncoding",value:function(){var o=[];return this.displayValue&&o.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),o.push({data:"101"+(0,b.default)(this.data[0],"L"),options:{height:this.guardHeight}}),o.push({data:(0,b.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),o.push({data:"01010",options:{height:this.guardHeight}}),o.push({data:(0,b.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),o.push({data:(0,b.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&o.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),o}}]),a})(x.default);function r(s){var a=0,n;for(n=1;n<11;n+=2)a+=parseInt(s[n]);for(n=0;n<11;n+=2)a+=parseInt(s[n])*3;return(10-a%10)%10}return lt.default=t,lt}var At={},Zr;function Ks(){if(Zr)return At;Zr=1,Object.defineProperty(At,"__esModule",{value:!0});var d=(function(){function o(u,g){for(var j=0;j<g.length;j++){var p=g[j];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(u,p.key,p)}}return function(u,g,j){return g&&o(u.prototype,g),j&&o(u,j),u}})(),m=pt(),b=c(m),i=Ce(),x=c(i),f=Ga();function c(o){return o&&o.__esModule?o:{default:o}}function h(o,u){if(!(o instanceof u))throw new TypeError("Cannot call a class as a function")}function l(o,u){if(!o)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u&&(typeof u=="object"||typeof u=="function")?u:o}function t(o,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);o.prototype=Object.create(u&&u.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(o,u):o.__proto__=u)}var r=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],s=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]],a=(function(o){t(u,o);function u(g,j){h(this,u);var p=l(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,g,j));if(p.isValid=!1,g.search(/^[0-9]{6}$/)!==-1)p.middleDigits=g,p.upcA=n(g,"0"),p.text=j.text||""+p.upcA[0]+g+p.upcA[p.upcA.length-1],p.isValid=!0;else if(g.search(/^[01][0-9]{7}$/)!==-1)if(p.middleDigits=g.substring(1,g.length-1),p.upcA=n(p.middleDigits,g[0]),p.upcA[p.upcA.length-1]===g[g.length-1])p.isValid=!0;else return l(p);else return l(p);return p.displayValue=j.displayValue,j.fontSize>j.width*10?p.fontSize=j.width*10:p.fontSize=j.fontSize,p.guardHeight=j.height+p.fontSize/2+j.textMargin,p}return d(u,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var j="";return j+="101",j+=this.encodeMiddleDigits(),j+="010101",{data:j,text:this.text}}},{key:"guardedEncoding",value:function(){var j=[];return this.displayValue&&j.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),j.push({data:"101",options:{height:this.guardHeight}}),j.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),j.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&j.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),j}},{key:"encodeMiddleDigits",value:function(){var j=this.upcA[0],p=this.upcA[this.upcA.length-1],E=s[parseInt(p)][parseInt(j)];return(0,b.default)(this.middleDigits,E)}}]),u})(x.default);function n(o,u){for(var g=parseInt(o[o.length-1]),j=r[g],p="",E=0,M=0;M<j.length;M++){var H=j[M];H==="X"?p+=o[E++]:p+=H}return p=""+u+p,""+p+(0,f.checksum)(p)}return At.default=a,At}var ea;function Xs(){if(ea)return ke;ea=1,Object.defineProperty(ke,"__esModule",{value:!0}),ke.UPCE=ke.UPC=ke.EAN2=ke.EAN5=ke.EAN8=ke.EAN13=void 0;var d=Hs(),m=a(d),b=Gs(),i=a(b),x=Vs(),f=a(x),c=Us(),h=a(c),l=Ga(),t=a(l),r=Ks(),s=a(r);function a(n){return n&&n.__esModule?n:{default:n}}return ke.EAN13=m.default,ke.EAN8=i.default,ke.EAN5=f.default,ke.EAN2=h.default,ke.UPC=t.default,ke.UPCE=s.default,ke}var Ke={},Rt={},et={},ta;function Ws(){return ta||(ta=1,Object.defineProperty(et,"__esModule",{value:!0}),et.START_BIN="1010",et.END_BIN="11101",et.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"]),et}var ra;function Va(){if(ra)return Rt;ra=1,Object.defineProperty(Rt,"__esModule",{value:!0});var d=(function(){function t(r,s){for(var a=0;a<s.length;a++){var n=s[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,s,a){return s&&t(r.prototype,s),a&&t(r,a),r}})(),m=Ws(),b=Ce(),i=x(b);function x(t){return t&&t.__esModule?t:{default:t}}function f(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function c(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function h(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var l=(function(t){h(r,t);function r(){return f(this,r),c(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return d(r,[{key:"valid",value:function(){return this.data.search(/^([0-9]{2})+$/)!==-1}},{key:"encode",value:function(){var a=this,n=this.data.match(/.{2}/g).map(function(o){return a.encodePair(o)}).join("");return{data:m.START_BIN+n+m.END_BIN,text:this.text}}},{key:"encodePair",value:function(a){var n=m.BINARIES[a[1]];return m.BINARIES[a[0]].split("").map(function(o,u){return(o==="1"?"111":"1")+(n[u]==="1"?"000":"0")}).join("")}}]),r})(i.default);return Rt.default=l,Rt}var $t={},aa;function Qs(){if(aa)return $t;aa=1,Object.defineProperty($t,"__esModule",{value:!0});var d=(function(){function t(r,s){for(var a=0;a<s.length;a++){var n=s[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,s,a){return s&&t(r.prototype,s),a&&t(r,a),r}})(),m=Va(),b=i(m);function i(t){return t&&t.__esModule?t:{default:t}}function x(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function f(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function c(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var h=function(r){var s=r.substr(0,13).split("").map(function(a){return parseInt(a,10)}).reduce(function(a,n,o){return a+n*(3-o%2*2)},0);return Math.ceil(s/10)*10-s},l=(function(t){c(r,t);function r(s,a){return x(this,r),s.search(/^[0-9]{13}$/)!==-1&&(s+=h(s)),f(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,s,a))}return d(r,[{key:"valid",value:function(){return this.data.search(/^[0-9]{14}$/)!==-1&&+this.data[13]===h(this.data)}}]),r})(b.default);return $t.default=l,$t}var sa;function Ys(){if(sa)return Ke;sa=1,Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.ITF14=Ke.ITF=void 0;var d=Va(),m=x(d),b=Qs(),i=x(b);function x(f){return f&&f.__esModule?f:{default:f}}return Ke.ITF=m.default,Ke.ITF14=i.default,Ke}var _e={},It={},na;function vt(){if(na)return It;na=1,Object.defineProperty(It,"__esModule",{value:!0});var d=(function(){function t(r,s){for(var a=0;a<s.length;a++){var n=s[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,s,a){return s&&t(r.prototype,s),a&&t(r,a),r}})(),m=Ce(),b=i(m);function i(t){return t&&t.__esModule?t:{default:t}}function x(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function f(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function c(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var h=(function(t){c(r,t);function r(s,a){return x(this,r),f(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,s,a))}return d(r,[{key:"encode",value:function(){for(var a="110",n=0;n<this.data.length;n++){var o=parseInt(this.data[n]),u=o.toString(2);u=l(u,4-u.length);for(var g=0;g<u.length;g++)a+=u[g]=="0"?"100":"110"}return a+="1001",{data:a,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9]+$/)!==-1}}]),r})(b.default);function l(t,r){for(var s=0;s<r;s++)t="0"+t;return t}return It.default=h,It}var Dt={},ot={},la;function or(){if(la)return ot;la=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.mod10=d,ot.mod11=m;function d(b){for(var i=0,x=0;x<b.length;x++){var f=parseInt(b[x]);(x+b.length)%2===0?i+=f:i+=f*2%10+Math.floor(f*2/10)}return(10-i%10)%10}function m(b){for(var i=0,x=[2,3,4,5,6,7],f=0;f<b.length;f++){var c=parseInt(b[b.length-1-f]);i+=x[f%x.length]*c}return(11-i%11)%11}return ot}var oa;function Js(){if(oa)return Dt;oa=1,Object.defineProperty(Dt,"__esModule",{value:!0});var d=vt(),m=i(d),b=or();function i(l){return l&&l.__esModule?l:{default:l}}function x(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function f(l,t){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:l}function c(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(l,t):l.__proto__=t)}var h=(function(l){c(t,l);function t(r,s){return x(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r+(0,b.mod10)(r),s))}return t})(m.default);return Dt.default=h,Dt}var qt={},ia;function Zs(){if(ia)return qt;ia=1,Object.defineProperty(qt,"__esModule",{value:!0});var d=vt(),m=i(d),b=or();function i(l){return l&&l.__esModule?l:{default:l}}function x(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function f(l,t){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:l}function c(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(l,t):l.__proto__=t)}var h=(function(l){c(t,l);function t(r,s){return x(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r+(0,b.mod11)(r),s))}return t})(m.default);return qt.default=h,qt}var Bt={},da;function en(){if(da)return Bt;da=1,Object.defineProperty(Bt,"__esModule",{value:!0});var d=vt(),m=i(d),b=or();function i(l){return l&&l.__esModule?l:{default:l}}function x(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function f(l,t){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:l}function c(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(l,t):l.__proto__=t)}var h=(function(l){c(t,l);function t(r,s){return x(this,t),r+=(0,b.mod10)(r),r+=(0,b.mod10)(r),f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,s))}return t})(m.default);return Bt.default=h,Bt}var zt={},ca;function tn(){if(ca)return zt;ca=1,Object.defineProperty(zt,"__esModule",{value:!0});var d=vt(),m=i(d),b=or();function i(l){return l&&l.__esModule?l:{default:l}}function x(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function f(l,t){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:l}function c(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(l,t):l.__proto__=t)}var h=(function(l){c(t,l);function t(r,s){return x(this,t),r+=(0,b.mod11)(r),r+=(0,b.mod10)(r),f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,s))}return t})(m.default);return zt.default=h,zt}var ua;function rn(){if(ua)return _e;ua=1,Object.defineProperty(_e,"__esModule",{value:!0}),_e.MSI1110=_e.MSI1010=_e.MSI11=_e.MSI10=_e.MSI=void 0;var d=vt(),m=r(d),b=Js(),i=r(b),x=Zs(),f=r(x),c=en(),h=r(c),l=tn(),t=r(l);function r(s){return s&&s.__esModule?s:{default:s}}return _e.MSI=m.default,_e.MSI10=i.default,_e.MSI11=f.default,_e.MSI1010=h.default,_e.MSI1110=t.default,_e}var it={},ha;function an(){if(ha)return it;ha=1,Object.defineProperty(it,"__esModule",{value:!0}),it.pharmacode=void 0;var d=(function(){function l(t,r){for(var s=0;s<r.length;s++){var a=r[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,r,s){return r&&l(t.prototype,r),s&&l(t,s),t}})(),m=Ce(),b=i(m);function i(l){return l&&l.__esModule?l:{default:l}}function x(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function f(l,t){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:l}function c(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(l,t):l.__proto__=t)}var h=(function(l){c(t,l);function t(r,s){x(this,t);var a=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,s));return a.number=parseInt(r,10),a}return d(t,[{key:"encode",value:function(){for(var s=this.number,a="";!isNaN(s)&&s!=0;)s%2===0?(a="11100"+a,s=(s-2)/2):(a="100"+a,s=(s-1)/2);return a=a.slice(0,-2),{data:a,text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),t})(b.default);return it.pharmacode=h,it}var dt={},xa;function sn(){if(xa)return dt;xa=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.codabar=void 0;var d=(function(){function l(t,r){for(var s=0;s<r.length;s++){var a=r[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,r,s){return r&&l(t.prototype,r),s&&l(t,s),t}})(),m=Ce(),b=i(m);function i(l){return l&&l.__esModule?l:{default:l}}function x(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function f(l,t){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:l}function c(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(l,t):l.__proto__=t)}var h=(function(l){c(t,l);function t(r,s){x(this,t),r.search(/^[0-9\-\$\:\.\+\/]+$/)===0&&(r="A"+r+"A");var a=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r.toUpperCase(),s));return a.text=a.options.text||a.text.replace(/[A-D]/g,""),a}return d(t,[{key:"valid",value:function(){return this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)!==-1}},{key:"encode",value:function(){for(var s=[],a=this.getEncodings(),n=0;n<this.data.length;n++)s.push(a[this.data.charAt(n)]),n!==this.data.length-1&&s.push("0");return{text:this.text,data:s.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"1011011011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),t})(b.default);return dt.codabar=h,dt}var Xe={},Ft={},tt={},ma;function nn(){return ma||(ma=1,Object.defineProperty(tt,"__esModule",{value:!0}),tt.SYMBOLS=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","($)","(%)","(/)","(+)","√ø"],tt.BINARIES=["100010100","101001000","101000100","101000010","100101000","100100100","100100010","101010000","100010010","100001010","110101000","110100100","110100010","110010100","110010010","110001010","101101000","101100100","101100010","100110100","100011010","101011000","101001100","101000110","100101100","100010110","110110100","110110010","110101100","110100110","110010110","110011010","101101100","101100110","100110110","100111010","100101110","111010100","111010010","111001010","101101110","101110110","110101110","100100110","111011010","111010110","100110010","101011110"],tt.MULTI_SYMBOLS={"\0":["(%)","U"],"":["($)","A"],"":["($)","B"],"":["($)","C"],"":["($)","D"],"":["($)","E"],"":["($)","F"],"\x07":["($)","G"],"\b":["($)","H"],"	":["($)","I"],"\n":["($)","J"],"\v":["($)","K"],"\f":["($)","L"],"\r":["($)","M"],"":["($)","N"],"":["($)","O"],"":["($)","P"],"":["($)","Q"],"":["($)","R"],"":["($)","S"],"":["($)","T"],"":["($)","U"],"":["($)","V"],"":["($)","W"],"":["($)","X"],"":["($)","Y"],"":["($)","Z"],"\x1B":["(%)","A"],"":["(%)","B"],"":["(%)","C"],"":["(%)","D"],"":["(%)","E"],"!":["(/)","A"],'"':["(/)","B"],"#":["(/)","C"],"&":["(/)","F"],"'":["(/)","G"],"(":["(/)","H"],")":["(/)","I"],"*":["(/)","J"],",":["(/)","L"],":":["(/)","Z"],";":["(%)","F"],"<":["(%)","G"],"=":["(%)","H"],">":["(%)","I"],"?":["(%)","J"],"@":["(%)","V"],"[":["(%)","K"],"\\":["(%)","L"],"]":["(%)","M"],"^":["(%)","N"],_:["(%)","O"],"`":["(%)","W"],a:["(+)","A"],b:["(+)","B"],c:["(+)","C"],d:["(+)","D"],e:["(+)","E"],f:["(+)","F"],g:["(+)","G"],h:["(+)","H"],i:["(+)","I"],j:["(+)","J"],k:["(+)","K"],l:["(+)","L"],m:["(+)","M"],n:["(+)","N"],o:["(+)","O"],p:["(+)","P"],q:["(+)","Q"],r:["(+)","R"],s:["(+)","S"],t:["(+)","T"],u:["(+)","U"],v:["(+)","V"],w:["(+)","W"],x:["(+)","X"],y:["(+)","Y"],z:["(+)","Z"],"{":["(%)","P"],"|":["(%)","Q"],"}":["(%)","R"],"~":["(%)","S"],"":["(%)","T"]}),tt}var fa;function Ua(){if(fa)return Ft;fa=1,Object.defineProperty(Ft,"__esModule",{value:!0});var d=(function(){function t(r,s){for(var a=0;a<s.length;a++){var n=s[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,s,a){return s&&t(r.prototype,s),a&&t(r,a),r}})(),m=nn(),b=Ce(),i=x(b);function x(t){return t&&t.__esModule?t:{default:t}}function f(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function c(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function h(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var l=(function(t){h(r,t);function r(s,a){return f(this,r),c(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,s,a))}return d(r,[{key:"valid",value:function(){return/^[0-9A-Z\-. $/+%]+$/.test(this.data)}},{key:"encode",value:function(){var a=this.data.split("").flatMap(function(g){return m.MULTI_SYMBOLS[g]||g}),n=a.map(function(g){return r.getEncoding(g)}).join(""),o=r.checksum(a,20),u=r.checksum(a.concat(o),15);return{text:this.text,data:r.getEncoding("√ø")+n+r.getEncoding(o)+r.getEncoding(u)+r.getEncoding("√ø")+"1"}}}],[{key:"getEncoding",value:function(a){return m.BINARIES[r.symbolValue(a)]}},{key:"getSymbol",value:function(a){return m.SYMBOLS[a]}},{key:"symbolValue",value:function(a){return m.SYMBOLS.indexOf(a)}},{key:"checksum",value:function(a,n){var o=a.slice().reverse().reduce(function(u,g,j){var p=j%n+1;return u+r.symbolValue(g)*p},0);return r.getSymbol(o%47)}}]),r})(i.default);return Ft.default=l,Ft}var Ht={},ba;function ln(){if(ba)return Ht;ba=1,Object.defineProperty(Ht,"__esModule",{value:!0});var d=(function(){function l(t,r){for(var s=0;s<r.length;s++){var a=r[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,r,s){return r&&l(t.prototype,r),s&&l(t,s),t}})(),m=Ua(),b=i(m);function i(l){return l&&l.__esModule?l:{default:l}}function x(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function f(l,t){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:l}function c(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(l,t):l.__proto__=t)}var h=(function(l){c(t,l);function t(r,s){return x(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,s))}return d(t,[{key:"valid",value:function(){return/^[\x00-\x7f]+$/.test(this.data)}}]),t})(b.default);return Ht.default=h,Ht}var ga;function on(){if(ga)return Xe;ga=1,Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.CODE93FullASCII=Xe.CODE93=void 0;var d=Ua(),m=x(d),b=ln(),i=x(b);function x(f){return f&&f.__esModule?f:{default:f}}return Xe.CODE93=m.default,Xe.CODE93FullASCII=i.default,Xe}var ct={},pa;function dn(){if(pa)return ct;pa=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.GenericBarcode=void 0;var d=(function(){function l(t,r){for(var s=0;s<r.length;s++){var a=r[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,r,s){return r&&l(t.prototype,r),s&&l(t,s),t}})(),m=Ce(),b=i(m);function i(l){return l&&l.__esModule?l:{default:l}}function x(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}function f(l,t){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:l}function c(l,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);l.prototype=Object.create(t&&t.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(l,t):l.__proto__=t)}var h=(function(l){c(t,l);function t(r,s){return x(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,s))}return d(t,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),t})(b.default);return ct.GenericBarcode=h,ct}var va;function cn(){if(va)return kt;va=1,Object.defineProperty(kt,"__esModule",{value:!0});var d=$s(),m=Fs(),b=Xs(),i=Ys(),x=rn(),f=an(),c=sn(),h=on(),l=dn();return kt.default={CODE39:d.CODE39,CODE128:m.CODE128,CODE128A:m.CODE128A,CODE128B:m.CODE128B,CODE128C:m.CODE128C,EAN13:b.EAN13,EAN8:b.EAN8,EAN5:b.EAN5,EAN2:b.EAN2,UPC:b.UPC,UPCE:b.UPCE,ITF14:i.ITF14,ITF:i.ITF,MSI:x.MSI,MSI10:x.MSI10,MSI11:x.MSI11,MSI1010:x.MSI1010,MSI1110:x.MSI1110,pharmacode:f.pharmacode,codabar:c.codabar,CODE93:h.CODE93,CODE93FullASCII:h.CODE93FullASCII,GenericBarcode:l.GenericBarcode},kt}var Gt={},ka;function ir(){if(ka)return Gt;ka=1,Object.defineProperty(Gt,"__esModule",{value:!0});var d=Object.assign||function(m){for(var b=1;b<arguments.length;b++){var i=arguments[b];for(var x in i)Object.prototype.hasOwnProperty.call(i,x)&&(m[x]=i[x])}return m};return Gt.default=function(m,b){return d({},m,b)},Gt}var Vt={},ya;function un(){if(ya)return Vt;ya=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.default=d;function d(m){var b=[];function i(x){if(Array.isArray(x))for(var f=0;f<x.length;f++)i(x[f]);else x.text=x.text||"",x.data=x.data||"",b.push(x)}return i(m),b}return Vt}var Ut={},ja;function hn(){if(ja)return Ut;ja=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.default=d;function d(m){return m.marginTop=m.marginTop||m.margin,m.marginBottom=m.marginBottom||m.margin,m.marginRight=m.marginRight||m.margin,m.marginLeft=m.marginLeft||m.margin,m}return Ut}var Kt={},Xt={},Wt={},wa;function Ka(){if(wa)return Wt;wa=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.default=d;function d(m){var b=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var i in b)b.hasOwnProperty(i)&&(i=b[i],typeof m[i]=="string"&&(m[i]=parseInt(m[i],10)));return typeof m.displayValue=="string"&&(m.displayValue=m.displayValue!="false"),m}return Wt}var Qt={},Na;function Xa(){if(Na)return Qt;Na=1,Object.defineProperty(Qt,"__esModule",{value:!0});var d={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}};return Qt.default=d,Qt}var _a;function xn(){if(_a)return Xt;_a=1,Object.defineProperty(Xt,"__esModule",{value:!0});var d=Ka(),m=x(d),b=Xa(),i=x(b);function x(c){return c&&c.__esModule?c:{default:c}}function f(c){var h={};for(var l in i.default)i.default.hasOwnProperty(l)&&(c.hasAttribute("jsbarcode-"+l.toLowerCase())&&(h[l]=c.getAttribute("jsbarcode-"+l.toLowerCase())),c.hasAttribute("data-"+l.toLowerCase())&&(h[l]=c.getAttribute("data-"+l.toLowerCase())));return h.value=c.getAttribute("jsbarcode-value")||c.getAttribute("data-value"),h=(0,m.default)(h),h}return Xt.default=f,Xt}var Yt={},Jt={},Se={},Sa;function Wa(){if(Sa)return Se;Sa=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se.getTotalWidthOfEncodings=Se.calculateEncodingAttributes=Se.getBarcodePadding=Se.getEncodingHeight=Se.getMaximumHeightOfEncodings=void 0;var d=ir(),m=b(d);function b(t){return t&&t.__esModule?t:{default:t}}function i(t,r){return r.height+(r.displayValue&&t.text.length>0?r.fontSize+r.textMargin:0)+r.marginTop+r.marginBottom}function x(t,r,s){if(s.displayValue&&r<t){if(s.textAlign=="center")return Math.floor((t-r)/2);if(s.textAlign=="left")return 0;if(s.textAlign=="right")return Math.floor(t-r)}return 0}function f(t,r,s){for(var a=0;a<t.length;a++){var n=t[a],o=(0,m.default)(r,n.options),u;o.displayValue?u=l(n.text,o,s):u=0;var g=n.data.length*o.width;n.width=Math.ceil(Math.max(u,g)),n.height=i(n,o),n.barcodePadding=x(u,g,o)}}function c(t){for(var r=0,s=0;s<t.length;s++)r+=t[s].width;return r}function h(t){for(var r=0,s=0;s<t.length;s++)t[s].height>r&&(r=t[s].height);return r}function l(t,r,s){var a;if(s)a=s;else if(typeof document<"u")a=document.createElement("canvas").getContext("2d");else return 0;a.font=r.fontOptions+" "+r.fontSize+"px "+r.font;var n=a.measureText(t);if(!n)return 0;var o=n.width;return o}return Se.getMaximumHeightOfEncodings=h,Se.getEncodingHeight=i,Se.getBarcodePadding=x,Se.calculateEncodingAttributes=f,Se.getTotalWidthOfEncodings=c,Se}var Ca;function mn(){if(Ca)return Jt;Ca=1,Object.defineProperty(Jt,"__esModule",{value:!0});var d=(function(){function h(l,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(l,s.key,s)}}return function(l,t,r){return t&&h(l.prototype,t),r&&h(l,r),l}})(),m=ir(),b=x(m),i=Wa();function x(h){return h&&h.__esModule?h:{default:h}}function f(h,l){if(!(h instanceof l))throw new TypeError("Cannot call a class as a function")}var c=(function(){function h(l,t,r){f(this,h),this.canvas=l,this.encodings=t,this.options=r}return d(h,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var t=0;t<this.encodings.length;t++){var r=(0,b.default)(this.options,this.encodings[t].options);this.drawCanvasBarcode(r,this.encodings[t]),this.drawCanvasText(r,this.encodings[t]),this.moveCanvasDrawing(this.encodings[t])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var t=this.canvas.getContext("2d");t.save(),(0,i.calculateEncodingAttributes)(this.encodings,this.options,t);var r=(0,i.getTotalWidthOfEncodings)(this.encodings),s=(0,i.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=r+this.options.marginLeft+this.options.marginRight,this.canvas.height=s,t.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(t.fillStyle=this.options.background,t.fillRect(0,0,this.canvas.width,this.canvas.height)),t.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(t,r){var s=this.canvas.getContext("2d"),a=r.data,n;t.textPosition=="top"?n=t.marginTop+t.fontSize+t.textMargin:n=t.marginTop,s.fillStyle=t.lineColor;for(var o=0;o<a.length;o++){var u=o*t.width+r.barcodePadding;a[o]==="1"?s.fillRect(u,n,t.width,t.height):a[o]&&s.fillRect(u,n,t.width,t.height*a[o])}}},{key:"drawCanvasText",value:function(t,r){var s=this.canvas.getContext("2d"),a=t.fontOptions+" "+t.fontSize+"px "+t.font;if(t.displayValue){var n,o;t.textPosition=="top"?o=t.marginTop+t.fontSize-t.textMargin:o=t.height+t.textMargin+t.marginTop+t.fontSize,s.font=a,t.textAlign=="left"||r.barcodePadding>0?(n=0,s.textAlign="left"):t.textAlign=="right"?(n=r.width-1,s.textAlign="right"):(n=r.width/2,s.textAlign="center"),s.fillText(r.text,n,o)}}},{key:"moveCanvasDrawing",value:function(t){var r=this.canvas.getContext("2d");r.translate(t.width,0)}},{key:"restoreCanvas",value:function(){var t=this.canvas.getContext("2d");t.restore()}}]),h})();return Jt.default=c,Jt}var Zt={},Ea;function fn(){if(Ea)return Zt;Ea=1,Object.defineProperty(Zt,"__esModule",{value:!0});var d=(function(){function l(t,r){for(var s=0;s<r.length;s++){var a=r[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,r,s){return r&&l(t.prototype,r),s&&l(t,s),t}})(),m=ir(),b=x(m),i=Wa();function x(l){return l&&l.__esModule?l:{default:l}}function f(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}var c="http://www.w3.org/2000/svg",h=(function(){function l(t,r,s){f(this,l),this.svg=t,this.encodings=r,this.options=s,this.document=s.xmlDocument||document}return d(l,[{key:"render",value:function(){var r=this.options.marginLeft;this.prepareSVG();for(var s=0;s<this.encodings.length;s++){var a=this.encodings[s],n=(0,b.default)(this.options,a.options),o=this.createGroup(r,n.marginTop,this.svg);this.setGroupOptions(o,n),this.drawSvgBarcode(o,n,a),this.drawSVGText(o,n,a),r+=a.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,i.calculateEncodingAttributes)(this.encodings,this.options);var r=(0,i.getTotalWidthOfEncodings)(this.encodings),s=(0,i.getMaximumHeightOfEncodings)(this.encodings),a=r+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(a,s),this.options.background&&this.drawRect(0,0,a,s,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(r,s,a){var n=a.data,o;s.textPosition=="top"?o=s.fontSize+s.textMargin:o=0;for(var u=0,g=0,j=0;j<n.length;j++)g=j*s.width+a.barcodePadding,n[j]==="1"?u++:u>0&&(this.drawRect(g-s.width*u,o,s.width*u,s.height,r),u=0);u>0&&this.drawRect(g-s.width*(u-1),o,s.width*u,s.height,r)}},{key:"drawSVGText",value:function(r,s,a){var n=this.document.createElementNS(c,"text");if(s.displayValue){var o,u;n.setAttribute("style","font:"+s.fontOptions+" "+s.fontSize+"px "+s.font),s.textPosition=="top"?u=s.fontSize-s.textMargin:u=s.height+s.textMargin+s.fontSize,s.textAlign=="left"||a.barcodePadding>0?(o=0,n.setAttribute("text-anchor","start")):s.textAlign=="right"?(o=a.width-1,n.setAttribute("text-anchor","end")):(o=a.width/2,n.setAttribute("text-anchor","middle")),n.setAttribute("x",o),n.setAttribute("y",u),n.appendChild(this.document.createTextNode(a.text)),r.appendChild(n)}}},{key:"setSvgAttributes",value:function(r,s){var a=this.svg;a.setAttribute("width",r+"px"),a.setAttribute("height",s+"px"),a.setAttribute("x","0px"),a.setAttribute("y","0px"),a.setAttribute("viewBox","0 0 "+r+" "+s),a.setAttribute("xmlns",c),a.setAttribute("version","1.1"),a.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(r,s,a){var n=this.document.createElementNS(c,"g");return n.setAttribute("transform","translate("+r+", "+s+")"),a.appendChild(n),n}},{key:"setGroupOptions",value:function(r,s){r.setAttribute("style","fill:"+s.lineColor+";")}},{key:"drawRect",value:function(r,s,a,n,o){var u=this.document.createElementNS(c,"rect");return u.setAttribute("x",r),u.setAttribute("y",s),u.setAttribute("width",a),u.setAttribute("height",n),o.appendChild(u),u}}]),l})();return Zt.default=h,Zt}var er={},Pa;function bn(){if(Pa)return er;Pa=1,Object.defineProperty(er,"__esModule",{value:!0});var d=(function(){function i(x,f){for(var c=0;c<f.length;c++){var h=f[c];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(x,h.key,h)}}return function(x,f,c){return f&&i(x.prototype,f),c&&i(x,c),x}})();function m(i,x){if(!(i instanceof x))throw new TypeError("Cannot call a class as a function")}var b=(function(){function i(x,f,c){m(this,i),this.object=x,this.encodings=f,this.options=c}return d(i,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),i})();return er.default=b,er}var Oa;function gn(){if(Oa)return Yt;Oa=1,Object.defineProperty(Yt,"__esModule",{value:!0});var d=mn(),m=c(d),b=fn(),i=c(b),x=bn(),f=c(x);function c(h){return h&&h.__esModule?h:{default:h}}return Yt.default={CanvasRenderer:m.default,SVGRenderer:i.default,ObjectRenderer:f.default},Yt}var rt={},Ma;function Qa(){if(Ma)return rt;Ma=1,Object.defineProperty(rt,"__esModule",{value:!0});function d(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function")}function m(c,h){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:c}function b(c,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);c.prototype=Object.create(h&&h.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(c,h):c.__proto__=h)}var i=(function(c){b(h,c);function h(l,t){d(this,h);var r=m(this,(h.__proto__||Object.getPrototypeOf(h)).call(this));return r.name="InvalidInputException",r.symbology=l,r.input=t,r.message='"'+r.input+'" is not a valid input for '+r.symbology,r}return h})(Error),x=(function(c){b(h,c);function h(){d(this,h);var l=m(this,(h.__proto__||Object.getPrototypeOf(h)).call(this));return l.name="InvalidElementException",l.message="Not supported type to render on",l}return h})(Error),f=(function(c){b(h,c);function h(){d(this,h);var l=m(this,(h.__proto__||Object.getPrototypeOf(h)).call(this));return l.name="NoElementException",l.message="No element to render on.",l}return h})(Error);return rt.InvalidInputException=i,rt.InvalidElementException=x,rt.NoElementException=f,rt}var Ta;function pn(){if(Ta)return Kt;Ta=1,Object.defineProperty(Kt,"__esModule",{value:!0});var d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},m=xn(),b=c(m),i=gn(),x=c(i),f=Qa();function c(r){return r&&r.__esModule?r:{default:r}}function h(r){if(typeof r=="string")return l(r);if(Array.isArray(r)){for(var s=[],a=0;a<r.length;a++)s.push(h(r[a]));return s}else{if(typeof HTMLCanvasElement<"u"&&r instanceof HTMLImageElement)return t(r);if(r&&r.nodeName&&r.nodeName.toLowerCase()==="svg"||typeof SVGElement<"u"&&r instanceof SVGElement)return{element:r,options:(0,b.default)(r),renderer:x.default.SVGRenderer};if(typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement)return{element:r,options:(0,b.default)(r),renderer:x.default.CanvasRenderer};if(r&&r.getContext)return{element:r,renderer:x.default.CanvasRenderer};if(r&&(typeof r>"u"?"undefined":d(r))==="object"&&!r.nodeName)return{element:r,renderer:x.default.ObjectRenderer};throw new f.InvalidElementException}}function l(r){var s=document.querySelectorAll(r);if(s.length!==0){for(var a=[],n=0;n<s.length;n++)a.push(h(s[n]));return a}}function t(r){var s=document.createElement("canvas");return{element:s,options:(0,b.default)(r),renderer:x.default.CanvasRenderer,afterRender:function(){r.setAttribute("src",s.toDataURL())}}}return Kt.default=h,Kt}var tr={},La;function vn(){if(La)return tr;La=1,Object.defineProperty(tr,"__esModule",{value:!0});var d=(function(){function i(x,f){for(var c=0;c<f.length;c++){var h=f[c];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(x,h.key,h)}}return function(x,f,c){return f&&i(x.prototype,f),c&&i(x,c),x}})();function m(i,x){if(!(i instanceof x))throw new TypeError("Cannot call a class as a function")}var b=(function(){function i(x){m(this,i),this.api=x}return d(i,[{key:"handleCatch",value:function(f){if(f.name==="InvalidInputException")if(this.api._options.valid!==this.api._defaults.valid)this.api._options.valid(!1);else throw f.message;else throw f;this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(f){try{var c=f.apply(void 0,arguments);return this.api._options.valid(!0),c}catch(h){return this.handleCatch(h),this.api}}}]),i})();return tr.default=b,tr}var xr,Aa;function kn(){if(Aa)return xr;Aa=1;var d=cn(),m=j(d),b=ir(),i=j(b),x=un(),f=j(x),c=hn(),h=j(c),l=pn(),t=j(l),r=Ka(),s=j(r),a=vn(),n=j(a),o=Qa(),u=Xa(),g=j(u);function j(N){return N&&N.__esModule?N:{default:N}}var p=function(){},E=function(A,L,O){var D=new p;if(typeof A>"u")throw Error("No element to render on was provided.");return D._renderProperties=(0,t.default)(A),D._encodings=[],D._options=g.default,D._errorHandler=new n.default(D),typeof L<"u"&&(O=O||{},O.format||(O.format=C()),D.options(O)[O.format](L,O).render()),D};E.getModule=function(N){return m.default[N]};for(var M in m.default)m.default.hasOwnProperty(M)&&H(m.default,M);function H(N,A){p.prototype[A]=p.prototype[A.toUpperCase()]=p.prototype[A.toLowerCase()]=function(L,O){var D=this;return D._errorHandler.wrapBarcodeCall(function(){O.text=typeof O.text>"u"?void 0:""+O.text;var R=(0,i.default)(D._options,O);R=(0,s.default)(R);var z=N[A],F=w(L,z,R);return D._encodings.push(F),D})}}function w(N,A,L){N=""+N;var O=new A(N,L);if(!O.valid())throw new o.InvalidInputException(O.constructor.name,N);var D=O.encode();D=(0,f.default)(D);for(var R=0;R<D.length;R++)D[R].options=(0,i.default)(L,D[R].options);return D}function C(){return m.default.CODE128?"CODE128":Object.keys(m.default)[0]}p.prototype.options=function(N){return this._options=(0,i.default)(this._options,N),this},p.prototype.blank=function(N){var A=new Array(N+1).join("0");return this._encodings.push({data:A}),this},p.prototype.init=function(){if(this._renderProperties){Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]);var N;for(var A in this._renderProperties){N=this._renderProperties[A];var L=(0,i.default)(this._options,N.options);L.format=="auto"&&(L.format=C()),this._errorHandler.wrapBarcodeCall(function(){var O=L.value,D=m.default[L.format.toUpperCase()],R=w(O,D,L);S(N,R,L)})}}},p.prototype.render=function(){if(!this._renderProperties)throw new o.NoElementException;if(Array.isArray(this._renderProperties))for(var N=0;N<this._renderProperties.length;N++)S(this._renderProperties[N],this._encodings,this._options);else S(this._renderProperties,this._encodings,this._options);return this},p.prototype._defaults=g.default;function S(N,A,L){A=(0,f.default)(A);for(var O=0;O<A.length;O++)A[O].options=(0,i.default)(L,A[O].options),(0,h.default)(A[O].options);(0,h.default)(L);var D=N.renderer,R=new D(N.element,A,L);R.render(),N.afterRender&&N.afterRender()}return typeof window<"u"&&(window.JsBarcode=E),typeof jQuery<"u"&&(jQuery.fn.JsBarcode=function(N,A){var L=[];return jQuery(this).each(function(){L.push(this)}),E(L,N,A)}),xr=E,xr}var yn=kn();const st=os(yn),mr={"30x20":{width:30,height:20,name:"30√ó20mm (nh·ªè)",barcodeHeight:25,fontSize:7},"40x30":{width:40,height:30,name:"40√ó30mm (ph·ªï bi·∫øn)",barcodeHeight:35,fontSize:8},"50x30":{width:50,height:30,name:"50√ó30mm (v·ª´a)",barcodeHeight:40,fontSize:9},"60x40":{width:60,height:40,name:"60√ó40mm (l·ªõn)",barcodeHeight:45,fontSize:10},"80x50":{width:80,height:50,name:"80√ó50mm (max)",barcodeHeight:55,fontSize:12},"100x80":{width:100,height:80,name:"100√ó80mm (r·∫•t l·ªõn)",barcodeHeight:70,fontSize:14}},jn=({part:d,currentBranchId:m,onClose:b})=>{const i=k.useRef(null),x=k.useRef(null),[f,c]=k.useState(1),[h,l]=k.useState(!0),[t,r]=k.useState(!0),[s,a]=k.useState("40x30"),[n,o]=k.useState("CODE128"),[u,g]=k.useState(1),j=d.barcode||d.sku||d.id.slice(0,12),p=mr[s];k.useEffect(()=>{if(i.current)try{const M=Math.max(1,(p.width-10)/50);st(i.current,j,{format:n,width:M,height:p.barcodeHeight,displayValue:!0,fontSize:p.fontSize,margin:2,textMargin:1,font:"monospace"})}catch(M){console.error("Barcode generation error:",M),st(i.current,j,{format:"CODE128",width:1.2,height:35,displayValue:!0,fontSize:8,margin:2})}},[j,n,s,p]);const E=()=>{if(!x.current)return;const H=window.open("","_blank");if(!H){alert("Vui l√≤ng cho ph√©p popup ƒë·ªÉ in");return}const w=Math.floor(p.width/3),C=d.name.length>w?d.name.slice(0,w)+"...":d.name,S=Array(f).fill(null).map(()=>{var N;return`
        <div class="label" style="
          width: ${p.width}mm;
          height: ${p.height}mm;
          padding: 1mm;
          display: inline-flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          page-break-inside: avoid;
          box-sizing: border-box;
          overflow: hidden;
        ">
          ${t?`<div style="font-size: ${p.fontSize-1}px; font-weight: bold; text-align: center; line-height: 1.1; max-width: 100%; overflow: hidden; white-space: nowrap;">${C}</div>`:""}
          ${((N=i.current)==null?void 0:N.outerHTML)||""}
          ${h?`<div style="font-size: ${p.fontSize}px; font-weight: bold; line-height: 1;">${W(d.retailPrice[m]||0)}</div>`:""}
        </div>
      `}).join("");H.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>In m√£ v·∫°ch - ${d.name}</title>
          <style>
            @page {
              size: ${p.width}mm ${p.height}mm;
              margin: 0;
            }
            * {
              margin: 0;
              padding: 0;
              box-sizing: border-box;
            }
            body {
              font-family: Arial, sans-serif;
              margin: 0;
              padding: 0;
              width: ${p.width*u}mm;
            }
            .labels-container {
              display: flex;
              flex-wrap: wrap;
              width: 100%;
            }
            .label {
              border: none;
            }
            svg {
              max-width: ${p.width-4}mm !important;
              height: auto !important;
            }
            @media print {
              body { 
                margin: 0; 
                padding: 0;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
              }
              .label { 
                page-break-after: always;
              }
              .label:last-child {
                page-break-after: avoid;
              }
            }
          </style>
        </head>
        <body>
          <div class="labels-container">
            ${S}
          </div>
          <script>
            window.onload = function() {
              setTimeout(function() {
                window.print();
                window.onafterprint = function() { window.close(); };
              }, 200);
            };
          <\/script>
        </body>
      </html>
    `),H.document.close()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2",children:[e.jsx(sr,{className:"w-5 h-5 text-blue-600"}),"In m√£ v·∫°ch n·ªôi b·ªô"]}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:"Xprinter XP-360B (20-82mm)"})]}),e.jsx("button",{onClick:b,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200",children:e.jsx(gr,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 rounded-lg p-3",children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-slate-100 text-sm",children:d.name}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-mono mt-1",children:["M√£: ",j]}),e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400 font-semibold mt-1",children:W(d.retailPrice[m]||0)})]}),e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg p-4 flex flex-col items-center bg-white",children:[e.jsxs("p",{className:"text-xs text-slate-500 mb-2",children:["Xem tr∆∞·ªõc nh√£n (",p.name,")"]}),e.jsxs("div",{ref:x,className:"border-2 border-dashed border-slate-300 rounded flex flex-col items-center justify-center bg-white",style:{width:`${p.width}mm`,height:`${p.height}mm`,padding:"1mm"},children:[t&&e.jsx("p",{className:"font-bold text-center text-slate-900 truncate max-w-full leading-tight",style:{fontSize:`${p.fontSize-1}px`},children:d.name.length>Math.floor(p.width/3)?d.name.slice(0,Math.floor(p.width/3))+"...":d.name}),e.jsx("svg",{ref:i,className:"max-w-full"}),h&&e.jsx("p",{className:"font-bold text-slate-900 leading-tight",style:{fontSize:`${p.fontSize}px`},children:W(d.retailPrice[m]||0)})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"K√≠ch th∆∞·ªõc nh√£n (ph√π h·ª£p XP-360B)"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.keys(mr).map(M=>e.jsx("button",{onClick:()=>a(M),className:`px-3 py-2 text-xs rounded-lg transition-colors text-left ${s===M?"bg-blue-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:mr[M].name},M))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"S·ªë l∆∞·ª£ng nh√£n"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>c(Math.max(1,f-1)),className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600",children:e.jsx(ys,{className:"w-4 h-4"})}),e.jsx("input",{type:"number",value:f,onChange:M=>c(Math.max(1,parseInt(M.target.value)||1)),className:"w-16 text-center px-2 py-1 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",min:"1",max:"100"}),e.jsx("button",{onClick:()=>c(Math.min(100,f+1)),className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600",children:e.jsx(ar,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Lo·∫°i m√£ v·∫°ch"}),e.jsxs("select",{value:n,onChange:M=>o(M.target.value),className:"px-3 py-1.5 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",children:[e.jsx("option",{value:"CODE128",children:"CODE128 (ph·ªï bi·∫øn)"}),e.jsx("option",{value:"CODE39",children:"CODE39"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:M=>r(M.target.checked),className:"w-4 h-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:"Hi·ªán t√™n"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:M=>l(M.target.checked),className:"w-4 h-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:"Hi·ªán gi√°"})]})]}),e.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-amber-800 dark:text-amber-300",children:[e.jsx("strong",{children:"üí° M·∫πo:"})," C√†i ƒë·∫∑t kh·ªï gi·∫•y trong driver m√°y in tr√πng v·ªõi k√≠ch th∆∞·ªõc nh√£n ƒë√£ ch·ªçn ƒë·ªÉ in ch√≠nh x√°c."]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 p-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("button",{onClick:b,className:"px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg transition-colors",children:"ƒê√≥ng"}),e.jsxs("button",{onClick:E,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(sr,{className:"w-4 h-4"}),"In ",f," nh√£n"]})]})]})})},fr={"30x20":{width:30,height:20,name:"30√ó20mm",barcodeHeight:25,fontSize:7},"40x30":{width:40,height:30,name:"40√ó30mm",barcodeHeight:35,fontSize:8},"50x30":{width:50,height:30,name:"50√ó30mm",barcodeHeight:40,fontSize:9},"60x40":{width:60,height:40,name:"60√ó40mm",barcodeHeight:45,fontSize:10},"80x50":{width:80,height:50,name:"80√ó50mm",barcodeHeight:55,fontSize:12},"100x80":{width:100,height:80,name:"100√ó80mm",barcodeHeight:70,fontSize:14}},wn=({value:d,format:m,size:b})=>{const i=k.useRef(null);return k.useEffect(()=>{if(i.current)try{st(i.current,d,{format:m,width:1.5,height:b.barcodeHeight,displayValue:!0,fontSize:b.fontSize,margin:2,textMargin:1,font:"monospace"})}catch{st(i.current,d,{format:"CODE128",width:1.2,height:35,displayValue:!0,fontSize:8,margin:2})}},[d,m,b]),e.jsx("svg",{ref:i,className:"max-w-full h-auto"})},Nn=({parts:d,currentBranchId:m,onClose:b})=>{const[i,x]=k.useState("select"),[f,c]=k.useState(new Map),[h,l]=k.useState(""),[t,r]=k.useState("all"),[s,a]=k.useState("40x30"),[n,o]=k.useState("CODE128"),[u,g]=k.useState(!0),[j,p]=k.useState(!0),[E,M]=k.useState("stock"),[H,w]=k.useState(1),[C,S]=k.useState(0),N=6,A=k.useMemo(()=>{const v=new Set;return d.forEach($=>{$.category&&v.add($.category)}),Array.from(v).sort()},[d]),L=k.useMemo(()=>d.filter(v=>{var ce,Re;const $=!h||v.name.toLowerCase().includes(h.toLowerCase())||((ce=v.sku)==null?void 0:ce.toLowerCase().includes(h.toLowerCase()))||((Re=v.barcode)==null?void 0:Re.toLowerCase().includes(h.toLowerCase())),G=t==="all"||v.category===t;return $&&G}),[d,h,t]),O=v=>v.stock[m]||0,D=v=>{const $=new Map(f);if($.has(v.id))$.delete(v.id);else{const G=E==="stock"?Math.max(1,O(v)):E==="fixed"?H:1;$.set(v.id,{part:v,quantity:G})}c($)},R=()=>{const v=new Map(f);L.forEach($=>{if(!v.has($.id)){const G=E==="stock"?Math.max(1,O($)):E==="fixed"?H:1;v.set($.id,{part:$,quantity:G})}}),c(v)},z=()=>{c(new Map)},F=(v,$)=>{const G=new Map(f),ce=G.get(v);ce&&(G.set(v,{...ce,quantity:Math.max(1,$)}),c(G))},se=()=>{const v=new Map;f.forEach(($,G)=>{const ce=E==="stock"?Math.max(1,O($.part)):E==="fixed"?H:$.quantity;v.set(G,{...$,quantity:ce})}),c(v)},he=k.useMemo(()=>{let v=0;return f.forEach($=>{v+=$.quantity}),v},[f]),de=k.useMemo(()=>{const v=[];return f.forEach(({part:$,quantity:G})=>{for(let ce=0;ce<G;ce++)v.push({part:$,index:ce})}),v},[f]),Y=k.useMemo(()=>{const v=C*N;return de.slice(v,v+N)},[de,C,N]),ee=Math.ceil(de.length/N),Q=fr[s],ue=v=>{const $=document.createElementNS("http://www.w3.org/2000/svg","svg");try{st($,v,{format:n,width:Math.max(1,(Q.width-10)/50),height:Q.barcodeHeight,displayValue:!0,fontSize:Q.fontSize,margin:2,textMargin:1,font:"monospace"})}catch{st($,v,{format:"CODE128",width:1.2,height:35,displayValue:!0,fontSize:8,margin:2})}return $.outerHTML},P=()=>{if(f.size===0){alert("Vui l√≤ng ch·ªçn √≠t nh·∫•t 1 s·∫£n ph·∫©m");return}const v=window.open("","_blank");if(!v){alert("Vui l√≤ng cho ph√©p popup ƒë·ªÉ in");return}let $="";f.forEach(({part:G,quantity:ce})=>{const Re=G.barcode||G.sku||G.id.slice(0,12),Oe=ue(Re);for(let ye=0;ye<ce;ye++)$+=`
          <div class="label" style="
            width: ${Q.width}mm;
            height: ${Q.height}mm;
            padding: 1mm;
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            page-break-inside: avoid;
            box-sizing: border-box;
            overflow: hidden;
          ">
            ${j?`<div style="font-size: ${Math.max(7,Q.fontSize-1)}px; font-weight: bold; text-align: center; line-height: 1.2; max-width: 100%; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; word-break: break-word;">${G.name}</div>`:""}
            ${Oe}
            ${u?`<div style="font-size: ${Q.fontSize}px; font-weight: bold; line-height: 1;">${W(G.retailPrice[m]||0)}</div>`:""}
          </div>
        `}),v.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>In m√£ v·∫°ch h√†ng lo·∫°t - ${f.size} s·∫£n ph·∫©m</title>
          <style>
            @page {
              size: ${Q.width}mm ${Q.height}mm;
              margin: 0;
            }
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body {
              font-family: Arial, sans-serif;
              margin: 0;
              padding: 0;
            }
            .labels-container {
              display: flex;
              flex-wrap: wrap;
              width: 100%;
            }
            .label { border: none; }
            svg { max-width: ${Q.width-4}mm !important; height: auto !important; }
            @media print {
              body { margin: 0; padding: 0; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
              .label { page-break-after: always; }
              .label:last-child { page-break-after: avoid; }
            }
          </style>
        </head>
        <body>
          <div class="labels-container">${$}</div>
          <script>
            window.onload = function() {
              setTimeout(function() {
                window.print();
                window.onafterprint = function() { window.close(); };
              }, 300);
            };
          <\/script>
        </body>
      </html>
    `),v.document.close()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-2 md:p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-4xl max-h-[95vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700 shrink-0",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2",children:[e.jsx(sr,{className:"w-5 h-5 text-blue-600"}),"In m√£ v·∫°ch h√†ng lo·∫°t"]}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:i==="select"?"B∆∞·ªõc 1: Ch·ªçn s·∫£n ph·∫©m v√† c√†i ƒë·∫∑t":"B∆∞·ªõc 2: Xem tr∆∞·ªõc v√† ch·ªânh s·ª≠a"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex bg-slate-100 dark:bg-slate-700 rounded-lg p-0.5",children:[e.jsxs("button",{onClick:()=>x("select"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-colors flex items-center gap-1.5 ${i==="select"?"bg-white dark:bg-slate-600 text-blue-600 dark:text-blue-400 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"}`,children:[e.jsx(_s,{className:"w-3.5 h-3.5"}),"Ch·ªçn SP"]}),e.jsxs("button",{onClick:()=>{x("preview"),S(0)},disabled:f.size===0,className:`px-3 py-1.5 text-xs font-medium rounded-md transition-colors flex items-center gap-1.5 ${i==="preview"?"bg-white dark:bg-slate-600 text-blue-600 dark:text-blue-400 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200 disabled:opacity-50 disabled:cursor-not-allowed"}`,children:[e.jsx(Pr,{className:"w-3.5 h-3.5"}),"Xem tr∆∞·ªõc"]})]}),e.jsx("button",{onClick:b,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200",children:e.jsx(gr,{className:"w-5 h-5"})})]})]}),i==="select"?e.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col border-r border-slate-200 dark:border-slate-700 overflow-hidden",children:[e.jsxs("div",{className:"p-3 border-b border-slate-200 dark:border-slate-700 space-y-2 shrink-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ut,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",value:h,onChange:v=>l(v.target.value),placeholder:"T√¨m s·∫£n ph·∫©m, SKU, m√£ v·∫°ch...",className:"w-full pl-9 pr-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:t,onChange:v=>r(v.target.value),className:"flex-1 px-3 py-1.5 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",children:[e.jsx("option",{value:"all",children:"T·∫•t c·∫£ danh m·ª•c"}),A.map(v=>e.jsx("option",{value:v,children:v},v))]}),e.jsx("button",{onClick:R,className:"px-3 py-1.5 text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50",children:"Ch·ªçn t·∫•t c·∫£"}),e.jsx("button",{onClick:z,className:"px-3 py-1.5 text-xs bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-600",children:"B·ªè ch·ªçn"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:L.length===0?e.jsx("div",{className:"text-center py-8 text-slate-500",children:"Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m"}):e.jsx("div",{className:"space-y-1",children:L.map(v=>{const $=f.has(v.id),G=O(v);return e.jsxs("div",{onClick:()=>D(v),className:`flex items-center gap-3 p-2 rounded-lg cursor-pointer transition-colors ${$?"bg-blue-50 dark:bg-blue-900/30 border border-blue-300 dark:border-blue-700":"bg-slate-50 dark:bg-slate-900/50 border border-transparent hover:bg-slate-100 dark:hover:bg-slate-700"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded flex items-center justify-center shrink-0 ${$?"bg-blue-600 text-white":"border-2 border-slate-300 dark:border-slate-600"}`,children:$&&e.jsx(is,{className:"w-3 h-3"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100 truncate",children:v.name}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-mono",children:v.barcode||v.sku})]}),e.jsxs("div",{className:"text-right shrink-0",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"T·ªìn kho"}),e.jsx("p",{className:`text-sm font-bold ${G>0?"text-green-600":"text-red-500"}`,children:G})]})]},v.id)})})})]}),e.jsxs("div",{className:"w-full md:w-80 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-3 border-b border-slate-200 dark:border-slate-700 space-y-3 shrink-0",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:"C√†i ƒë·∫∑t in"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"S·ªë l∆∞·ª£ng nh√£n"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>{M("stock")},className:`flex-1 px-2 py-1.5 text-xs rounded-lg ${E==="stock"?"bg-blue-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300"}`,children:"= T·ªìn kho"}),e.jsx("button",{onClick:()=>{M("fixed")},className:`flex-1 px-2 py-1.5 text-xs rounded-lg ${E==="fixed"?"bg-blue-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300"}`,children:"C·ªë ƒë·ªãnh"}),e.jsx("button",{onClick:()=>{M("custom")},className:`flex-1 px-2 py-1.5 text-xs rounded-lg ${E==="custom"?"bg-blue-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300"}`,children:"T√πy ch·ªânh"})]}),E==="fixed"&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"M·ªói SP in:"}),e.jsx("input",{type:"number",value:H,onChange:v=>w(Math.max(1,parseInt(v.target.value)||1)),className:"w-16 px-2 py-1 text-sm text-center border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700",min:"1"}),e.jsx("span",{className:"text-xs text-slate-500",children:"nh√£n"})]}),f.size>0&&E!=="custom"&&e.jsxs("button",{onClick:se,className:"mt-2 w-full px-2 py-1 text-xs bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300 rounded hover:bg-amber-200",children:["√Åp d·ª•ng cho ",f.size," SP ƒë√£ ch·ªçn"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1",children:"K√≠ch th∆∞·ªõc nh√£n"}),e.jsx("select",{value:s,onChange:v=>a(v.target.value),className:"w-full px-2 py-1.5 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700",children:Object.entries(fr).map(([v,$])=>e.jsx("option",{value:v,children:$.name},v))})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:j,onChange:v=>p(v.target.checked),className:"w-3.5 h-3.5 rounded"}),e.jsx("span",{className:"text-xs text-slate-700 dark:text-slate-300",children:"T√™n"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:v=>g(v.target.checked),className:"w-3.5 h-3.5 rounded"}),e.jsx("span",{className:"text-xs text-slate-700 dark:text-slate-300",children:"Gi√°"})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-2",children:[e.jsxs("h3",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 mb-2 px-1",children:["ƒê√£ ch·ªçn: ",f.size," SP ‚Ä¢ ",he," nh√£n"]}),f.size===0?e.jsxs("div",{className:"text-center py-4 text-slate-400 text-xs",children:[e.jsx(rr,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),"Ch∆∞a ch·ªçn s·∫£n ph·∫©m n√†o"]}):e.jsx("div",{className:"space-y-1",children:Array.from(f.values()).map(({part:v,quantity:$})=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-xs font-medium text-slate-900 dark:text-slate-100 truncate",children:v.name})}),E==="custom"?e.jsx("input",{type:"number",value:$,onChange:G=>F(v.id,parseInt(G.target.value)||1),onClick:G=>G.stopPropagation(),className:"w-14 px-1 py-0.5 text-xs text-center border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700",min:"1"}):e.jsxs("span",{className:"text-xs font-bold text-blue-600 dark:text-blue-400",children:["√ó",$]}),e.jsx("button",{onClick:G=>{G.stopPropagation(),D(v)},className:"text-red-500 hover:text-red-700",children:e.jsx(gr,{className:"w-4 h-4"})})]},v.id))})]})]})]}):e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-3 border-b border-slate-200 dark:border-slate-700 flex flex-wrap items-center gap-3 shrink-0 bg-slate-50 dark:bg-slate-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:"K√≠ch th∆∞·ªõc:"}),e.jsx("select",{value:s,onChange:v=>a(v.target.value),className:"px-2 py-1 text-sm border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700",children:Object.entries(fr).map(([v,$])=>e.jsx("option",{value:v,children:$.name},v))})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:j,onChange:v=>p(v.target.checked),className:"w-3.5 h-3.5 rounded"}),e.jsx("span",{className:"text-xs text-slate-700 dark:text-slate-300",children:"T√™n SP"})]}),e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:v=>g(v.target.checked),className:"w-3.5 h-3.5 rounded"}),e.jsx("span",{className:"text-xs text-slate-700 dark:text-slate-300",children:"Gi√°"})]})]}),e.jsxs("div",{className:"ml-auto text-xs text-slate-500 dark:text-slate-400",children:["T·ªïng:"," ",e.jsx("span",{className:"font-bold text-blue-600",children:he})," ","nh√£n"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-slate-100 dark:bg-slate-900",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 max-w-3xl mx-auto",children:Y.map(({part:v,index:$})=>{const G=v.barcode||v.sku||v.id.slice(0,12);return e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-md p-2 flex flex-col items-center justify-center border-2 border-dashed border-slate-300 dark:border-slate-600",style:{minHeight:`${Q.height*2.5}px`,aspectRatio:`${Q.width}/${Q.height}`},children:[j&&e.jsx("p",{className:"text-xs font-bold text-slate-900 dark:text-slate-100 text-center w-full mb-1 line-clamp-2 leading-tight",style:{fontSize:`${Math.max(9,Q.fontSize-1)}px`},children:v.name}),e.jsx(wn,{value:G,format:n,size:Q}),u&&e.jsx("p",{className:"text-xs font-bold text-slate-900 dark:text-slate-100 mt-1",children:W(v.retailPrice[m]||0)})]},`${v.id}-${$}`)})})}),ee>1&&e.jsxs("div",{className:"flex items-center justify-center gap-3 p-3 border-t border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("button",{onClick:()=>S(v=>Math.max(0,v-1)),disabled:C===0,className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-200 dark:hover:bg-slate-600",children:e.jsx(Mr,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Trang ",e.jsx("span",{className:"font-bold",children:C+1})," /"," ",ee]}),e.jsx("button",{onClick:()=>S(v=>Math.min(ee-1,v+1)),disabled:C>=ee-1,className:"p-1.5 rounded-lg bg-slate-100 dark:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-200 dark:hover:bg-slate-600",children:e.jsx(ds,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-slate-200 dark:border-slate-700 shrink-0",children:[e.jsxs("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:[e.jsx("span",{className:"font-semibold text-blue-600",children:f.size})," ","s·∫£n ph·∫©m ‚Ä¢",e.jsx("span",{className:"font-semibold text-green-600 ml-1",children:he})," ","nh√£n"]}),e.jsx("div",{className:"flex gap-3",children:i==="select"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:b,className:"px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg",children:"ƒê√≥ng"}),e.jsxs("button",{onClick:()=>{x("preview"),S(0)},disabled:f.size===0,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 disabled:cursor-not-allowed rounded-lg flex items-center gap-2",children:[e.jsx(Pr,{className:"w-4 h-4"}),"Xem tr∆∞·ªõc (",he,")"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>x("select"),className:"px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded-lg flex items-center gap-2",children:[e.jsx(Mr,{className:"w-4 h-4"}),"Quay l·∫°i ch·ªânh s·ª≠a"]}),e.jsxs("button",{onClick:P,disabled:f.size===0,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 disabled:bg-slate-400 disabled:cursor-not-allowed rounded-lg flex items-center gap-2",children:[e.jsx(sr,{className:"w-4 h-4"}),"In ",he," nh√£n"]})]})})]})]})})},Ve=5,Ya=({isOpen:d,onClose:m,onSave:b})=>{const[i,x]=k.useState(""),[f,c]=k.useState(""),[h,l]=k.useState(""),[t,r]=k.useState(""),[s,a]=k.useState(1),[n,o]=k.useState(0),[u,g]=k.useState(0),[j,p]=k.useState(0),[E,M]=k.useState("th√°ng"),[H,w]=k.useState(!1),{data:C=[]}=jr(),S=qa(),[N,A]=k.useState(!1),[L,O]=k.useState(""),D=()=>{if(!i.trim()){q.warning("Vui l√≤ng nh·∫≠p t√™n s·∫£n ph·∫©m");return}b({name:i.trim(),description:f.trim(),barcode:h.trim(),category:t||"Ch∆∞a ph√¢n lo·∫°i",quantity:Number(s)||1,importPrice:Number(n)||0,retailPrice:Number(u)||0,warranty:Number(j)||0,warrantyUnit:E}),x(""),c(""),l(""),r(""),a(1),o(0),g(0),p(0),w(!1),M("th√°ng")};return d?e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-end sm:items-center justify-center z-[9999] p-0 sm:p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 w-full sm:rounded-xl sm:max-w-lg max-h-[95vh] sm:max-h-[85vh] overflow-hidden flex flex-col rounded-t-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center px-4 py-4 border-b border-slate-200 dark:border-slate-700 bg-gradient-to-r from-blue-600 to-blue-700 sm:bg-none sm:from-transparent sm:to-transparent",children:[e.jsx("h2",{className:"text-lg font-bold text-white sm:text-slate-900 sm:dark:text-slate-100",children:"‚ûï Th√™m s·∫£n ph·∫©m m·ªõi"}),e.jsx("button",{onClick:m,className:"w-10 h-10 flex items-center justify-center rounded-full bg-white/20 sm:bg-slate-100 sm:dark:bg-slate-700 text-white sm:text-slate-600 sm:dark:text-slate-300 text-2xl font-bold",children:"√ó"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-4 bg-slate-50 dark:bg-slate-900/50",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3 flex items-center gap-2",children:"üì¶ Th√¥ng tin s·∫£n ph·∫©m"}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1.5",children:["T√™n s·∫£n ph·∫©m ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i,onChange:R=>x(R.target.value),className:"w-full px-4 py-3 text-base border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nh·∫≠p t√™n s·∫£n ph·∫©m"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1.5",children:"Danh m·ª•c s·∫£n ph·∫©m"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:t,onChange:R=>r(R.target.value),className:"flex-1 px-4 py-3 text-base border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"-- Ch·ªçn danh m·ª•c --"}),C.map(R=>e.jsx("option",{value:R.name,children:R.name},R.id))]}),e.jsx("button",{type:"button",onClick:()=>A(!0),className:"w-12 h-12 flex items-center justify-center bg-blue-100 dark:bg-blue-900/30 border border-blue-300 dark:border-blue-700 rounded-xl hover:bg-blue-200 dark:hover:bg-blue-800/40 transition-colors","aria-label":"Th√™m danh m·ª•c m·ªõi",children:e.jsx("span",{className:"text-2xl text-blue-600 dark:text-blue-400",children:"+"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1.5",children:"M√£ v·∫°ch / SKU"}),e.jsx("input",{type:"text",value:h,onChange:R=>l(R.target.value),className:"w-full px-4 py-3 text-base border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500",placeholder:"Nh·∫≠p m√£ v·∫°ch (n·∫øu c√≥)"})]})]}),N&&e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-4 shadow-sm",children:e.jsxs("form",{onSubmit:async R=>{R.preventDefault();const z=L.trim();if(!z){q.warning("Vui l√≤ng nh·∫≠p t√™n danh m·ª•c");return}if(z.length<2){q.warning("T√™n qu√° ng·∫Øn");return}try{const F=await S.mutateAsync({name:z});r(F.name),O(""),A(!1)}catch(F){q.error((F==null?void 0:F.message)||"L·ªói t·∫°o danh m·ª•c")}},className:"space-y-3",children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400",children:"T·∫°o danh m·ª•c m·ªõi"}),e.jsx("input",{autoFocus:!0,type:"text",value:L,onChange:R=>O(R.target.value),placeholder:"Nh·∫≠p t√™n danh m·ª•c m·ªõi",className:"w-full px-4 py-3 text-base border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-medium",children:"L∆∞u danh m·ª•c"}),e.jsx("button",{type:"button",onClick:()=>{A(!1),O("")},className:"flex-1 px-4 py-3 border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300",children:"H·ªßy"})]})]})}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3 flex items-center gap-2",children:"üìù M√¥ t·∫£ s·∫£n ph·∫©m"}),e.jsx("textarea",{value:f,onChange:R=>c(R.target.value),rows:2,className:"w-full px-4 py-3 text-base border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500",placeholder:"M√¥ t·∫£ chi ti·∫øt s·∫£n ph·∫©m (t√πy ch·ªçn)"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3 flex items-center gap-2",children:"üí∞ Th√¥ng tin nh·∫≠p kho"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1.5",children:"S·ªë l∆∞·ª£ng"}),e.jsx(He,{value:s,onValue:R=>{const z=pr(n,R);z.warnings.length&&z.warnings.forEach(F=>q.warning(F)),a(Math.max(1,z.clean.quantity))},className:"w-full px-4 py-3 text-base border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-center font-bold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1.5",children:"Gi√° nh·∫≠p (ƒë)"}),e.jsx(He,{value:n,onValue:R=>{const z=pr(R,s);z.warnings.length&&z.warnings.forEach(F=>q.warning(F)),o(z.clean.importPrice),H||g(Math.round(z.clean.importPrice*1.5))},className:"w-full px-4 py-3 text-base border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-right"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1.5",children:"Gi√° b√°n l·∫ª (ƒë)"}),e.jsx(He,{value:u,onValue:R=>{g(Math.max(0,Math.round(R))),w(!0)},className:"w-full px-4 py-3 text-base border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-right"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1.5",children:"B·∫£o h√†nh"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(He,{value:j,onValue:R=>p(Math.max(0,Math.floor(R))),className:"w-16 px-2 py-3 text-base border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-center"}),e.jsxs("select",{value:E,onChange:R=>M(R.target.value),className:"flex-1 px-3 py-3 text-base border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",children:[e.jsx("option",{value:"th√°ng",children:"th√°ng"}),e.jsx("option",{value:"nƒÉm",children:"nƒÉm"}),e.jsx("option",{value:"ng√†y",children:"ng√†y"})]})]})]})]})]})]})}),e.jsx("div",{className:"px-4 py-4 border-t border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:e.jsx("button",{onClick:D,className:"w-full bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white px-4 py-4 rounded-xl font-bold text-lg shadow-lg active:scale-98 transition-all",children:"‚úì L∆∞u v√† Th√™m v√†o gi·ªè h√†ng"})})]})}):null},_n=({isOpen:d,onClose:m,parts:b,currentBranchId:i,onSave:x})=>{const[f,c]=k.useState([]),[h,l]=k.useState(""),[t,r]=k.useState(""),[s,a]=k.useState(0),[n,o]=k.useState("amount"),[u,g]=k.useState("cash"),[j,p]=k.useState("full"),[E,M]=k.useState(0),[H,w]=k.useState(!1);yr(),console.log("üì¶ GoodsReceiptMobileWrapper - parts received:",(b==null?void 0:b.length)||0,b==null?void 0:b.slice(0,2)),console.log("üì¶ currentBranchId:",i),k.useEffect(()=>{d||(c([]),l(""),r(""),a(0),o("amount"),g("cash"),p("full"),M(0))},[d]);const C=N=>{var O;const A=`temp-${Date.now()}-${Math.random().toString(36).slice(2)}`,L=((O=N.barcode)==null?void 0:O.trim())||N.sku||`PT-${Date.now()}`;c(D=>{var R;return[...D,{partId:A,partName:N.name,sku:L,quantity:N.quantity,importPrice:N.importPrice,sellingPrice:N.retailPrice,wholesalePrice:N.wholesalePrice||0,_isNewProduct:!0,_productData:{name:N.name,sku:L,barcode:((R=N.barcode)==null?void 0:R.trim())||"",category:N.category,description:N.description||"",importPrice:N.importPrice,retailPrice:N.retailPrice,wholesalePrice:N.wholesalePrice||Math.round(N.retailPrice*.9)}}]}),q.success("ƒê√£ th√™m s·∫£n ph·∫©m m·ªõi v√†o phi·∫øu. S·∫£n ph·∫©m s·∫Ω ƒë∆∞·ª£c l∆∞u khi nh·∫≠p kho."),w(!1)},S=()=>{if(!h){q.error("Vui l√≤ng ch·ªçn nh√† cung c·∫•p");return}if(f.length===0){q.error("Vui l√≤ng th√™m s·∫£n ph·∫©m");return}const N=f.reduce((D,R)=>D+R.quantity*R.importPrice,0),A=n==="percent"?Math.round(N*s/100):s,L=Math.max(0,N-A);let O=0;j==="full"?O=L:j==="partial"&&(O=E),x(f,h,L,"",{paymentMethod:u,paymentType:j,paidAmount:O,discount:A}),clearDraft(),m()};return e.jsxs(e.Fragment,{children:[e.jsx(As,{isOpen:d,onClose:m,parts:b,receiptItems:f,setReceiptItems:c,selectedSupplier:h,setSelectedSupplier:l,searchTerm:t,setSearchTerm:r,onSave:S,discount:s,setDiscount:a,discountType:n,setDiscountType:o,paymentMethod:u,setPaymentMethod:g,paymentType:j,setPaymentType:p,partialAmount:E,setPartialAmount:M,showAddProductModal:H,setShowAddProductModal:w,onAddNewProduct:C,currentBranchId:i}),e.jsx(Ya,{isOpen:H,onClose:()=>w(!1),onSave:C})]})},Sn=({isOpen:d,onClose:m,parts:b,currentBranchId:i,onSave:x})=>{const[f,c]=k.useState(""),[h,l]=k.useState(""),t=k.useRef(null),[r,s]=k.useState(!1),[a,n]=k.useState(!1),[o,u]=k.useState(""),[g,j]=k.useState(1),{data:p=[]}=wr(),E=Fa(),[M,H]=k.useState(!1),[w,C]=k.useState({name:"",phone:"",address:"",note:""}),S=yr(),[N,A]=k.useState(!1),[L,O]=k.useState([]),[D,R]=k.useState(null),[z,F]=k.useState(null),[se,he]=k.useState(0),[de,Y]=k.useState(0),[ee,Q]=k.useState("amount"),[ue,P]=k.useState(0),v=`goods_receipt_draft_${i}`;k.useEffect(()=>{var _,V;if(d)try{const J=localStorage.getItem(v);if(J){const K=JSON.parse(J);K.timestamp&&Date.now()-K.timestamp<1440*60*1e3?(((_=K.receiptItems)==null?void 0:_.length)>0||K.selectedSupplier)&&(window.confirm(`Ph√°t hi·ªán phi·∫øu nh·∫≠p ch∆∞a ho√†n t·∫•t (${((V=K.receiptItems)==null?void 0:V.length)||0} s·∫£n ph·∫©m).

B·∫°n c√≥ mu·ªën kh√¥i ph·ª•c kh√¥ng?`)?(O(K.receiptItems||[]),u(K.selectedSupplier||""),Y(K.discount||0),Q(K.discountType||"amount"),P(K.discountPercent||0),q.success("ƒê√£ kh√¥i ph·ª•c phi·∫øu nh·∫≠p t·ª´ b·∫£n nh√°p")):localStorage.removeItem(v)):localStorage.removeItem(v)}}catch(J){console.error("L·ªói kh√¥i ph·ª•c draft:",J)}},[d,v]),k.useEffect(()=>{if(d&&(L.length>0||o)){const _={receiptItems:L,selectedSupplier:o,discount:de,discountType:ee,discountPercent:ue,timestamp:Date.now()};localStorage.setItem(v,JSON.stringify(_))}},[d,L,o,de,ee,ue,v]);const $=()=>{localStorage.removeItem(v)},G=k.useMemo(()=>{if(console.log("üîç Desktop Modal - parts:",(b==null?void 0:b.length)||0,b==null?void 0:b.slice(0,2)),console.log("üîç Desktop Modal - searchTerm:",f),!b||b.length===0)return console.log("‚ö†Ô∏è parts is empty or undefined"),[];if(!f||f.trim()==="")return console.log("‚úÖ Showing all parts:",b.length),b;const _=f.toLowerCase().trim(),V=b.filter(J=>{var K,ae;return((K=J.name)==null?void 0:K.toLowerCase().includes(_))||((ae=J.sku)==null?void 0:ae.toLowerCase().includes(_))});return console.log("‚úÖ Filtered results:",V.length),V},[b,f]),ce=_=>{var J,K;L.find(ae=>ae.partId===_.id)?O(ae=>ae.map(ne=>ne.partId===_.id?{...ne,quantity:ne.quantity+1}:ne)):(O([...L,{partId:_.id,partName:_.name,sku:_.sku,quantity:1,importPrice:((J=_.costPrice)==null?void 0:J[i])||0,sellingPrice:_.retailPrice[i]||0,wholesalePrice:((K=_.wholesalePrice)==null?void 0:K[i])||0}]),q.success(`ƒê√£ th√™m ${_.name} v√†o phi·∫øu nh·∫≠p`)),c(""),setTimeout(()=>{var ae;return(ae=t.current)==null?void 0:ae.focus()},100)},Re=_=>{if(_.preventDefault(),!h.trim())return;const V=h.trim(),J=ne=>ne.toLowerCase().replace(/[-\s./\\]/g,""),K=J(V),ae=b.find(ne=>{var ge,Ee,ve;return J(ne.barcode||"")===K||((ge=ne.barcode)==null?void 0:ge.toLowerCase())===V.toLowerCase()||J(ne.sku||"")===K||((Ee=ne.sku)==null?void 0:Ee.toLowerCase())===V.toLowerCase()||((ve=ne.name)==null?void 0:ve.toLowerCase().includes(V.toLowerCase()))});ae?(ce(ae),l("")):(q.error(`Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m c√≥ m√£: ${V}`),l(""))},Oe=_=>{console.log("üì∑ Camera scanned:",_);const V=ae=>ae.toLowerCase().replace(/[-\s./\\]/g,""),J=V(_),K=b.find(ae=>{var ne,ge;return V(ae.barcode||"")===J||((ne=ae.barcode)==null?void 0:ne.toLowerCase())===_.toLowerCase()||V(ae.sku||"")===J||((ge=ae.sku)==null?void 0:ge.toLowerCase())===_.toLowerCase()});K?(L.find(ne=>ne.partId===K.id)?O(ne=>ne.map(ge=>ge.partId===K.id?{...ge,quantity:ge.quantity+1}:ge)):(O(ne=>{var ge,Ee;return[...ne,{partId:K.id,partName:K.name,sku:K.sku,quantity:1,importPrice:((ge=K.costPrice)==null?void 0:ge[i])||0,sellingPrice:K.retailPrice[i]||0,wholesalePrice:((Ee=K.wholesalePrice)==null?void 0:Ee[i])||0}]}),q.success(`ƒê√£ th√™m ${K.name}`)),c("")):q.error(`Kh√¥ng t√¨m th·∫•y: ${_}`)};k.useEffect(()=>{a&&setTimeout(()=>{var _;return(_=t.current)==null?void 0:_.focus()},100)},[a]);const ye=(_,V,J)=>{O(K=>K.map(ae=>ae.partId===_?{...ae,[V]:J}:ae))},Ge=_=>{O(V=>V.filter(J=>J.partId!==_))},T=k.useMemo(()=>L.reduce((_,V)=>_+V.importPrice*V.quantity,0),[L]),te=k.useMemo(()=>Math.max(0,T-de),[T,de]),{profile:Z}=Ia(),le=()=>{var V;if(!ht(Z==null?void 0:Z.role,"part.update_price")){q.error("B·∫°n kh√¥ng c√≥ quy·ªÅn c·∫≠p nh·∫≠t gi√°");return}if(L.length===0){q.warning("Vui l√≤ng ch·ªçn s·∫£n ph·∫©m nh·∫≠p kho");return}(V=p.find(J=>J.id===o))!=null&&V.name,x(L,o,te,"",{paymentMethod:D||"cash",paymentType:z||"full",paidAmount:z==="full"?te:z==="partial"?se:0,discount:de}),$(),O([]),u(""),c(""),Y(0),P(0),Q("amount")},ie=_=>{(async()=>{var V,J;try{const K=((V=_.barcode)==null?void 0:V.trim())||`PT-${Date.now()}`,ae=await S.mutateAsync({name:_.name,sku:K,barcode:((J=_.barcode)==null?void 0:J.trim())||"",category:_.category,description:_.description,stock:{[i]:0},costPrice:{[i]:_.importPrice},retailPrice:{[i]:_.retailPrice},wholesalePrice:{[i]:Math.round(_.retailPrice*.9)}}),ne=(ae==null?void 0:ae.data)||ae,ge=(ne==null?void 0:ne.id)||`temp-${Date.now()}-${Math.random().toString(36).slice(2)}`,Ee=(ne==null?void 0:ne.sku)||K;O(ve=>[...ve,{partId:ge,partName:_.name,sku:Ee,quantity:_.quantity,importPrice:_.importPrice,sellingPrice:_.retailPrice,wholesalePrice:_.wholesalePrice||0}]),q.success("ƒê√£ t·∫°o ph·ª• t√πng m·ªõi v√† th√™m v√†o phi·∫øu nh·∫≠p")}catch(K){q.error((K==null?void 0:K.message)||"L·ªói t·∫°o ph·ª• t√πng m·ªõi")}finally{A(!1)}})()};return d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 w-full max-w-7xl h-[92vh] rounded-2xl shadow-2xl overflow-hidden flex",children:[e.jsxs("div",{className:"w-1/2 flex flex-col bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm border-r border-slate-200/50 dark:border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200/50 dark:border-slate-700/50 bg-gradient-to-r from-blue-50/50 to-indigo-50/50 dark:from-slate-800/50 dark:to-slate-800/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:m,className:"w-9 h-9 flex items-center justify-center hover:bg-white/80 dark:hover:bg-slate-700/80 rounded-lg text-slate-600 dark:text-slate-400 transition-all hover:scale-105",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-base font-bold text-slate-900 dark:text-slate-100",children:"Danh m·ª•c s·∫£n ph·∫©m"}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400",children:"Ch·ªçn ƒë·ªÉ th√™m v√†o gi·ªè"})]})]}),e.jsxs("button",{onClick:()=>A(!0),className:"flex items-center gap-2 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white px-3 py-2 rounded-lg text-xs font-semibold shadow-lg shadow-blue-500/30 transition-all hover:scale-105",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{children:"Th√™m m·ªõi"})]})]}),e.jsxs("div",{className:"p-3 bg-white/50 dark:bg-slate-800/50 space-y-2",children:[a&&e.jsx("form",{onSubmit:Re,children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),e.jsx("input",{ref:t,type:"text",placeholder:"Qu√©t m√£ v·∫°ch ho·∫∑c nh·∫≠p SKU...",value:h,onChange:_=>l(_.target.value),className:"w-full pl-10 pr-8 py-2.5 border-2 border-blue-300 dark:border-blue-600 rounded-xl bg-blue-50/50 dark:bg-blue-900/20 text-slate-900 dark:text-slate-100 text-sm placeholder:text-blue-500/60 dark:placeholder:text-blue-400/60 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all font-mono"}),h&&e.jsx("button",{type:"button",onClick:()=>l(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("button",{type:"button",onClick:()=>{n(!1),l("")},className:"px-3 py-2.5 rounded-xl border-2 border-slate-300 dark:border-slate-600 text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-700 transition-all",title:"ƒê√≥ng",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",placeholder:"Ho·∫∑c t√¨m ki·∫øm th·ªß c√¥ng...",value:f,onChange:_=>c(_.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-sm placeholder:text-slate-400 focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-all"})]}),!a&&e.jsx("button",{type:"button",onClick:()=>{n(!0),setTimeout(()=>{var _;return(_=t.current)==null?void 0:_.focus()},100)},className:"px-3 py-2.5 rounded-xl border-2 border-blue-400 text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-600 dark:text-blue-400 font-semibold text-sm flex items-center gap-1.5 transition-all hover:bg-blue-100 dark:hover:bg-blue-900/40",title:"Qu√©t m√£ v·∫°ch",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})})}),e.jsx("button",{type:"button",onClick:()=>s(!0),className:"px-3 py-2.5 rounded-xl border-2 border-green-500 text-green-600 bg-green-50 dark:bg-green-900/20 font-semibold text-sm flex items-center gap-1.5 transition-all hover:bg-green-100",title:"Qu√©t b·∫±ng camera",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3",children:G.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-400",children:[e.jsx("svg",{className:"w-16 h-16 mb-3 opacity-30",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),e.jsx("p",{className:"text-sm font-medium",children:"Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m"}),e.jsx("p",{className:"text-xs mt-1",children:"Th·ª≠ t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a kh√°c"})]}):e.jsx("div",{className:"space-y-2",children:G.map(_=>e.jsx("div",{onClick:()=>ce(_),className:"group p-3 bg-white dark:bg-slate-800 rounded-xl hover:shadow-lg hover:shadow-blue-500/10 cursor-pointer border border-slate-200 dark:border-slate-700 hover:border-blue-400 dark:hover:border-blue-600 transition-all duration-200 hover:scale-[1.02]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-100 to-indigo-100 dark:from-blue-900/30 dark:to-indigo-900/30 rounded-lg flex items-center justify-center flex-shrink-0 group-hover:scale-110 transition-transform",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-semibold text-sm text-slate-900 dark:text-slate-100 line-clamp-1 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:_.name}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5 flex-wrap",children:[e.jsx("span",{className:"text-[10px] text-blue-600 dark:text-blue-400 font-mono bg-blue-50 dark:bg-blue-900/30 px-1.5 py-0.5 rounded",children:_.sku}),e.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded text-[9px] font-medium ${_.category?`${we(_.category).bg} ${we(_.category).text}`:"bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400"}`,children:_.category||"Ch∆∞a ph√¢n lo·∫°i"})]})]}),e.jsx("svg",{className:"w-5 h-5 text-slate-300 dark:text-slate-600 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},_.id))})})]}),e.jsxs("div",{className:"w-1/2 bg-white dark:bg-slate-800 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700 bg-gradient-to-r from-emerald-50/30 to-teal-50/30 dark:from-slate-800/50 dark:to-slate-800/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("svg",{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),e.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Nh√† cung c·∫•p"}),e.jsxs("button",{onClick:()=>{C({name:"",phone:"",address:"",note:""}),H(!0)},className:"ml-auto flex items-center gap-1 text-xs px-2 py-1 rounded-lg bg-emerald-100 text-emerald-700 hover:bg-emerald-200 dark:bg-emerald-900/30 dark:text-emerald-400 dark:hover:bg-emerald-900/50 font-medium transition-all",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Th√™m NCC"]})]}),e.jsxs("select",{value:o,onChange:_=>u(_.target.value),className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-sm font-medium focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-all",children:[e.jsx("option",{value:"",children:"Ch·ªçn nh√† cung c·∫•p..."}),p.map(_=>e.jsxs("option",{value:_.id,children:[_.name," ",_.phone?`‚Ä¢ ${_.phone}`:""]},_.id))]})]}),M&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl w-full max-w-md p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-100",children:"Th√™m nh√† cung c·∫•p"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 text-slate-600 dark:text-slate-400",children:"T√™n *"}),e.jsx("input",{autoFocus:!0,value:w.name,onChange:_=>C(V=>({...V,name:_.target.value})),className:"w-full px-3 py-2 rounded border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-sm",placeholder:"T√™n nh√† cung c·∫•p"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 text-slate-600 dark:text-slate-400",children:"ƒêi·ªán tho·∫°i"}),e.jsx("input",{value:w.phone,onChange:_=>C(V=>({...V,phone:_.target.value})),className:"w-full px-3 py-2 rounded border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-sm",placeholder:"SƒêT"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 text-slate-600 dark:text-slate-400",children:"ƒê·ªãa ch·ªâ"}),e.jsx("textarea",{rows:2,value:w.address,onChange:_=>C(V=>({...V,address:_.target.value})),className:"w-full px-3 py-2 rounded border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-sm resize-none",placeholder:"ƒê·ªãa ch·ªâ nh√† cung c·∫•p"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 text-slate-600 dark:text-slate-400",children:"Ghi ch√∫"}),e.jsx("textarea",{rows:2,value:w.note,onChange:_=>C(V=>({...V,note:_.target.value})),className:"w-full px-3 py-2 rounded border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-sm resize-none",placeholder:"Th√¥ng tin th√™m (t√πy ch·ªçn)"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx("button",{onClick:()=>H(!1),className:"px-4 py-2 text-sm rounded border border-slate-300 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-700",children:"H·ªßy"}),e.jsx("button",{onClick:async()=>{var _,V;if(!w.name.trim()){q.warning("Nh·∫≠p t√™n nh√† cung c·∫•p");return}try{const J=await E.mutateAsync({name:w.name.trim(),phone:((_=w.phone)==null?void 0:_.trim())||void 0,address:((V=w.address)==null?void 0:V.trim())||void 0});u(J.id),H(!1)}catch{}},className:"px-4 py-2 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",disabled:E.isPending,children:E.isPending?"ƒêang l∆∞u...":"L∆∞u"})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),e.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-slate-100",children:"Gi·ªè h√†ng nh·∫≠p"})]}),e.jsxs("span",{className:"text-xs text-white bg-gradient-to-r from-blue-600 to-indigo-600 px-3 py-1 rounded-full font-semibold shadow-lg",children:[L.length," s·∫£n ph·∫©m"]})]}),L.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-400",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-800 dark:to-slate-700 rounded-2xl flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-12 h-12 text-slate-300 dark:text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),e.jsx("p",{className:"text-sm font-semibold text-slate-500 dark:text-slate-400",children:"Gi·ªè h√†ng tr·ªëng"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Ch·ªçn s·∫£n ph·∫©m b√™n tr√°i ƒë·ªÉ th√™m v√†o"})]}):e.jsx("div",{className:"space-y-2",children:L.map((_,V)=>{const J=b.find(K=>K.id===_.partId);return e.jsxs("div",{className:"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg p-2.5 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-5 h-5 bg-blue-600 rounded flex items-center justify-center flex-shrink-0",children:e.jsxs("span",{className:"text-[10px] font-bold text-white",children:["#",V+1]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-xs text-slate-900 dark:text-slate-100 truncate",children:_.partName}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5 flex-wrap",children:[e.jsx("span",{className:"text-[9px] text-blue-600 dark:text-blue-400 font-mono",children:_.sku}),(J==null?void 0:J.category)&&e.jsx("span",{className:`inline-flex items-center px-1 py-0 rounded text-[8px] font-medium ${we(J.category).bg} ${we(J.category).text}`,children:J.category})]})]}),e.jsx("button",{onClick:()=>Ge(_.partId),className:"w-5 h-5 flex items-center justify-center bg-red-100 dark:bg-red-900/30 rounded text-red-600 dark:text-red-400 hover:bg-red-200 flex-shrink-0 text-sm",title:"X√≥a",children:"√ó"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx("button",{onClick:()=>ye(_.partId,"quantity",Math.max(1,_.quantity-1)),className:"w-6 h-6 flex items-center justify-center bg-slate-100 dark:bg-slate-700 rounded text-slate-600 dark:text-slate-300 hover:bg-blue-50 text-sm",children:"-"}),e.jsx("input",{type:"number",value:_.quantity,onChange:K=>{const ae=parseInt(K.target.value)||1;ye(_.partId,"quantity",Math.max(1,ae))},className:"w-10 px-1 py-1 text-center border border-blue-300 dark:border-blue-700 rounded bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-xs font-semibold",min:"1"}),e.jsx("button",{onClick:()=>ye(_.partId,"quantity",_.quantity+1),className:"w-6 h-6 flex items-center justify-center bg-slate-100 dark:bg-slate-700 rounded text-slate-600 dark:text-slate-300 hover:bg-blue-50 text-sm",children:"+"})]}),e.jsx(He,{value:_.importPrice,onValue:K=>{const{clean:ae}=pr(K,_.quantity),ne=ae.importPrice,ge=Math.round(ne*1.5);O(Ee=>Ee.map(ve=>ve.partId===_.partId?{...ve,importPrice:ne,sellingPrice:ve.sellingPrice===0||ve.sellingPrice===Math.round((ve.importPrice||0)*1.5)?ge:ve.sellingPrice}:ve))},className:"min-w-[70px] max-w-[110px] flex-1 px-2 py-1 border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-right text-xs font-medium focus:border-blue-500",placeholder:"Gi√° nh·∫≠p"}),e.jsx(He,{value:_.sellingPrice,onValue:K=>ye(_.partId,"sellingPrice",Math.max(0,Math.round(K))),className:"min-w-[70px] max-w-[110px] flex-1 px-2 py-1 border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-right text-xs font-medium focus:border-emerald-500",placeholder:"Gi√° b√°n"}),e.jsx("div",{className:"min-w-[70px] text-right flex-shrink-0",children:e.jsx("div",{className:"text-xs font-bold text-blue-600 dark:text-blue-400 whitespace-nowrap",children:W(_.importPrice*_.quantity)})})]})]},_.partId)})})]}),e.jsxs("div",{className:"p-3 border-t-2 border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800",children:[e.jsx("div",{className:"mb-3 p-3 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-semibold text-white uppercase",children:"T·ªïng thanh to√°n"}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xl font-black text-white",children:W(te)}),e.jsxs("div",{className:"text-[10px] text-white/70",children:[L.length," SP"]})]})]})}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{className:"block text-[10px] font-bold text-slate-700 dark:text-slate-300 mb-1.5",children:["Ph∆∞∆°ng th·ª©c thanh to√°n ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{onClick:()=>R("cash"),className:`flex items-center justify-center gap-1.5 px-3 py-2 border-2 rounded-lg text-xs font-bold transition-all ${D==="cash"?"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400":"border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300"}`,children:"üíµ Ti·ªÅn m·∫∑t"}),e.jsx("button",{onClick:()=>R("bank"),className:`flex items-center justify-center gap-1.5 px-3 py-2 border-2 rounded-lg text-xs font-bold transition-all ${D==="bank"?"border-blue-500 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300"}`,children:"üè¶ Chuy·ªÉn kho·∫£n"})]})]}),D&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-[10px] font-bold text-slate-700 dark:text-slate-300 mb-1.5",children:"H√¨nh th·ª©c thanh to√°n"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[e.jsx("button",{onClick:()=>{F("full"),he(0)},className:`px-2 py-1.5 border-2 rounded-lg text-[10px] font-bold transition-all ${z==="full"?"border-blue-500 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300"}`,children:"ƒê·ªß"}),e.jsx("button",{onClick:()=>F("partial"),className:`px-2 py-1.5 border-2 rounded-lg text-[10px] font-bold transition-all ${z==="partial"?"border-orange-500 bg-orange-50 dark:bg-orange-900/30 text-orange-700 dark:text-orange-400":"border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300"}`,children:"1 ph·∫ßn"}),e.jsx("button",{onClick:()=>{F("note"),he(0)},className:`px-2 py-1.5 border-2 rounded-lg text-[10px] font-bold transition-all ${z==="note"?"border-purple-500 bg-purple-50 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400":"border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300"}`,children:"C√¥ng n·ª£"})]})]}),z==="partial"&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-[10px] font-bold text-slate-700 dark:text-slate-300 mb-1.5",children:"S·ªë ti·ªÅn kh√°ch tr·∫£"}),e.jsx(He,{value:se,onValue:_=>he(Math.max(0,Math.round(_))),className:"w-full px-3 py-2 border-2 border-orange-300 dark:border-orange-700 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-right text-sm font-bold focus:border-orange-500",placeholder:"Nh·∫≠p s·ªë ti·ªÅn..."}),e.jsxs("div",{className:"mt-1.5 flex items-center justify-between text-[10px]",children:[e.jsx("span",{className:"text-slate-500",children:"C√≤n l·∫°i:"}),e.jsx("span",{className:"font-bold text-red-600 dark:text-red-400",children:W(Math.max(0,te-se))})]})]}),z&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-[10px] font-bold text-slate-700 dark:text-slate-300 mb-1.5",children:"Lo·∫°i h·∫°ch to√°n"}),e.jsxs("select",{className:"w-full px-3 py-2 border-2 border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-xs font-semibold focus:border-blue-500",children:[e.jsx("option",{children:"Mua h√†ng/nh·∫≠p kho"}),e.jsx("option",{children:"Nh·∫≠p tr·∫£ h√†ng"}),e.jsx("option",{children:"Kh√°c"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:m,className:"flex-1 bg-slate-200 hover:bg-slate-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-slate-900 dark:text-slate-100 px-3 py-2.5 rounded-lg font-bold text-xs transition-all",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),"L∆ØU NH√ÅP"]})}),e.jsx("button",{onClick:()=>{if(!D){q.warning("Vui l√≤ng ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n");return}if(!z){q.warning("Vui l√≤ng ch·ªçn h√¨nh th·ª©c thanh to√°n");return}if(z==="partial"&&se<=0){q.warning("Vui l√≤ng nh·∫≠p s·ªë ti·ªÅn kh√°ch tr·∫£");return}le()},disabled:!D||!z||z==="partial"&&se<=0,className:"flex-1 bg-orange-500 hover:bg-orange-600 text-white px-3 py-2.5 rounded-lg font-bold text-xs transition-all disabled:bg-slate-300 disabled:text-slate-500 disabled:cursor-not-allowed dark:disabled:bg-slate-600 dark:disabled:text-slate-400",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),"NH·∫¨P KHO"]})})]})]})]})]})}),e.jsx(za,{isOpen:r,onClose:()=>s(!1),onScan:Oe}),e.jsx(Ya,{isOpen:N,onClose:()=>A(!1),onSave:ie})]}):null},Cn=({isOpen:d,onClose:m,onSave:b,initialData:i,mode:x})=>{const[f,c]=k.useState((i==null?void 0:i.name)||""),[h,l]=k.useState((i==null?void 0:i.phone)||""),[t,r]=k.useState((i==null?void 0:i.address)||""),[s,a]=k.useState((i==null?void 0:i.email)||"");k.useEffect(()=>{i&&(c(i.name),l(i.phone),r(i.address),a(i.email))},[i]);const n=o=>{if(o.preventDefault(),!f.trim()){q.error("Vui l√≤ng nh·∫≠p t√™n nh√† cung c·∫•p");return}b({name:f.trim(),phone:h.trim(),address:t.trim(),email:s.trim()})};return d?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg w-full max-w-md",children:e.jsxs("form",{onSubmit:n,children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:x==="add"?"Th√™m nh√† cung c·∫•p m·ªõi":"Ch·ªânh s·ª≠a nh√† cung c·∫•p"}),e.jsx("button",{type:"button",onClick:m,className:"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 text-2xl",children:"√ó"})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"T√™n nh√† cung c·∫•p *"}),e.jsx("input",{type:"text",value:f,onChange:o=>c(o.target.value),placeholder:"Nh·∫≠p t√™n nh√† cung c·∫•p",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",required:!0,autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"S·ªë ƒëi·ªán tho·∫°i"}),e.jsx("input",{type:"tel",value:h,onChange:o=>l(o.target.value),placeholder:"Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:s,onChange:o=>a(o.target.value),placeholder:"Nh·∫≠p email",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"ƒê·ªãa ch·ªâ"}),e.jsx("textarea",{value:t,onChange:o=>r(o.target.value),placeholder:"Nh·∫≠p ƒë·ªãa ch·ªâ",rows:3,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 p-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("button",{type:"button",onClick:m,className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700",children:"H·ªßy"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium",children:x==="add"?"Th√™m":"L∆∞u"})]})]})})}):null},En=({isOpen:d,onClose:m,onAdd:b,currentBranchId:i})=>{const[x,f]=k.useState(""),[c,h]=k.useState(null),[l,t]=k.useState(1),[r,s]=k.useState(0),{data:a=[]}=ft({queryKey:["allPartsForReceipt"],queryFn:async()=>{const{data:g,error:j}=await xe.from("parts").select("*").order("name");if(j)throw j;return g||[]}}),n=k.useMemo(()=>{if(!x)return[];const g=x.toLowerCase();return a.filter(j=>{var p,E;return j.name.toLowerCase().includes(g)||((p=j.sku)==null?void 0:p.toLowerCase().includes(g))||((E=j.description)==null?void 0:E.toLowerCase().includes(g))})},[a,x]),o=g=>{var j;h(g),s(((j=g.costPrice)==null?void 0:j[i])||0),f(g.name)},u=g=>{if(g.preventDefault(),!c){q.error("Vui l√≤ng ch·ªçn s·∫£n ph·∫©m");return}if(l<=0){q.error("S·ªë l∆∞·ª£ng ph·∫£i l·ªõn h∆°n 0");return}if(r<0){q.error("ƒê∆°n gi√° kh√¥ng ƒë∆∞·ª£c √¢m");return}b({partId:c.id,partName:c.name,sku:c.sku||"",quantity:l,unitPrice:r}),f(""),h(null),t(1),s(0)};return d?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg w-full max-w-lg",children:e.jsxs("form",{onSubmit:u,children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Th√™m s·∫£n ph·∫©m v√†o phi·∫øu"}),e.jsx("button",{type:"button",onClick:m,className:"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 text-2xl",children:"√ó"})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"T√¨m ki·∫øm s·∫£n ph·∫©m *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:x,onChange:g=>{f(g.target.value),h(null)},placeholder:"Nh·∫≠p t√™n ho·∫∑c SKU s·∫£n ph·∫©m...",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",autoFocus:!0}),x&&!c&&n.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:n.map(g=>{var j;return e.jsxs("button",{type:"button",onClick:()=>o(g),className:"w-full px-3 py-2 text-left hover:bg-slate-100 dark:hover:bg-slate-700 border-b border-slate-200 dark:border-slate-700 last:border-0",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:g.name}),e.jsxs("div",{className:"text-xs text-slate-500",children:["SKU: ",g.sku||"N/A"," | Gi√° nh·∫≠p:"," ",W(((j=g.costPrice)==null?void 0:j[i])||0)]})]},g.id)})})]}),c&&e.jsxs("div",{className:"mt-2 p-2 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded text-sm text-green-800 dark:text-green-200",children:["‚úì ƒê√£ ch·ªçn: ",c.name," (",c.sku,")"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"S·ªë l∆∞·ª£ng *"}),e.jsx("input",{type:"number",value:l,onChange:g=>t(Number(g.target.value)),min:"1",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"ƒê∆°n gi√° nh·∫≠p *"}),e.jsx(He,{value:r,onValue:s,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Th√†nh ti·ªÅn"}),e.jsx("input",{type:"text",value:W(l*r),readOnly:!0,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-slate-100 dark:bg-slate-700 text-slate-900 dark:text-slate-100 font-bold"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 p-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("button",{type:"button",onClick:m,className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700",children:"H·ªßy"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium",children:"Th√™m s·∫£n ph·∫©m"})]})]})})}):null},Pn=({receipt:d,onClose:m,onSave:b,currentBranchId:i})=>{const[x,f]=k.useState(d.supplier),[c,h]=k.useState(""),[l,t]=k.useState(d.supplier),[r,s]=k.useState(!1),[a,n]=k.useState(!1),[o,u]=k.useState("add"),[g,j]=k.useState(!1),[p,E]=k.useState(null),{data:M=[]}=ft({queryKey:["suppliers"],queryFn:async()=>{const{data:P,error:v}=await xe.from("suppliers").select("*").order("name");if(v)throw v;return P||[]}}),H=k.useMemo(()=>{if(!l)return M;const P=l.toLowerCase();return M.filter(v=>v.name.toLowerCase().includes(P))},[M,l]),[w,C]=k.useState(d.items.map(P=>({id:P.id,partName:P.partName,quantity:P.quantity,unitPrice:P.unitPrice||0,totalPrice:P.quantity*(P.unitPrice||0),notes:P.notes||""}))),[S,N]=k.useState([{time:"15:31",date:d.date,payer:"Xu√¢n Nhan",cashier:"(Ti·ªÅn m·∫∑t)",amount:d.total}]),[A,L]=k.useState(!0);mt.useEffect(()=>{var v,$,G;const P=d.items[0];if((v=P==null?void 0:P.notes)!=null&&v.includes("Phone:")){const ce=(G=($=P.notes.split("Phone:")[1])==null?void 0:$.split("NV:")[0])==null?void 0:G.trim();ce&&h(ce)}},[d.items]),mt.useEffect(()=>{const P=v=>{v.target.closest(".supplier-dropdown-container")||s(!1)};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[]);const O=w.reduce((P,v)=>P+v.totalPrice,0),D=S.reduce((P,v)=>P+v.amount,0),R=(P,v)=>{const $=[...w];$[P].quantity=v,$[P].totalPrice=v*$[P].unitPrice,C($)},z=(P,v)=>{const $=[...w];$[P].unitPrice=v,$[P].totalPrice=$[P].quantity*v,C($)},F=P=>{if(w.length===1){q.error("Ph·∫£i c√≥ √≠t nh·∫•t 1 s·∫£n ph·∫©m");return}const v=w.filter(($,G)=>G!==P);C(v),q.success("ƒê√£ x√≥a s·∫£n ph·∫©m")},se=P=>{const v={id:`new-${Date.now()}`,partId:P.partId,partName:P.partName,quantity:P.quantity,unitPrice:P.unitPrice,totalPrice:P.quantity*P.unitPrice,notes:"",sku:P.sku};C([...w,v]),j(!1),q.success(`ƒê√£ th√™m ${P.partName} (s·∫Ω l∆∞u khi b·∫•m L∆ØU)`)},he=P=>{f(P.name),h(P.phone),n(!1),q.success(o==="add"?"ƒê√£ th√™m nh√† cung c·∫•p":"ƒê√£ c·∫≠p nh·∫≠t nh√† cung c·∫•p")},de=()=>{u("edit"),n(!0)},Y=()=>{u("add"),n(!0)},ee=P=>{E(P),q.info("Click v√†o √¥ s·ªë l∆∞·ª£ng ho·∫∑c ƒë∆°n gi√° ƒë·ªÉ ch·ªânh s·ª≠a")},Q=P=>{confirm("B·∫°n c√≥ mu·ªën x√≥a s·∫£n ph·∫©m n√†y?")&&F(P)},ue=P=>{if(P.preventDefault(),!x){q.error("Vui l√≤ng ch·ªçn nh√† cung c·∫•p");return}if(w.some(v=>v.quantity<=0)){q.error("S·ªë l∆∞·ª£ng ph·∫£i l·ªõn h∆°n 0");return}b({supplier:x,supplierPhone:c,items:w,payments:S,isPaid:A})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("form",{onSubmit:ue,children:[e.jsxs("div",{className:"sticky top-0 bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 p-4 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:["[Ch·ªânh s·ª≠a] Phi·∫øu Nh·∫≠p Kho ",d.receiptCode]})]}),e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:[new Date(d.date).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"})," ",new Date(d.date).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})]})]}),e.jsx("button",{type:"button",onClick:m,className:"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 text-2xl w-8 h-8 flex items-center justify-center rounded hover:bg-slate-100 dark:hover:bg-slate-700",children:"√ó"})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-base font-medium text-teal-600 dark:text-teal-400 mb-2",children:"Nh√† cung c·∫•p:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative supplier-dropdown-container",children:[e.jsx("input",{type:"text",value:l,onChange:P=>{t(P.target.value),s(!0)},onFocus:()=>s(!0),placeholder:"T√¨m ki·∫øm v√† ch·ªçn m·ªôt nh√† cung c·∫•p",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"}),l&&e.jsx("button",{type:"button",onClick:()=>{t(""),f(""),h("")},className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",children:"√ó"}),r&&H.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:H.map(P=>e.jsxs("button",{type:"button",onClick:()=>{f(P.name),t(P.name),h(P.phone||""),s(!1)},className:"w-full px-3 py-2 text-left hover:bg-slate-100 dark:hover:bg-slate-700 border-b border-slate-200 dark:border-slate-700 last:border-0",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:P.name}),P.phone&&e.jsxs("div",{className:"text-xs text-slate-500",children:["Phone: ",P.phone]})]},P.id))})]}),e.jsxs("button",{type:"button",onClick:de,className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Ch·ªânh s·ª≠a"]}),e.jsxs("button",{type:"button",onClick:Y,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"+"}),"Th√™m m·ªõi"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"block text-base font-medium text-teal-600 dark:text-teal-400",children:"Chi ti·∫øt s·∫£n ph·∫©m nh·∫≠p kho:"}),e.jsxs("button",{type:"button",onClick:()=>j(!0),className:"text-sm text-teal-600 hover:text-teal-700 dark:text-teal-400 flex items-center gap-1",children:[e.jsx("span",{className:"text-lg",children:"+"}),"Th√™m s·∫£n ph·∫©m"]})]}),e.jsx("div",{className:"border border-slate-300 dark:border-slate-600 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-sm font-medium text-slate-700 dark:text-slate-300",children:"-"}),e.jsx("th",{className:"px-3 py-2 text-left text-sm font-medium text-slate-700 dark:text-slate-300",children:"T√™n"}),e.jsx("th",{className:"px-3 py-2 text-center text-sm font-medium text-slate-700 dark:text-slate-300",children:"SL"}),e.jsx("th",{className:"px-3 py-2 text-right text-sm font-medium text-slate-700 dark:text-slate-300",children:"ƒê∆°n gi√° nh·∫≠p"}),e.jsx("th",{className:"px-3 py-2 text-right text-sm font-medium text-slate-700 dark:text-slate-300",children:"Th√†nh ti·ªÅn"}),e.jsx("th",{className:"px-3 py-2 text-center text-sm font-medium text-slate-700 dark:text-slate-300 w-20"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:w.map((P,v)=>e.jsxs("tr",{className:`hover:bg-slate-50 dark:hover:bg-slate-700/30 transition-colors ${p===v?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[e.jsx("td",{className:"px-3 py-3 text-sm text-slate-900 dark:text-slate-100",children:v+1}),e.jsxs("td",{className:"px-3 py-3",children:[e.jsx("div",{className:"text-sm text-slate-900 dark:text-slate-100",children:P.partName}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"[Kh√°c]"}),e.jsxs("div",{className:"text-xs text-slate-500",children:["- ƒêG B√°n l·∫ª: ",W(7e4)]}),e.jsxs("div",{className:"text-xs text-slate-500",children:["- ƒêG B√°n s·ªâ: ",W(0)]}),e.jsx("div",{className:"text-xs text-red-500",children:"(ƒê√£ xu·∫•t kho)"})]}),e.jsx("td",{className:"px-3 py-3 text-center",children:e.jsx("input",{type:"number",value:P.quantity,onChange:$=>R(v,Number($.target.value)),onFocus:()=>E(v),onBlur:()=>E(null),min:"1",className:"w-16 px-2 py-1 border border-slate-300 dark:border-slate-600 rounded text-center bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})}),e.jsx("td",{className:"px-3 py-3 text-right",children:e.jsx(He,{value:P.unitPrice,onValue:$=>z(v,$),className:"w-28 px-2 py-1 border border-slate-300 dark:border-slate-600 rounded text-right bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})}),e.jsx("td",{className:"px-3 py-3 text-right text-sm font-medium text-slate-900 dark:text-slate-100",children:W(P.totalPrice)}),e.jsx("td",{className:"px-3 py-3 text-center",children:e.jsxs("div",{className:"flex justify-center gap-1",children:[e.jsx("button",{type:"button",onClick:()=>ee(v),className:"p-1 text-blue-400 hover:bg-blue-500/20 rounded",title:"Ch·ªânh s·ª≠a",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{type:"button",onClick:()=>Q(v),className:"p-1 text-slate-400 hover:bg-slate-500/20 rounded",title:"X√≥a s·∫£n ph·∫©m",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})]})})]},P.id))}),e.jsx("tfoot",{className:"bg-slate-50 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:4,className:"px-3 py-2 text-right font-bold text-slate-900 dark:text-slate-100",children:"T·ªîNG:"}),e.jsx("td",{className:"px-3 py-2 text-right font-bold text-slate-900 dark:text-slate-100",children:W(O)}),e.jsx("td",{})]})})]})})]}),e.jsxs("div",{className:"border border-slate-300 dark:border-slate-600 rounded-lg p-4",children:[e.jsx("label",{className:"block text-base font-medium text-teal-600 dark:text-teal-400 mb-3",children:"C√¥ng n·ª£:"}),e.jsxs("div",{className:"flex items-center justify-between mb-3 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[e.jsxs("span",{className:"text-lg font-bold text-red-600 dark:text-red-400",children:["T·ªîNG PH·∫¢I CHI: ",W(O)]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-green-600 dark:text-green-400 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"ƒê√£ thanh to√°n ƒë·ªß"]}),e.jsxs("button",{type:"button",className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-sm flex items-center gap-1",children:[e.jsx("span",{className:"text-lg",children:"+"}),"T·∫°o phi·∫øu chi"]})]})]}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-3 flex items-start gap-1",children:[e.jsx("svg",{className:"w-4 h-4 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"T·ªïng ph·∫£i chi l√† ph√≠ ch∆∞a ph·∫£i tr·∫£ cho ƒë·ªëi t√°c s·ª≠a ch·ªØa"]}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-slate-200 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left text-slate-700 dark:text-slate-300",children:"-"}),e.jsx("th",{className:"px-2 py-2 text-left text-slate-700 dark:text-slate-300",children:"Th·ªùi gian"}),e.jsx("th",{className:"px-2 py-2 text-left text-slate-700 dark:text-slate-300",children:"Ng∆∞·ªùi chi - Ghi ch√∫"}),e.jsx("th",{className:"px-2 py-2 text-right text-slate-700 dark:text-slate-300",children:"S·ªë ti·ªÅn"})]})}),e.jsx("tbody",{children:S.map((P,v)=>e.jsxs("tr",{className:"border-b border-slate-200 dark:border-slate-700",children:[e.jsx("td",{className:"px-2 py-2 text-slate-900 dark:text-slate-100",children:v+1}),e.jsxs("td",{className:"px-2 py-2 text-slate-900 dark:text-slate-100",children:[P.time," ",new Date(P.date).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"})]}),e.jsxs("td",{className:"px-2 py-2",children:[e.jsx("div",{className:"text-slate-900 dark:text-slate-100",children:P.payer}),e.jsx("div",{className:"text-xs text-slate-500",children:P.cashier})]}),e.jsx("td",{className:"px-2 py-2 text-right text-slate-900 dark:text-slate-100",children:W(P.amount)})]},v))}),e.jsx("tfoot",{className:"bg-slate-50 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"px-2 py-2 text-right font-bold text-slate-900 dark:text-slate-100",children:"T·ªïng ƒë√£ chi"}),e.jsx("td",{className:"px-2 py-2 text-right font-bold text-slate-900 dark:text-slate-100",children:W(D)})]})})]})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-white dark:bg-slate-800 border-t border-slate-200 dark:border-slate-700 p-4 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:m,className:"px-6 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700",children:"ƒê√ìNG"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium",children:"L∆ØU"})]})]}),e.jsx(Cn,{isOpen:a,onClose:()=>n(!1),onSave:he,initialData:o==="edit"?{name:x,phone:c,address:"",email:""}:void 0,mode:o}),e.jsx(En,{isOpen:g,onClose:()=>j(!1),onAdd:se,currentBranchId:i})]})})},On=({transactions:d})=>{const m=kr(),{data:b=[]}=Ba(),[i,x]=k.useState("7days"),[f,c]=k.useState(at(new Date,!0)),[h,l]=k.useState(at(new Date,!0)),[t,r]=k.useState(""),[s,a]=k.useState(null),{currentBranchId:n}=nr(),o=k.useMemo(()=>{console.log("üì¶ [InventoryHistorySection] T·ªïng s·ªë giao d·ªãch:",d.length);let w=d.filter(S=>S.type==="Nh·∫≠p kho");console.log("üì¶ [InventoryHistorySection] Giao d·ªãch 'Nh·∫≠p kho':",w.length);const C=new Date;switch(i){case"7days":const S=new Date(C.getTime()-6048e5);w=w.filter(L=>new Date(L.date)>=S);break;case"30days":const N=new Date(C.getTime()-720*60*60*1e3);w=w.filter(L=>new Date(L.date)>=N);break;case"thisMonth":const A=new Date(C.getFullYear(),C.getMonth(),1);w=w.filter(L=>new Date(L.date)>=A);break;case"custom":w=w.filter(L=>{const O=new Date(L.date);return O>=new Date(f)&&O<=new Date(h)});break}if(t){const S=t.toLowerCase();w=w.filter(N=>N.partName.toLowerCase().includes(S)||N.notes&&N.notes.toLowerCase().includes(S))}return w.sort((S,N)=>new Date(N.date).getTime()-new Date(S.date).getTime())},[d,i,f,h,t]),u=k.useMemo(()=>o.reduce((w,C)=>w+C.totalPrice,0),[o]),g=k.useMemo(()=>{const w=new Map;return o.forEach(C=>{var O,D;const S=new Date(C.date),N=`${S.getFullYear()}-${String(S.getMonth()+1).padStart(2,"0")}-${String(S.getDate()).padStart(2,"0")}`,A=(O=C.notes)!=null&&O.includes("NCC:")?(D=C.notes.split("NCC:")[1])==null?void 0:D.trim():"Kh√¥ng x√°c ƒë·ªãnh",L=`${N}_${A}_${S.getHours()}_${S.getMinutes()}`;w.has(L)||w.set(L,[]),w.get(L).push(C)}),Array.from(w.entries()).map(([C,S],N)=>{var D,R,z;const A=S[0],L=new Date(A.date);let O="";if(A.notes){const F=A.notes.match(/NH-\d{8}-\d{3}/);F&&(O=F[0])}return O||(O=`NH-${`${L.getFullYear()}${String(L.getMonth()+1).padStart(2,"0")}${String(L.getDate()).padStart(2,"0")}`}-${String(w.size-N).padStart(3,"0")}`),{receiptCode:O,date:A.date,supplier:(D=A.notes)!=null&&D.includes("NCC:")?(z=(R=A.notes.split("NCC:")[1])==null?void 0:R.split("|")[0])==null?void 0:z.trim():"Kh√¥ng x√°c ƒë·ªãnh",items:S,total:S.reduce((F,se)=>F+se.totalPrice,0)}}).sort((C,S)=>new Date(S.date).getTime()-new Date(C.date).getTime())},[o]),[j,p]=k.useState(new Set),[E,M]=k.useState(new Set),H=w=>{M(C=>{const S=new Set(C);return S.has(w)?S.delete(w):S.add(w),S})};return e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"p-3 sm:p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-slate-900 dark:text-slate-100 mb-3 sm:mb-4",children:"L·ªãch s·ª≠ nh·∫≠p kho"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3 sm:mb-4",children:[{key:"7days",label:"7 ng√†y qua"},{key:"30days",label:"30 ng√†y qua"},{key:"thisMonth",label:"Th√°ng n√†y"},{key:"custom",label:"T√πy ch·ªçn"}].map(w=>e.jsx("button",{onClick:()=>x(w.key),className:`px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg text-sm sm:text-base font-medium transition-colors ${i===w.key?"bg-blue-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:w.label},w.key))}),i==="custom"&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 mb-3 sm:mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"T·ª´ ng√†y"}),e.jsx("input",{type:"date",value:f,onChange:w=>c(w.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-sm sm:text-base"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"ƒê·∫øn ng√†y"}),e.jsx("input",{type:"date",value:h,onChange:w=>l(w.target.value),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-sm sm:text-base"})]})]}),e.jsx("input",{type:"text",placeholder:"Nh√† cung c·∫•p, SKU, t√™n ph·ª• t√πng...",value:t,onChange:w=>r(w.target.value),className:"w-full px-3 py-2 sm:px-4 sm:py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-sm sm:text-base"})]}),e.jsx("div",{className:"px-3 py-3 sm:px-6 sm:py-4 bg-slate-50 dark:bg-slate-900 border-b border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-xs sm:text-sm text-slate-600 dark:text-slate-400",children:["T·ªïng s·ªë phi·∫øu:"," ",e.jsx("span",{className:"text-base sm:text-lg font-bold text-slate-900 dark:text-slate-100",children:g.length})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs sm:text-sm text-slate-600 dark:text-slate-400",children:"T·ªïng gi√° tr·ªã"}),e.jsx("div",{className:"text-base sm:text-lg font-bold text-blue-600",children:W(u)})]})]})}),e.jsxs("div",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:[g.length>0&&e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-4 px-4 py-3 bg-slate-100 dark:bg-slate-700 border-b border-slate-200 dark:border-slate-600 sticky top-0 z-10",children:[e.jsx("div",{className:"col-span-1 text-xs font-semibold text-slate-600 dark:text-slate-300"}),e.jsx("div",{className:"col-span-2 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"M√£ phi·∫øu"}),e.jsx("div",{className:"col-span-2 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"Nh√† cung c·∫•p"}),e.jsx("div",{className:"col-span-4 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"Chi ti·∫øt"}),e.jsx("div",{className:"col-span-2 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"Thanh to√°n"}),e.jsx("div",{className:"col-span-1 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"Thao t√°c"})]}),g.length===0?e.jsxs("div",{className:"px-3 py-8 sm:px-6 sm:py-12 text-center text-slate-500",children:[e.jsx("div",{className:"text-4xl sm:text-6xl mb-4",children:"üì¶"}),e.jsx("div",{className:"text-sm sm:text-base",children:"Kh√¥ng c√≥ d·ªØ li·ªáu"})]}):g.map(w=>{var R,z,F,se,he,de,Y;const C=new Date(w.date),S=C.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}),N=C.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}),A=b.find(ee=>{var Q;return(Q=ee.description)==null?void 0:Q.includes(w.receiptCode)}),L=A?A.totalAmount-A.remainingAmount:w.total,O=(A==null?void 0:A.remainingAmount)||0,D=O>0;return e.jsxs("div",{className:"p-4 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsxs("div",{className:"md:hidden flex flex-col gap-3 bg-white dark:bg-slate-800/60 rounded-2xl border border-slate-200 dark:border-slate-700 p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-cyan-600 dark:text-cyan-300",children:["üì¶ ",w.receiptCode]}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 flex items-center gap-1 mt-1",children:["üìÖ"," ",e.jsxs("span",{children:[S," ¬∑ ",N]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"T·ªïng ti·ªÅn"}),e.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-white",children:W(w.total)})]})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-slate-50 dark:bg-slate-900/30 rounded-2xl p-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center text-orange-600 dark:text-orange-200 font-semibold text-lg",children:"üè¢"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-semibold text-slate-900 dark:text-white",children:w.supplier}),((R=w.items[0].notes)==null?void 0:R.includes("Phone:"))&&e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:["üìû ",(z=w.items[0].notes.split("Phone:")[1])==null?void 0:z.trim()]})]})]}),e.jsx("div",{className:"space-y-2",children:(()=>{const ee=E.has(w.receiptCode),Q=3,ue=ee?w.items:w.items.slice(0,Q),P=w.items.length>Q;return e.jsxs(e.Fragment,{children:[ue.map((v,$)=>e.jsxs("div",{className:"flex items-start justify-between text-sm text-slate-700 dark:text-slate-200",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"font-semibold",children:[v.quantity," x ",v.partName]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[W(v.unitPrice||0)," / s·∫£n ph·∫©m"]})]}),e.jsx("span",{className:"font-bold text-slate-900 dark:text-white",children:W(v.quantity*(v.unitPrice||0))})]},v.id)),P&&e.jsx("button",{onClick:()=>H(w.receiptCode),className:"w-full text-sm text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300 font-medium py-2 flex items-center justify-center gap-1 bg-slate-50 dark:bg-slate-900/50 rounded-lg",children:ee?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"Thu g·ªçn"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),"Xem th√™m (",w.items.length-Q," ","s·∫£n ph·∫©m)"]})})]})})()}),e.jsx("div",{className:"flex flex-wrap gap-2",children:D?e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-200",children:["‚ö†Ô∏è C√≤n n·ª£ ",W(O)]}):e.jsx("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-200",children:"‚úì ƒê√£ thanh to√°n"})}),e.jsx("div",{className:"flex flex-wrap gap-2 pt-3 border-t border-dashed border-slate-200 dark:border-slate-700",children:e.jsx("button",{onClick:()=>a({...w,date:new Date(w.date)}),className:"flex-1 min-w-[120px] px-3 py-2 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-200 text-sm font-medium",children:"Ch·ªânh s·ª≠a"})})]}),e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-4 items-start",children:[e.jsx("div",{className:"col-span-1 flex items-start pt-1",children:e.jsx("input",{type:"checkbox",checked:j.has(w.receiptCode),onChange:ee=>{const Q=new Set(j);ee.target.checked?Q.add(w.receiptCode):Q.delete(w.receiptCode),p(Q)},className:"w-4 h-4 rounded border-slate-300"})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-bold text-cyan-600 dark:text-cyan-400",children:w.receiptCode}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:[S," ",N]}),e.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-300",children:[e.jsx("span",{className:"font-medium",children:"NV:"})," ",((he=(se=(F=w.items[0].notes)==null?void 0:F.split("NV:")[1])==null?void 0:se.split("NCC:")[0])==null?void 0:he.trim())||"Xu√¢n Nhan"]})]})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100",children:w.supplier}),((de=w.items[0].notes)==null?void 0:de.includes("Phone:"))&&e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:["üìû ",(Y=w.items[0].notes.split("Phone:")[1])==null?void 0:Y.trim()]})]})}),e.jsx("div",{className:"col-span-4",children:e.jsx("div",{className:"space-y-1",children:(()=>{const ee=E.has(w.receiptCode),Q=3,ue=ee?w.items:w.items.slice(0,Q),P=w.items.length>Q;return e.jsxs(e.Fragment,{children:[ue.map((v,$)=>e.jsxs("div",{className:"text-xs text-slate-700 dark:text-slate-300",children:[e.jsxs("span",{className:"font-medium",children:[v.quantity," x"]})," ",v.partName,e.jsxs("span",{className:"text-slate-400 ml-1",children:["(",W(v.unitPrice||0),")"]})]},v.id)),P&&e.jsx("button",{onClick:()=>H(w.receiptCode),className:"text-xs text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300 font-medium mt-1 flex items-center gap-1",children:ee?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"Thu g·ªçn"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),"Xem th√™m (",w.items.length-Q," ","s·∫£n ph·∫©m)"]})})]})})()})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"T·ªïng ti·ªÅn:"}),e.jsx("div",{className:"text-base font-bold text-slate-900 dark:text-white",children:W(w.total)}),D?e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400",children:["ƒê√£ tr·∫£: ",W(L)]}),e.jsxs("div",{className:"text-xs font-semibold text-red-600 dark:text-red-400",children:["C√≤n n·ª£: ",W(O)]}),e.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-medium bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300",children:"‚ö†Ô∏è C√≤n n·ª£"})]}):e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",children:"‚úì ƒê√£ thanh to√°n"})})]})}),e.jsx("div",{className:"col-span-1",children:e.jsx("button",{onClick:()=>a({...w,date:new Date(w.date)}),className:"p-1.5 text-blue-400 hover:bg-blue-500/20 rounded transition-colors",title:"Ch·ªânh s·ª≠a",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})})]})]},w.receiptCode)})]}),e.jsx("div",{className:"px-6 py-4 border-t border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Hi·ªÉn th·ªã ",g.length," phi·∫øu nh·∫≠p"]})}),s&&e.jsx(Pn,{receipt:s,onClose:()=>a(null),onSave:async w=>{var C,S,N,A,L,O,D,R,z;try{const F=new Set(s.items.map(Y=>Y.id)),se=new Set(w.items.filter(Y=>!Y.id.startsWith("new-")).map(Y=>Y.id)),he=Array.from(F).filter(Y=>!se.has(Y));for(const Y of he){const ee=s.items.find(v=>v.id===Y);if(!ee)continue;const{data:Q,error:ue}=await xe.from("parts").select("stock").eq("id",ee.partId).single();if(ue)throw new Error(`Kh√¥ng th·ªÉ l·∫•y th√¥ng tin ph·ª• t√πng: ${ue.message}`);if(Q){const $=(((C=Q.stock)==null?void 0:C[n])||0)-ee.quantity;if($<0)throw new Error(`Kh√¥ng th·ªÉ x√≥a s·∫£n ph·∫©m "${ee.partName}" v√¨ s·∫Ω l√†m t·ªìn kho √¢m`);const{error:G}=await xe.from("parts").update({stock:{...Q.stock,[n]:$}}).eq("id",ee.partId);if(G)throw new Error(`Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t t·ªìn kho: ${G.message}`)}const{error:P}=await xe.from("inventory_transactions").delete().eq("id",Y);if(P)throw new Error(`Kh√¥ng th·ªÉ x√≥a giao d·ªãch: ${P.message}`)}for(const Y of w.items){if(Y.id.startsWith("new-"))continue;const ee=s.items.find(ue=>ue.id===Y.id),{error:Q}=await xe.from("inventory_transactions").update({quantity:Y.quantity,unitPrice:Y.unitPrice,totalPrice:Y.totalPrice,notes:`NV:${((A=(N=(S=w.items[0].notes)==null?void 0:S.split("NV:")[1])==null?void 0:N.split("NCC:")[0])==null?void 0:A.trim())||"Xu√¢n Nhan"} NCC:${w.supplier}${w.supplierPhone?` Phone:${w.supplierPhone}`:""}`}).eq("id",Y.id);if(Q)throw Q;if(ee&&ee.quantity!==Y.quantity){const ue=Y.quantity-ee.quantity,{data:P,error:v}=await xe.from("parts").select("stock, id").eq("id",ee.partId).single();if(v)throw new Error(`Kh√¥ng th·ªÉ l·∫•y th√¥ng tin ph·ª• t√πng: ${v.message}`);if(P){const $=((L=P.stock)==null?void 0:L[n])||0,G=$+ue;if(G<0)throw new Error(`Kh√¥ng th·ªÉ gi·∫£m s·ªë l∆∞·ª£ng v√¨ s·∫Ω l√†m t·ªìn kho √¢m (hi·ªán c√≥: ${$})`);const{error:ce}=await xe.from("parts").update({stock:{...P.stock,[n]:G}}).eq("id",P.id);if(ce)throw new Error(`Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t t·ªìn kho: ${ce.message}`)}}}const de=w.items.filter(Y=>Y.id.startsWith("new-"));for(const Y of de){const{data:ee,error:Q}=await xe.from("parts").select("stock, id").eq("id",Y.partId).single();if(Q)throw new Error(`Kh√¥ng th·ªÉ l·∫•y th√¥ng tin ph·ª• t√πng: ${Q.message}`);if(ee){const v=(((O=ee.stock)==null?void 0:O[n])||0)+Y.quantity,{error:$}=await xe.from("parts").update({stock:{...ee.stock,[n]:v}}).eq("id",ee.id);if($)throw new Error(`Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t t·ªìn kho: ${$.message}`)}const{error:ue}=await xe.from("inventory_transactions").insert({type:"Nh·∫≠p kho",partId:Y.partId,partName:Y.partName,quantity:Y.quantity,date:s.date.toISOString(),unitPrice:Y.unitPrice,totalPrice:Y.totalPrice,branchId:n,notes:`NV:${((z=(R=(D=w.items[0].notes)==null?void 0:D.split("NV:")[1])==null?void 0:R.split("NCC:")[0])==null?void 0:z.trim())||"Xu√¢n Nhan"} NCC:${w.supplier}${w.supplierPhone?` Phone:${w.supplierPhone}`:""}`});if(ue)throw new Error(`Kh√¥ng th·ªÉ t·∫°o giao d·ªãch m·ªõi: ${ue.message}`)}q.success(`ƒê√£ c·∫≠p nh·∫≠t phi·∫øu nh·∫≠p kho (${w.items.length} s·∫£n ph·∫©m)`),m.invalidateQueries({queryKey:["inventoryTransactions"]}),m.invalidateQueries({queryKey:["partsRepo"]}),m.invalidateQueries({queryKey:["partsRepoPaged"]}),a(null)}catch(F){q.error(`L·ªói c·∫≠p nh·∫≠t: ${F.message||"Kh√¥ng r√µ"}`)}},currentBranchId:n})]})},Wn=()=>{var Er;const{currentBranchId:d}=nr(),[m,b]=cs(),{mutateAsync:i}=ps(),x=vs(),{data:f=[]}=ks({branchId:d}),[c,h]=k.useState("stock"),[l,t]=k.useState(!1),[r,s]=k.useState(""),[a,n]=k.useState("all"),[o,u]=k.useState("all"),[g,j]=k.useState(!1),[p,E]=k.useState(1),[M,H]=k.useState(20),[w,C]=k.useState([]),[S,N]=k.useState(null),[A,L]=k.useState(!1),[O,D]=k.useState(!1),[R,z]=k.useState(null),[F,se]=k.useState(!1),[he,de]=k.useState(null),[Y,ee]=k.useState({top:0,right:0}),Q=y=>{if(!y)return"#94a3b8";let I=0;for(let X=0;X<y.length;X++)I=y.charCodeAt(X)+((I<<5)-I);const U=(I&16777215).toString(16).toUpperCase();return`#${"00000".substring(0,6-U.length)+U}`},{confirm:ue,confirmState:P,handleConfirm:v,handleCancel:$}=ms();k.useEffect(()=>{const y=m.get("stock");y&&["all","in-stock","low-stock","out-of-stock"].includes(y)&&(u(y),m.delete("stock"),b(m,{replace:!0}))},[m,b]);const{data:G,isLoading:ce,isError:Re}=Ra({page:p,pageSize:M,search:r,category:a==="all"?void 0:a}),Oe=(G==null?void 0:G.data)||[],ye=((Er=G==null?void 0:G.meta)==null?void 0:Er.total)||0,Ge=Math.max(1,Math.ceil(ye/M)),{data:T,refetch:te}=ft({queryKey:["allPartsForTotals",d,r,a],queryFn:async()=>{console.log("üîÑ Fetching allPartsForTotals...");let y=xe.from("parts").select("id, name, sku, category, stock, costPrice, retailPrice").order("name");if(a&&a!=="all"&&(y=y.eq("category",a)),r&&r.trim()){const X=r.trim();y=y.or(`name.ilike.%${X}%,sku.ilike.%${X}%`)}const{data:I,error:U}=await y;if(U)throw U;return console.log(`‚úÖ Fetched ${(I==null?void 0:I.length)||0} parts`),I||[]},staleTime:5e3}),Z=k.useMemo(()=>{if(!T)return{totalProducts:0,inStock:0,lowStock:0,outOfStock:0};const y={totalProducts:T.length,inStock:0,lowStock:0,outOfStock:0},I=d||"";return T.forEach(U=>{var oe;const X=((oe=U.stock)==null?void 0:oe[I])||0;X>0&&(y.inStock+=1),X===0&&(y.outOfStock+=1),X>0&&X<=Ve&&(y.lowStock+=1)}),y},[T,d]),le=k.useMemo(()=>[{id:"all",label:"T·∫•t c·∫£",description:"To√†n b·ªô kho",count:Z.totalProducts,variant:"neutral"},{id:"in-stock",label:"C√≤n h√†ng",description:"> 0",count:Z.inStock,variant:"success"},{id:"low-stock",label:"S·∫Øp h·∫øt",description:`<= ${Ve}`,count:Z.lowStock,variant:"warning"},{id:"out-of-stock",label:"H·∫øt h√†ng",description:"= 0",count:Z.outOfStock,variant:"danger"}],[Z]),ie=k.useMemo(()=>{if(!T)return new Set;const y=new Map;T.forEach(U=>{if(!U.sku)return;const X=y.get(U.sku)||0;y.set(U.sku,X+1)});const I=new Set(Array.from(y.entries()).filter(([U,X])=>X>1).map(([U,X])=>U));return console.log(`üîç Detected ${I.size} duplicate product SKUs from ${T.length} parts`),I.size>0&&console.log("Duplicate SKUs:",Array.from(I).slice(0,5)),I},[T]),_=k.useCallback(y=>ie.has(y),[ie]),{data:V}=ft({queryKey:["duplicateParts",d,Array.from(ie)],queryFn:async()=>{if(ie.size===0)return[];console.log(`üîç Fetching all duplicate parts for ${ie.size} SKUs...`);const{data:y,error:I}=await xe.from("parts").select("*").in("sku",Array.from(ie)).order("sku");if(I)throw I;return console.log(`‚úÖ Found ${(y==null?void 0:y.length)||0} parts with duplicate SKUs`),y||[]},enabled:g&&ie.size>0,staleTime:5e3}),J=k.useMemo(()=>{const y=g&&ie.size>0?V||[]:Oe;if(o==="all")return y;const I=d||"";return y.filter(U=>{var oe;const X=((oe=U.stock)==null?void 0:oe[I])||0;return o==="in-stock"?X>0:o==="low-stock"?X>0&&X<=Ve:o==="out-of-stock"?X===0:!0})},[Oe,g,ie,V,o,d]);k.useEffect(()=>{g&&ie.size===0&&j(!1)},[g,ie.size]);const K=k.useMemo(()=>T?T.reduce((y,I)=>{var U;return y+(((U=I.stock)==null?void 0:U[d])||0)},0):0,[T,d]),ae=k.useMemo(()=>T?T.reduce((y,I)=>{var oe,Ne;const U=((oe=I.stock)==null?void 0:oe[d])||0,X=((Ne=I.costPrice)==null?void 0:Ne[d])||0;return y+U*X},0):0,[T,d]),ne=kr(),ge=us(),Ee=yr(),ve=hs(),{data:Ja=[]}=jr(),{profile:be}=Ia(),Nr=k.useCallback(async(y,I,U,X,oe)=>{const Ne=new Date,Le=Ne.toISOString().split("T")[0].replace(/-/g,""),Me=`NH-${Le}-${Math.floor(Math.random()*1e3).toString().padStart(3,"0")}`;console.log("üì¶ Saving goods receipt:",{receiptCode:Me,supplierId:I,totalAmount:U,paymentInfo:oe,itemCount:y.length});const{data:$e}=await xe.from("suppliers").select("name").eq("id",I).single(),Ie=($e==null?void 0:$e.name)||"Kh√¥ng x√°c ƒë·ªãnh",De=(oe==null?void 0:oe.paidAmount)||0,qe=U-De;try{const Ae=await Promise.all(y.map(async re=>{if(re._isNewProduct&&re._productData){const pe=await Ee.mutateAsync({name:re._productData.name,sku:re._productData.sku,barcode:re._productData.barcode||"",category:re._productData.category,description:re._productData.description||"",stock:{[d]:0},costPrice:{[d]:re._productData.importPrice},retailPrice:{[d]:re._productData.retailPrice},wholesalePrice:{[d]:re._productData.wholesalePrice||Math.round(re._productData.retailPrice*.9)}}),Be=(pe==null?void 0:pe.data)||pe,ze=(Be==null?void 0:Be.id)||re.partId;return console.log(`‚úÖ Created new product: ${re._productData.name} with ID: ${ze}`),{partId:ze,partName:re.partName,quantity:re.quantity,importPrice:re.importPrice,sellingPrice:re.sellingPrice,wholesalePrice:re.wholesalePrice||0}}return{partId:re.partId,partName:re.partName,quantity:re.quantity,importPrice:re.importPrice,sellingPrice:re.sellingPrice,wholesalePrice:re.wholesalePrice||0}}));if(await x.mutateAsync({items:Ae,supplierId:I,branchId:d,userId:(be==null?void 0:be.id)||"unknown",notes:`${Me} | NCC: ${Ie}${X?" | "+X:""}`}),qe>0&&oe){const re=`DEBT-${Le}-${Math.random().toString(36).substring(2,5).toUpperCase()}`,{error:pe}=await xe.from("supplier_debts").insert({id:re,supplier_id:I,supplier_name:Ie,branch_id:d,total_amount:qe,paid_amount:0,remaining_amount:qe,description:`Nh·∫≠p kho ${Me} - Thanh to√°n ${De.toLocaleString()}/${U.toLocaleString()} ƒë`,created_date:Ne.toISOString().split("T")[0],created_at:Ne.toISOString()});pe?(console.error("‚ùå Error creating debt:",pe),q.error("L·ªói t·∫°o c√¥ng n·ª£: "+pe.message)):console.log(`‚úÖ Created supplier debt: ${qe.toLocaleString()} ƒë`)}t(!1),q.success(`Nh·∫≠p kho th√†nh c√¥ng! M√£ phi·∫øu: ${Me}`),br((be==null?void 0:be.id)||null,{action:"inventory.receipt",tableName:"inventory_transactions",oldData:null,newData:{receiptCode:Me,supplierId:I,supplierName:Ie,items:y.map(re=>({partId:re.partId,quantity:re.quantity,importPrice:re.importPrice,sellingPrice:re.sellingPrice})),totalAmount:U,paidAmount:De,debtAmount:qe,paymentInfo:oe}})}catch(Ae){console.error("üõë L·ªói l∆∞u phi·∫øu nh·∫≠p kho:",Ae),q.error(`L·ªói: ${Ae.message||"Kh√¥ng r√µ"}`)}},[T,d,ge,Ee,i,x,be==null?void 0:be.id]),Za=y=>{C(y?J.map(I=>I.id):[])},es=(y,I)=>{C(I?[...w,y]:w.filter(U=>U!==y))},_r=async y=>{const I=Oe.find(X=>X.id===y);!I||!await ue({title:"X√°c nh·∫≠n x√≥a",message:`B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a s·∫£n ph·∫©m "${I.name}"?`,confirmText:"X√≥a",cancelText:"H·ªßy",confirmColor:"red"})||ve.mutate({id:y},{onSuccess:async()=>{C(X=>X.filter(oe=>oe!==y)),await te(),console.log("üîÑ Refetched allPartsForTotals after delete"),q.success(`ƒê√£ x√≥a ph·ª• t√πng "${I.name}"`)},onError:X=>{console.error("Delete error:",X),q.error(`Kh√¥ng th·ªÉ x√≥a: ${X.message}`)}})},ts=async()=>{if(w.length===0){q.warning("Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt s·∫£n ph·∫©m");return}if(!await ue({title:"X√°c nh·∫≠n x√≥a",message:`B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a ${w.length} s·∫£n ph·∫©m ƒë√£ ch·ªçn? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.`,confirmText:"X√≥a",cancelText:"H·ªßy",confirmColor:"red"}))return;let I=0,U=0;const X=w.length;w.forEach((oe,Ne)=>{ve.mutate({id:oe},{onSuccess:async()=>{I++,I+U===X&&(await te(),console.log("üîÑ Refetched allPartsForTotals after bulk delete"),U===0?q.success(`ƒê√£ x√≥a ${I} ph·ª• t√πng`):q.warning(`ƒê√£ x√≥a ${I}/${X} ph·ª• t√πng (${U} l·ªói)`))},onError:Le=>{console.error(`Delete error for item ${oe}:`,Le),U++,I+U===X&&(I===0?q.error(`Kh√¥ng th·ªÉ x√≥a ${X} ph·ª• t√πng`):q.warning(`ƒê√£ x√≥a ${I}/${X} ph·ª• t√πng (${U} l·ªói)`))}})}),C([])},dr=y=>{E(1),u(y)},rs=y=>{E(1),n(y)},as=Z.lowStock>0&&o!=="low-stock";Z.totalProducts>0&&Math.round(Z.lowStock/Z.totalProducts*100);const Sr=()=>{try{const y=new Date,I=`ton-kho-${y.getDate()}-${y.getMonth()+1}-${y.getFullYear()}.xlsx`;Ss(Oe,d,I),q.success("Xu·∫•t file Excel th√†nh c√¥ng!")}catch(y){console.error("Export error:",y),q.error("C√≥ l·ªói khi xu·∫•t file Excel")}},Cr=()=>{try{Cs(),q.success("T·∫£i template th√†nh c√¥ng! Vui l√≤ng ƒëi·ªÅn th√¥ng tin v√† import l·∫°i.")}catch(y){console.error("Template download error:",y),q.error("C√≥ l·ªói khi t·∫£i template")}};return k.useEffect(()=>{if(typeof document>"u")return;const y=()=>de(null);return document.addEventListener("click",y),()=>document.removeEventListener("click",y)},[]),e.jsxs("div",{className:"h-full flex flex-col bg-slate-50 dark:bg-slate-900 sm:bg-[#1e293b]",children:[e.jsx("div",{className:"hidden sm:block bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 px-3 py-1.5",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"flex gap-1",children:[{key:"stock",label:"T·ªìn kho",icon:e.jsx(cr,{className:"w-3.5 h-3.5"})},{key:"categories",label:"Danh m·ª•c",icon:e.jsx(rr,{className:"w-3.5 h-3.5"})},{key:"lookup",label:"Tra c·ª©u",icon:e.jsx(ut,{className:"w-3.5 h-3.5"})},{key:"history",label:"L·ªãch s·ª≠",icon:e.jsx(ur,{className:"w-3.5 h-3.5"})}].map(y=>e.jsx("button",{onClick:()=>h(y.key),className:`px-2.5 py-1.5 rounded-md text-xs font-medium transition-colors ${c===y.key?"bg-blue-600 text-white":"text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:bg-slate-700"}`,children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:[y.icon,y.label]})},y.key))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>D(!0),className:"flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg bg-emerald-600 text-white text-xs font-medium hover:bg-emerald-700 transition",title:"In m√£ v·∫°ch h√†ng lo·∫°t",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"In m√£ v·∫°ch"]}),ht(be==null?void 0:be.role,"inventory.import")&&e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-blue-600 text-white text-xs font-medium hover:bg-blue-700 transition",children:[e.jsx(ar,{className:"w-3.5 h-3.5"}),"T·∫°o phi·∫øu nh·∫≠p"]}),e.jsxs("div",{className:"flex items-center gap-0.5 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-100 dark:bg-slate-700 px-1 py-0.5",children:[ht(be==null?void 0:be.role,"inventory.import")&&e.jsx("button",{onClick:()=>{q.info("T√≠nh nƒÉng chuy·ªÉn kho ƒëang ph√°t tri·ªÉn")},className:"p-1.5 rounded-md text-slate-600 dark:text-slate-300 hover:text-blue-600 hover:bg-white dark:bg-slate-800 transition",title:"Chuy·ªÉn kho",children:e.jsx(Lr,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:Sr,className:"p-1.5 rounded-md text-slate-600 dark:text-slate-300 hover:text-emerald-600 hover:bg-white dark:bg-slate-800 transition",title:"Xu·∫•t Excel",children:e.jsx(ws,{className:"w-3.5 h-3.5"})}),ht(be==null?void 0:be.role,"inventory.import")&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>L(!0),className:"p-1.5 rounded-md text-slate-600 dark:text-slate-300 hover:text-blue-600 hover:bg-white dark:bg-slate-800 transition",title:"Nh·∫≠p CSV",children:e.jsx(js,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:Cr,className:"p-1.5 rounded-md text-slate-600 dark:text-slate-300 hover:text-amber-600 hover:bg-white dark:bg-slate-800 transition",title:"T·∫£i m·∫´u import",children:e.jsx(ur,{className:"w-3.5 h-3.5"})})]})]})]})]})}),e.jsxs("div",{className:"sm:hidden bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 px-3 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ut,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"T√¨m ki·∫øm theo t√™n ho·∫∑c SKU...",value:r,onChange:y=>{E(1),s(y.target.value)},className:"w-full pl-10 pr-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),ht(be==null?void 0:be.role,"inventory.import")&&e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center gap-1.5 px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition whitespace-nowrap",children:[e.jsx(ar,{className:"w-4 h-4"}),"T·∫°o phi·∫øu"]})]}),e.jsx("div",{className:"flex items-center justify-between text-xs",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"T·ªïng:"}),e.jsxs("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:[K.toLocaleString()," sp"]})]}),e.jsx("div",{className:"h-3 w-px bg-slate-300 dark:bg-slate-600"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Gi√° tr·ªã:"}),e.jsx("span",{className:"font-semibold text-green-600 dark:text-green-400",children:W(ae)})]})]})})]}),c==="stock"&&e.jsx("div",{className:"hidden sm:block bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 px-4 py-2",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg border border-blue-500/20 bg-blue-500/5",children:[e.jsx(cr,{className:"w-4 h-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:K.toLocaleString()}),e.jsx("span",{className:"text-[10px] text-slate-600 dark:text-slate-300 ml-1",children:"sp"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg border border-emerald-500/20 bg-emerald-500/5",children:[e.jsx(rr,{className:"w-4 h-4 text-emerald-600"}),e.jsx("div",{children:e.jsx("span",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:W(ae)})})]})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ut,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"T√¨m ki·∫øm theo t√™n ho·∫∑c SKU...",value:r,onChange:y=>{E(1),s(y.target.value)},className:"w-full pl-9 pr-16 py-1.5 text-sm border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsxs("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-[10px] text-slate-600 dark:text-slate-300",children:[J.length,"/",ye]})]}),e.jsxs("button",{onClick:()=>se(y=>!y),className:`flex items-center gap-1.5 px-2.5 py-1.5 text-xs font-medium rounded-lg border transition flex-shrink-0 ${F?"border-blue-500 text-blue-600 bg-blue-50 dark:bg-blue-900/20":"border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:text-slate-100"}`,children:[e.jsx(Ns,{className:"w-3.5 h-3.5"}),"B·ªô l·ªçc n√¢ng cao"]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[le.map(y=>{const I=o===y.id,U={neutral:I?"bg-slate-600 text-white":"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700",success:I?"bg-emerald-600 text-white":"bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400 hover:bg-emerald-100",warning:I?"bg-amber-600 text-white":"bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-400 hover:bg-amber-100",danger:I?"bg-red-600 text-white":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 hover:bg-red-100"};return e.jsxs("button",{onClick:()=>dr(y.id),className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium transition ${U[y.variant||"neutral"]}`,children:[e.jsx("span",{children:y.label}),e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] font-bold ${I?"bg-white/20":"bg-black/10 dark:bg-white/10"}`,children:y.count})]},y.id)}),as&&e.jsxs("div",{className:"ml-auto flex items-center gap-2 text-amber-700 dark:text-amber-400",children:[e.jsxs("span",{className:"text-xs",children:["‚ö†Ô∏è ",Z.lowStock," s·∫Øp h·∫øt"]}),e.jsx("button",{onClick:()=>dr("low-stock"),className:"px-2 py-0.5 rounded text-[10px] font-semibold bg-amber-600 text-white hover:bg-amber-700",children:"L·ªçc"})]})]}),F&&e.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-700 bg-white/70 dark:bg-slate-900/40 p-3 grid gap-3 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600 dark:text-slate-300",children:"Tr·∫°ng th√°i t·ªìn kho"}),e.jsxs("select",{value:o,onChange:y=>dr(y.target.value),className:"mt-1 w-full rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 px-3 py-1.5 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500/40",children:[e.jsx("option",{value:"all",children:"T·∫•t c·∫£ t·ªìn kho"}),e.jsx("option",{value:"in-stock",children:"C√≤n h√†ng"}),e.jsx("option",{value:"low-stock",children:"S·∫Øp h·∫øt"}),e.jsx("option",{value:"out-of-stock",children:"H·∫øt h√†ng"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600 dark:text-slate-300",children:"Danh m·ª•c"}),e.jsxs("select",{value:a,onChange:y=>rs(y.target.value),className:"mt-1 w-full rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 px-3 py-1.5 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500/40",children:[e.jsx("option",{value:"all",children:"T·∫•t c·∫£ danh m·ª•c"}),Ja.map(y=>e.jsx("option",{value:y.id,children:y.name},y.id))]})]}),e.jsxs("div",{className:"flex flex-col justify-end",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600 dark:text-slate-300",children:"Ph√°t hi·ªán tr√πng m√£"}),e.jsx("button",{onClick:()=>j(y=>!y),className:`mt-1 rounded-lg border px-3 py-1.5 text-sm font-medium transition ${g?"border-orange-500 text-orange-600 bg-orange-50 dark:bg-orange-900/20":"border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:text-slate-100"}`,children:g?"ƒêang l·ªçc tr√πng m√£":"L·ªçc tr√πng m√£"})]})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-2 sm:p-3",children:[c==="stock"&&e.jsxs("div",{className:"space-y-2",children:[ie.size>0&&e.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 border-l-4 border-orange-500 px-3 py-2 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"‚ö†Ô∏è"}),e.jsxs("span",{className:"text-xs font-semibold text-orange-800 dark:text-orange-300",children:["Ph√°t hi·ªán ",ie.size," s·∫£n ph·∫©m tr√πng m√£"]})]}),e.jsx("button",{onClick:()=>j(!g),className:`px-2 py-0.5 rounded text-[10px] font-medium transition ${g?"bg-orange-600 text-white":"bg-orange-100 dark:bg-orange-900/40 text-orange-800 dark:text-orange-300"}`,children:g?"‚úì ƒêang l·ªçc":"üîç L·ªçc"})]}),e.jsxs("div",{className:"rounded-lg overflow-hidden bg-white dark:bg-slate-800",children:[w.length>0&&e.jsxs("div",{className:"px-4 py-2 bg-blue-100 dark:bg-blue-900/30 border-b border-slate-200 dark:border-slate-700 flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs font-medium text-blue-900 dark:text-blue-100",children:["ƒê√£ ch·ªçn ",w.length," s·∫£n ph·∫©m"]}),e.jsxs("button",{onClick:ts,className:"flex items-center gap-2 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm font-medium transition-colors",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"X√≥a ƒë√£ ch·ªçn"]})]}),e.jsx("div",{className:"block sm:hidden",children:e.jsx("div",{className:"space-y-3 p-3",children:J.map((y,I)=>{const U=y.stock[d]||0,X=y.retailPrice[d]||0,oe=_(y.sku||"");return e.jsx("div",{className:`p-3 rounded-xl bg-[#2d3748] border border-slate-600 transition ${oe?"border-l-4 border-l-orange-500":""}`,role:"listitem",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[15px] font-medium text-white leading-tight",children:y.name}),e.jsxs("div",{className:"text-[11px] text-blue-400 mt-1 truncate font-mono",children:["SKU: ",y.sku]}),y.category&&e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 mt-1.5 rounded-full text-[10px] font-medium ${we(y.category).bg} ${we(y.category).text}`,children:y.category})]}),e.jsx("div",{className:"text-right flex-shrink-0",children:e.jsx("div",{className:"text-[13px] text-emerald-400 font-semibold",children:W(X)})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 text-sm font-bold rounded-lg ${U===0?"text-red-300 bg-red-900/40 border border-red-700/50":U<Ve?"text-yellow-300 bg-yellow-900/40 border border-yellow-700/50":"text-emerald-300 bg-emerald-900/40 border border-emerald-700/50"}`,children:[e.jsx("span",{className:"text-xs opacity-80",children:"SL:"}),U]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>z(R===I?null:I),"aria-haspopup":"true","aria-expanded":R===I,"aria-label":"Th√™m h√†nh ƒë·ªông",className:"p-2.5 -m-1 text-slate-400 hover:bg-slate-600 rounded-lg transition active:bg-slate-500",children:e.jsx(Tr,{className:"w-5 h-5"})}),R===I&&e.jsxs("div",{className:"absolute right-0 bottom-full mb-2 w-40 bg-slate-800 border border-slate-700 rounded-lg shadow-xl z-[9999]",children:[e.jsxs("button",{onClick:()=>{N(y),z(null)},className:"w-full text-left px-3 py-2.5 text-sm hover:bg-slate-700 flex items-center gap-2 text-white rounded-t-lg","aria-label":`Ch·ªânh s·ª≠a ${y.name}`,children:[e.jsx(Ar,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{children:"Ch·ªânh s·ª≠a"})]}),e.jsxs("button",{onClick:()=>{_r(y.id),z(null)},className:"w-full text-left px-3 py-2.5 text-sm hover:bg-slate-700 flex items-center gap-2 text-red-400 rounded-b-lg","aria-label":`X√≥a ${y.name}`,children:[e.jsx(Or,{className:"w-4 h-4"}),e.jsx("span",{children:"X√≥a"})]})]})]})]})]})},y.id)})})}),e.jsx("div",{className:"hidden sm:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-100 dark:bg-slate-700/50",children:e.jsxs("tr",{className:"border-b border-slate-200 dark:border-slate-600 text-[10px] font-semibold uppercase tracking-wider text-slate-600 dark:text-slate-300",children:[e.jsx("th",{className:"px-3 py-2.5 text-center w-10",children:e.jsx("input",{type:"checkbox",checked:w.length===J.length&&J.length>0,onChange:y=>Za(y.target.checked),className:"w-3.5 h-3.5 text-blue-600 rounded border-slate-300 dark:border-slate-600 focus:ring-blue-500"})}),e.jsx("th",{className:"px-3 py-2.5 text-left",children:"S·∫£n ph·∫©m"}),e.jsx("th",{className:"px-3 py-2.5 text-center",children:"T·ªìn kho"}),e.jsx("th",{className:"px-3 py-2.5 text-right",children:"Gi√° nh·∫≠p"}),e.jsx("th",{className:"px-3 py-2.5 text-right",children:"Gi√° b√°n l·∫ª"}),e.jsx("th",{className:"px-3 py-2.5 text-right",children:"Gi√° b√°n s·ªâ"}),e.jsx("th",{className:"px-3 py-2.5 text-right",children:"Gi√° tr·ªã t·ªìn"}),e.jsx("th",{className:"px-3 py-2.5 text-center w-14",children:"H√†nh ƒë·ªông"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-slate-800 divide-y divide-slate-100 dark:divide-slate-700",children:J.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:8,className:"px-4 py-6 text-center text-slate-400 dark:text-slate-500",children:[e.jsx("div",{className:"text-4xl mb-2",children:"üóÇÔ∏è"}),e.jsx("div",{className:"text-sm",children:"Kh√¥ng c√≥ s·∫£n ph·∫©m n√†o"}),e.jsx("div",{className:"text-xs",children:"H√£y th·ª≠ m·ªôt b·ªô l·ªçc kh√°c ho·∫∑c th√™m s·∫£n ph·∫©m m·ªõi"})]})}):J.map(y=>{var pe,Be,ze,Qe,Ye,Je;const I=d||"",U=((pe=y.stock)==null?void 0:pe[I])||0,X=((Be=y.retailPrice)==null?void 0:Be[I])||0,oe=((ze=y.wholesalePrice)==null?void 0:ze[I])||0,Ne=((Qe=y.costPrice)==null?void 0:Qe[I])||0,Le=U*X,Me=w.includes(y.id),$e=_(y.sku||""),Ie=U===0?"border-red-300 bg-red-50 text-red-700 dark:border-red-700 dark:bg-red-950/50 dark:text-red-300":U<=Ve?"border-amber-300 bg-amber-50 text-amber-700 dark:border-amber-600 dark:bg-amber-950/50 dark:text-amber-300":"border-emerald-300 bg-emerald-50 text-emerald-700 dark:border-emerald-600 dark:bg-emerald-950/50 dark:text-emerald-300",De=U===0?"H·∫øt h√†ng":U<=Ve?"S·∫Øp h·∫øt":"·ªîn ƒë·ªãnh",qe=U===0?"text-red-600 dark:text-red-400":U<=Ve?"text-amber-600 dark:text-amber-400":"text-emerald-700 dark:text-emerald-400",Ae=((Je=(Ye=y.name)==null?void 0:Ye.charAt(0))==null?void 0:Je.toUpperCase())||"?",re=Me?"bg-blue-900/20 dark:bg-blue-900/20":$e?"bg-orange-500/10 border-l-4 border-l-orange-500":"";return e.jsxs("tr",{className:`hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors ${re}`,children:[e.jsx("td",{className:"px-3 py-2 text-center",children:e.jsx("input",{type:"checkbox",checked:Me,onChange:je=>es(y.id,je.target.checked),className:"w-3.5 h-3.5 text-blue-600 rounded border-slate-300 dark:border-slate-600 focus:ring-blue-500"})}),e.jsx("td",{className:"px-3 py-2 min-w-[180px]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-9 w-9 rounded-lg overflow-hidden flex items-center justify-center text-sm font-semibold text-white flex-shrink-0",style:y.imageUrl?void 0:{backgroundColor:Q(y.category)},children:y.imageUrl?e.jsx("img",{src:y.imageUrl,alt:y.name,className:"h-full w-full object-cover"}):e.jsx("span",{children:Ae})}),e.jsxs("div",{className:"flex flex-col gap-0.5 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-semibold text-slate-900 dark:text-slate-100 truncate",children:[y.name,$e&&e.jsx("span",{className:"inline-flex items-center gap-0.5 rounded-full border border-orange-300 bg-orange-50 px-1.5 py-0 text-[9px] font-semibold text-orange-700 dark:bg-orange-900/30 flex-shrink-0",title:"S·∫£n ph·∫©m c√≥ m√£ tr√πng l·∫∑p",children:"‚ö†Ô∏è Tr√πng"})]}),e.jsx("div",{className:"text-[10px] text-slate-400 dark:text-slate-500 font-mono",children:y.barcode?e.jsxs("span",{className:"text-blue-600 dark:text-blue-400",children:["M√£: ",y.barcode]}):e.jsxs("span",{className:"text-blue-600 dark:text-blue-400",children:["SKU: ",y.sku||"N/A"]})}),y.category&&e.jsx("span",{className:`inline-flex items-center px-1.5 py-0 rounded-full text-[9px] font-medium ${we(y.category).bg} ${we(y.category).text}`,children:y.category})]})]})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsx("span",{className:`text-sm font-semibold ${qe}`,children:U.toLocaleString()}),e.jsxs("span",{className:`inline-flex items-center gap-0.5 rounded-full border px-1.5 py-0 text-[9px] font-semibold ${Ie}`,children:[e.jsx("span",{className:`h-1 w-1 rounded-full ${U===0?"bg-red-500":U<=Ve?"bg-amber-500":"bg-emerald-500"}`}),De]})]})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-right text-xs text-slate-600 dark:text-slate-300",children:W(Ne)}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-right text-xs font-medium text-slate-900 dark:text-slate-100",children:W(X)}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-right text-xs text-slate-600 dark:text-slate-300",children:W(oe)}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-right text-xs font-semibold text-slate-900 dark:text-slate-100",children:W(Le)}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:e.jsxs("div",{className:"relative flex justify-end",children:[e.jsx("button",{onClick:je=>{je.stopPropagation();const B=je.currentTarget.getBoundingClientRect();ee({top:B.bottom+4,right:window.innerWidth-B.right}),de(me=>me===y.id?null:y.id)},className:"rounded-full border border-transparent p-2 text-slate-600 dark:text-slate-300 hover:border-slate-300 dark:border-slate-600 hover:text-slate-900 dark:text-slate-100 transition","aria-haspopup":"menu","aria-expanded":he===y.id,title:"Thao t√°c nhanh",children:e.jsx(Tr,{className:"w-5 h-5"})}),he===y.id&&e.jsxs("div",{className:"fixed w-44 overflow-hidden rounded-xl border border-slate-200 dark:border-slate-700 bg-white shadow-xl dark:bg-slate-800 z-[9999]",style:{top:Y.top,right:Y.right},onClick:je=>je.stopPropagation(),children:[e.jsxs("button",{onClick:je=>{je.stopPropagation(),N(y),de(null)},className:"flex w-full items-center gap-2 px-4 py-2.5 text-left text-sm hover:bg-blue-50 dark:hover:bg-slate-700 rounded-t-xl",children:[e.jsx(Ar,{className:"h-4 w-4 text-blue-500"}),"Ch·ªânh s·ª≠a"]}),e.jsxs("button",{onClick:je=>{je.stopPropagation(),de(null),_r(y.id)},className:"flex w-full items-center gap-2 px-4 py-2.5 text-left text-sm text-red-500 hover:bg-red-50 dark:hover:bg-slate-700/70 rounded-b-xl",children:[e.jsx(Or,{className:"h-4 w-4"}),"X√≥a"]})]})]})})]},y.id)})})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 px-3 sm:px-6 py-3 sm:py-4 border-t border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsxs("div",{className:"text-xs sm:text-sm text-slate-600 dark:text-slate-300 text-center sm:text-left",children:[e.jsxs("span",{className:"font-medium",children:["Trang ",p,"/",Ge]}),e.jsx("span",{className:"mx-1",children:"‚Ä¢"}),e.jsxs("span",{children:[ye," ph·ª• t√πng"]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("button",{disabled:p===1||ce,onClick:()=>E(y=>Math.max(1,y-1)),className:"px-2.5 sm:px-3 py-1.5 text-xs sm:text-sm border border-slate-300 dark:border-slate-600 rounded disabled:opacity-40 hover:bg-slate-700/50 transition-colors",children:"‚Üê"}),e.jsx("span",{className:"px-2 py-1 text-xs sm:text-sm font-medium text-slate-300 min-w-[2rem] text-center",children:p}),e.jsx("button",{disabled:p>=Ge||ce,onClick:()=>E(y=>Math.min(Ge,y+1)),className:"px-2.5 sm:px-3 py-1.5 text-xs sm:text-sm border border-slate-300 dark:border-slate-600 rounded disabled:opacity-40 hover:bg-slate-700/50 transition-colors",children:"‚Üí"}),e.jsx("select",{value:M,onChange:y=>{const I=Number(y.target.value)||20;H(I),E(1)},className:"px-1.5 sm:px-2 py-1.5 text-xs sm:text-sm border border-slate-300 dark:border-slate-600 rounded bg-slate-800 text-slate-200",children:[10,20,50,100].map(y=>e.jsx("option",{value:y,children:y},y))})]})]})]})]}),c==="history"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden sm:block",children:e.jsx(On,{transactions:f})}),e.jsx("div",{className:"sm:hidden",children:e.jsx(Rs,{transactions:f})})]}),c==="categories"&&e.jsx("div",{className:"bg-[#0f172a] -m-3 sm:-m-6",children:e.jsx(fs,{})}),c==="lookup"&&e.jsxs("div",{className:"bg-[#0f172a] -m-3 sm:-m-6",children:[e.jsx("div",{className:"hidden sm:block",children:e.jsx(gs,{})}),e.jsx("div",{className:"sm:hidden",children:e.jsx(Ps,{})})]})]}),e.jsx("div",{className:"hidden sm:block",children:e.jsx(Sn,{isOpen:l,onClose:()=>t(!1),parts:T||[],currentBranchId:d,onSave:Nr})}),e.jsx(_n,{isOpen:l,onClose:()=>t(!1),parts:T||[],currentBranchId:d,onSave:Nr}),O&&e.jsx(Nn,{parts:T||[],currentBranchId:d,onClose:()=>D(!1)}),S&&e.jsx(Tn,{part:S,onClose:()=>N(null),onSave:y=>{console.log("üíæ Saving part updates:",y);const I={name:y.name,barcode:y.barcode,category:y.category,stock:y.stock,retailPrice:y.retailPrice,wholesalePrice:y.wholesalePrice};y.costPrice&&(I.costPrice=y.costPrice),console.log("üì§ Sending updates:",I),ge.mutate({id:y.id,updates:I}),N(null)},currentBranchId:d}),A&&e.jsx(Mn,{onClose:()=>L(!1),onDownloadTemplate:Cr,onImport:async y=>{var I,U;try{const{items:X,errors:oe}=await Es(y,d);if(X.length===0){const B=oe.length?`Kh√¥ng import ƒë∆∞·ª£c: ${oe.slice(0,3).join("; ")}`:"File kh√¥ng c√≥ d·ªØ li·ªáu h·ª£p l·ªá";throw new Error(B)}const Ne=X.map(B=>B.sku);console.log(`üîç Checking ${Ne.length} SKUs...`);const Le=new Map;Ne.forEach(B=>{Le.set(B,(Le.get(B)||0)+1)});const Me=Array.from(Le.entries()).filter(([B,me])=>me>1).map(([B,me])=>`${B}(${me}x)`);Me.length>0&&console.warn(`‚ö†Ô∏è Duplicate SKUs in file: ${Me.slice(0,5).join(", ")}`);const $e=Array.from(new Set(Ne)),Ie=100,De=[];for(let B=0;B<$e.length;B+=Ie){const me=$e.slice(B,B+Ie),{data:Pe,error:Ze}=await xe.from("parts").select("*").in("sku",me);if(Ze)throw console.error(`‚ùå Fetch chunk ${B/Ie+1} error:`,Ze),new Error(`L·ªói ki·ªÉm tra ph·ª• t√πng: ${Ze.message}`);Pe&&De.push(...Pe)}console.log(`‚úÖ Found ${De.length} existing parts`);const qe=new Map(De.map(B=>[B.sku,B])),Ae=[],re=[],pe=[],Be=new Set;let ze=0,Qe=0,Ye=0;const Je=new Date().toISOString();for(const B of X){if(Be.has(B.sku)){console.warn(`‚ö†Ô∏è Skipping duplicate SKU in file: ${B.sku}`),Ye++;continue}Be.add(B.sku);const me=qe.get(B.sku);if(me)Qe+=1,re.push({id:me.id,stock:{...me.stock,[d]:(me.stock[d]||0)+B.quantity},costPrice:{...me.costPrice,[d]:B.costPrice},retailPrice:{...me.retailPrice,[d]:B.retailPrice},wholesalePrice:{...me.wholesalePrice,[d]:B.wholesalePrice}}),pe.push({type:"Nh·∫≠p kho",date:Je,branchId:d,partId:me.id,partName:B.name,quantity:B.quantity,unitPrice:B.retailPrice,totalPrice:B.quantity*B.retailPrice,notes:"Nh·∫≠p kho t·ª´ file Excel"});else{ze+=1;const Pe=((I=crypto==null?void 0:crypto.randomUUID)==null?void 0:I.call(crypto))||`${Math.random().toString(36).slice(2)}-${Date.now()}`;Ae.push({id:Pe,name:B.name,sku:B.sku,category:B.category,description:B.description,stock:{[d]:B.quantity},costPrice:{[d]:B.costPrice},retailPrice:{[d]:B.retailPrice},wholesalePrice:{[d]:B.wholesalePrice}}),pe.push({type:"Nh·∫≠p kho",date:Je,branchId:d,partId:Pe,partName:B.name,quantity:B.quantity,unitPrice:B.retailPrice,totalPrice:B.quantity*B.retailPrice,notes:"Nh·∫≠p kho t·ª´ file Excel"})}}if(Ae.length>0){const{data:B,error:me}=await xe.from("parts").insert(Ae).select();if(me)throw console.error("‚ùå Batch create error:",me),new Error(`L·ªói t·∫°o ph·ª• t√πng: ${me.message}`);console.log(`‚úÖ Created ${(B==null?void 0:B.length)||0} parts`)}if(re.length>0){let B=0,me=0;for(const Pe of re){const{error:Ze}=await xe.from("parts").update({stock:Pe.stock,costPrice:Pe.costPrice,retailPrice:Pe.retailPrice,wholesalePrice:Pe.wholesalePrice}).eq("id",Pe.id);Ze?(console.error(`‚ùå Update error for part ${Pe.id}:`,Ze),me++):B++}console.log(`‚úÖ Updated ${B}/${re.length} parts`)}if(pe.length>0){const{error:B}=await xe.from("inventory_transactions").insert(pe);B&&console.warn("‚ö†Ô∏è Inventory transactions error:",B)}ne.invalidateQueries({queryKey:["partsRepo"]}),ne.invalidateQueries({queryKey:["partsRepoPaged"]});try{const{data:B}=await xe.auth.getUser();await br(((U=B==null?void 0:B.user)==null?void 0:U.id)||null,{action:"inventory.import",tableName:"inventory_transactions",oldData:null,newData:{totalRows:X.length+oe.length,created:ze,updated:Qe,skipped:oe.length,sampleErrors:oe.slice(0,10),branchId:d,at:Je}})}catch{}L(!1);let je=`Import: t·∫°o m·ªõi ${ze}, c·∫≠p nh·∫≠t ${Qe}`;Ye>0&&(je+=`, b·ªè qua ${Ye} SKU tr√πng`),oe.length>0&&(je+=`, ${oe.length} d√≤ng l·ªói`),q.success(je)}catch(X){console.error("‚ùå Import error:",X),q.error(`L·ªói import: ${X}`)}}}),e.jsx(bs,{isOpen:P.isOpen,title:P.title,message:P.message,confirmText:P.confirmText,cancelText:P.cancelText,confirmColor:P.confirmColor,onConfirm:v,onCancel:$}),e.jsxs("div",{className:"sm:hidden fixed bottom-20 right-4 z-40 flex flex-col gap-3",children:[e.jsx("button",{onClick:()=>t(!0),className:"w-14 h-14 bg-gradient-to-br from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white rounded-full shadow-lg shadow-green-500/30 flex items-center justify-center transition-all transform hover:scale-110 active:scale-95","aria-label":"T·∫°o phi·∫øu nh·∫≠p",children:e.jsx(ar,{className:"w-5 h-5"})}),e.jsx("button",{onClick:Sr,className:"w-14 h-14 bg-gradient-to-br from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white rounded-full shadow-lg shadow-orange-500/30 flex items-center justify-center transition-all transform hover:scale-110 active:scale-95","aria-label":"Xu·∫•t Excel",children:e.jsx(Lr,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"sm:hidden fixed bottom-0 left-0 right-0 bg-white dark:bg-slate-800 border-t border-slate-200 dark:border-slate-700 z-50 safe-area-bottom",children:[e.jsx("div",{className:"absolute inset-0 bg-white/80 dark:bg-slate-800/80 backdrop-blur-lg -z-10"}),e.jsxs("div",{className:"grid grid-cols-4 gap-1 px-2 py-2",children:[e.jsxs("button",{onClick:()=>h("stock"),className:`flex flex-col items-center gap-1 px-2 py-2 rounded-xl transition-all duration-200 ${c==="stock"?"bg-amber-100 dark:bg-amber-900/40 text-amber-600 dark:text-amber-400 scale-105":"text-slate-500 dark:text-slate-400 active:scale-95"}`,children:[e.jsx(cr,{className:`w-5 h-5 ${c==="stock"?"scale-110":""} transition-transform`}),e.jsx("span",{className:`text-[10px] font-medium ${c==="stock"?"font-semibold":""}`,children:"T·ªìn kho"})]}),e.jsxs("button",{onClick:()=>h("categories"),className:`flex flex-col items-center gap-1 px-2 py-2 rounded-xl transition-all duration-200 ${c==="categories"?"bg-purple-100 dark:bg-purple-900/40 text-purple-600 dark:text-purple-400 scale-105":"text-slate-500 dark:text-slate-400 active:scale-95"}`,children:[e.jsx(rr,{className:`w-5 h-5 ${c==="categories"?"scale-110":""} transition-transform`}),e.jsx("span",{className:`text-[10px] font-medium ${c==="categories"?"font-semibold":""}`,children:"Danh m·ª•c"})]}),e.jsxs("button",{onClick:()=>h("lookup"),className:`flex flex-col items-center gap-1 px-2 py-2 rounded-xl transition-all duration-200 ${c==="lookup"?"bg-blue-100 dark:bg-blue-900/40 text-blue-600 dark:text-blue-400 scale-105":"text-slate-500 dark:text-slate-400 active:scale-95"}`,children:[e.jsx(ut,{className:`w-5 h-5 ${c==="lookup"?"scale-110":""} transition-transform`}),e.jsx("span",{className:`text-[10px] font-medium ${c==="lookup"?"font-semibold":""}`,children:"Tra c·ª©u"})]}),e.jsxs("button",{onClick:()=>h("history"),className:`flex flex-col items-center gap-1 px-2 py-2 rounded-xl transition-all duration-200 ${c==="history"?"bg-green-100 dark:bg-green-900/40 text-green-600 dark:text-green-400 scale-105":"text-slate-500 dark:text-slate-400 active:scale-95"}`,children:[e.jsx(ur,{className:`w-5 h-5 ${c==="history"?"scale-110":""} transition-transform`}),e.jsx("span",{className:`text-[10px] font-medium ${c==="history"?"font-semibold":""}`,children:"L·ªãch s·ª≠"})]})]})]})]})},Mn=({onClose:d,onDownloadTemplate:m,onImport:b})=>{const[i,x]=k.useState(null),[f,c]=k.useState(!1),h=t=>{var s,a;const r=(s=t.target.files)==null?void 0:s[0];if(r){const n=(a=r.name.split(".").pop())==null?void 0:a.toLowerCase();n==="xlsx"||n==="xls"||n==="csv"?x(r):q.warning("Vui l√≤ng ch·ªçn file Excel (.xlsx, .xls) ho·∫∑c CSV (.csv)")}},l=async()=>{if(!i){q.warning("Vui l√≤ng ch·ªçn file ƒë·ªÉ import");return}c(!0);try{await b(i)}finally{c(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-2xl w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-slate-100",children:"Nh·∫≠p t·ªìn kho t·ª´ Excel/CSV"}),e.jsx("button",{onClick:d,disabled:f,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 disabled:opacity-50",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-6 h-6 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:"H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng"}),e.jsxs("ol",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"T·∫£i file template m·∫´u"}),e.jsx("li",{children:"ƒêi·ªÅn th√¥ng tin s·∫£n ph·∫©m v√†o file"}),e.jsx("li",{children:"L∆∞u file v√† ch·ªçn ƒë·ªÉ import"})]}),e.jsx("button",{onClick:m,className:"mt-3 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors",children:"üì• T·∫£i Template Excel"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Ch·ªçn file ƒë·ªÉ import"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-lg p-6 text-center",children:[e.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:h,disabled:f,className:"hidden",id:"file-upload"}),e.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer inline-flex flex-col items-center",children:[e.jsx("svg",{className:"w-12 h-12 text-slate-400 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Click ƒë·ªÉ ch·ªçn file Excel ho·∫∑c CSV"}),i&&e.jsxs("span",{className:"mt-2 text-sm font-medium text-blue-600 dark:text-blue-400",children:["‚úì ",i.name]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:d,disabled:f,className:"px-4 py-2 border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors disabled:opacity-50",children:"H·ªßy"}),e.jsx("button",{onClick:l,disabled:!i||f,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:f?"ƒêang x·ª≠ l√Ω...":"Import"})]})]})]})})},Tn=({part:d,onClose:m,onSave:b,currentBranchId:i})=>{var u,g;const[x,f]=k.useState({name:d.name,barcode:d.barcode||"",category:d.category||"",retailPrice:d.retailPrice[i]||0,wholesalePrice:((u=d.wholesalePrice)==null?void 0:u[i])||0,costPrice:((g=d.costPrice)==null?void 0:g[i])||0,stock:d.stock[i]||0}),[c,h]=k.useState(!1),{data:l=[]}=jr(),t=qa(),[r,s]=k.useState(!1),[a,n]=k.useState(""),o=j=>{if(j.preventDefault(),!x.name.trim()){q.warning("Vui l√≤ng nh·∫≠p t√™n s·∫£n ph·∫©m");return}b({id:d.id,name:x.name.trim(),barcode:x.barcode.trim()||void 0,category:x.category.trim()||void 0,stock:{...d.stock,[i]:x.stock},costPrice:{...d.costPrice,[i]:x.costPrice},retailPrice:{...d.retailPrice,[i]:x.retailPrice},wholesalePrice:{...d.wholesalePrice,[i]:x.wholesalePrice}})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-slate-100",children:"Ch·ªânh s·ª≠a s·∫£n ph·∫©m"}),e.jsx("button",{onClick:m,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:o,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:["T√™n s·∫£n ph·∫©m ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:x.name,onChange:j=>f({...x,name:j.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"M√£ s·∫£n ph·∫©m"}),e.jsx("input",{type:"text",value:x.barcode,onChange:j=>f({...x,barcode:j.target.value}),placeholder:"VD: 06455-KYJ-841 (Honda), 5S9-F2101-00 (Yamaha)",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 font-mono"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:"Nh·∫≠p m√£ h√£ng (Honda/Yamaha) ho·∫∑c ƒë·ªÉ tr·ªëng ƒë·ªÉ t·ª± sinh m√£ n·ªôi b·ªô PT-xxxxx"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Danh m·ª•c"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:x.category,onChange:j=>f({...x,category:j.target.value}),className:"flex-1 px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",children:[e.jsx("option",{value:"",children:"-- Ch·ªçn ho·∫∑c t·∫°o m·ªõi --"}),l.map(j=>e.jsx("option",{value:j.name,children:j.name},j.id))]}),e.jsx("button",{type:"button",onClick:()=>s(!0),className:"px-3 py-2 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-600",title:"Th√™m danh m·ª•c m·ªõi",children:"+"})]}),r&&e.jsxs("form",{onSubmit:async j=>{j.preventDefault();const p=a.trim();if(!p)return q.warning("Vui l√≤ng nh·∫≠p t√™n danh m·ª•c");try{const E=await t.mutateAsync({name:p});f({...x,category:E.name}),n(""),s(!1)}catch(E){q.error((E==null?void 0:E.message)||"L·ªói t·∫°o danh m·ª•c")}},className:"flex gap-2",children:[e.jsx("input",{autoFocus:!0,type:"text",value:a,onChange:j=>n(j.target.value),placeholder:"Nh·∫≠p t√™n danh m·ª•c m·ªõi",className:"flex-1 px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-sm text-slate-900 dark:text-slate-100"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium",children:"L∆∞u"}),e.jsx("button",{type:"button",onClick:()=>{s(!1),n("")},className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-sm bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-600",children:"H·ªßy"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Gi√° nh·∫≠p"}),e.jsx("input",{type:"number",value:x.costPrice||0,onChange:j=>f({...x,costPrice:Number(j.target.value)}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Gi√° b√°n l·∫ª"}),e.jsx("input",{type:"number",value:x.retailPrice,onChange:j=>f({...x,retailPrice:Number(j.target.value)}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Gi√° b√°n s·ªâ"}),e.jsx("input",{type:"number",value:x.wholesalePrice,onChange:j=>f({...x,wholesalePrice:Number(j.target.value)}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",min:"0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"T·ªìn kho hi·ªán t·∫°i"}),e.jsx("input",{type:"number",value:x.stock,onChange:j=>f({...x,stock:Number(j.target.value)}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",min:"0"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:"S·ªë l∆∞·ª£ng t·ªìn kho t·∫°i chi nh√°nh hi·ªán t·∫°i"})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:e.jsxs("div",{className:"text-sm text-blue-800 dark:text-blue-300",children:[e.jsx("div",{className:"font-medium mb-1",children:"L∆∞u √Ω:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"B·∫°n c√≥ th·ªÉ ch·ªânh s·ª≠a tr·ª±c ti·∫øp gi√° nh·∫≠p, gi√° b√°n v√† t·ªìn kho"}),e.jsx("li",{children:'Ho·∫∑c s·ª≠ d·ª•ng "T·∫°o phi·∫øu nh·∫≠p" ƒë·ªÉ ghi nh·∫≠n l·ªãch s·ª≠ nh·∫≠p kho chi ti·∫øt'})]})]})}),e.jsxs("div",{className:"flex justify-between gap-3 pt-4",children:[e.jsxs("button",{type:"button",onClick:()=>h(!0),className:"px-4 py-2 border border-blue-300 dark:border-blue-600 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"In m√£ v·∫°ch"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:m,className:"px-4 py-2 border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:"H·ªßy"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"L∆∞u thay ƒë·ªïi"})]})]})]}),c&&e.jsx(jn,{part:d,currentBranchId:i,onClose:()=>h(!1)})]})})};export{Nn as BatchPrintBarcodeModal,Wn as default};
