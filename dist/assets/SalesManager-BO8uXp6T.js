const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-9wxNecOd.js","assets/index-BRh9IY0m.css"])))=>i.map(i=>d[i]);
import{c as ct,r,u as Kt,a as Wt,b as js,d as vs,e as Ot,f as ys,g as ws,s as u,h as St,j as e,B as wt,S as Nt,i as m,k as Rt,l as ot,R as Vt,m as Ee,n as $t,_ as it,o as Ft}from"./index-9wxNecOd.js";import{c as Ct}from"./permissions-BO4i-gjC.js";import{p as Ht}from"./print-TOU0k1YY.js";import{P as Gt,X as Ut}from"./Icons-Dya5WI08.js";import{u as Ns,a as Cs}from"./useDebtsRepository-Dok2KRq3.js";import{B as Ss}from"./BarcodeScannerModal-HI1_VeOw.js";import{H as Et}from"./history-D1Kthsdy.js";import{P as Ts}from"./plus-DCVw7leC.js";import{S as Ms}from"./share-2-D3zDEdhk.js";import{P as Ls}from"./printer-CZA7AzvW.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=ct("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=ct("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=ct("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=ct("ScanLine",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);function Is(Z,h,o=5){return r.useMemo(()=>{const W=Array.isArray(Z)?Z:[],G=h||"",k=W.filter(U=>{var oe;return(((oe=U.stock)==null?void 0:oe[G])??0)<=0}),D=W.filter(U=>{var L;const oe=((L=U.stock)==null?void 0:L[G])??0;return oe>0&&oe<=o});return{lowStock:D,outOfStock:k,lowStockCount:D.length,outOfStockCount:k.length}},[Z,h,o])}const dt=5,_s=({isOpen:Z,onClose:h,sale:o,onPrint:W})=>{if(!Z||!o)return null;const G=o.items.reduce((D,U)=>D+U.quantity*U.sellingPrice,0),k=G-o.total;return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"Chi ti·∫øt ƒë∆°n h√†ng"}),e.jsx("button",{onClick:h,className:"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 text-2xl",children:"√ó"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-slate-400",children:"M√£ ƒë∆°n h√†ng"}),e.jsx("div",{className:"text-base font-semibold text-slate-900 dark:text-slate-100",children:o.sale_code||Ee(o.id)||o.id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Ng√†y t·∫°o"}),e.jsxs("div",{className:"text-base font-semibold text-slate-900 dark:text-slate-100",children:[ot(new Date(o.date),!1)," ",new Date(o.date).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Kh√°ch h√†ng"}),e.jsx("div",{className:"text-base font-semibold text-slate-900 dark:text-slate-100",children:o.customer.name}),o.customer.phone&&e.jsx("div",{className:"text-sm text-slate-500",children:o.customer.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Nh√¢n vi√™n b√°n h√†ng"}),e.jsx("div",{className:"text-base font-semibold text-slate-900 dark:text-slate-100",children:o.username||o.userName||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Ph∆∞∆°ng th·ª©c thanh to√°n"}),e.jsx("div",{className:"text-base font-semibold text-slate-900 dark:text-slate-100",children:o.paymentMethod==="cash"?"Ti·ªÅn m·∫∑t":"Chuy·ªÉn kho·∫£n"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-3",children:"S·∫£n ph·∫©m"}),e.jsx("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-xs font-medium text-slate-500 dark:text-slate-400 uppercase",children:"T√™n s·∫£n ph·∫©m"}),e.jsx("th",{className:"text-right px-4 py-3 text-xs font-medium text-slate-500 dark:text-slate-400 uppercase",children:"SL"}),e.jsx("th",{className:"text-right px-4 py-3 text-xs font-medium text-slate-500 dark:text-slate-400 uppercase",children:"ƒê∆°n gi√°"}),e.jsx("th",{className:"text-right px-4 py-3 text-xs font-medium text-slate-500 dark:text-slate-400 uppercase",children:"Th√†nh ti·ªÅn"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700",children:o.items.map((D,U)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-4 py-3 text-sm text-slate-900 dark:text-slate-100",children:[D.partName,D.sku&&e.jsxs("div",{className:"text-xs text-slate-500",children:["SKU: ",D.sku]})]}),e.jsx("td",{className:"px-4 py-3 text-sm text-right text-slate-900 dark:text-slate-100",children:D.quantity}),e.jsx("td",{className:"px-4 py-3 text-sm text-right text-slate-900 dark:text-slate-100",children:m(D.sellingPrice)}),e.jsx("td",{className:"px-4 py-3 text-sm text-right font-semibold text-slate-900 dark:text-slate-100",children:m(D.quantity*D.sellingPrice)})]},U))})]})})]}),e.jsx("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"T·∫°m t√≠nh:"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-slate-100",children:m(G)})]}),k>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Gi·∫£m gi√°:"}),e.jsxs("span",{className:"font-semibold text-red-600 dark:text-red-400",children:["-",m(k)]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold border-t border-slate-200 dark:border-slate-700 pt-2",children:[e.jsx("span",{className:"text-slate-900 dark:text-slate-100",children:"T·ªïng c·ªông:"}),e.jsx("span",{className:"text-green-600 dark:text-green-400",children:m(o.total)})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 p-6 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("button",{onClick:h,className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:"ƒê√≥ng"}),e.jsxs("button",{onClick:()=>{W(o),h()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"In h√≥a ƒë∆°n"]})]})]})})},Bs=({isOpen:Z,onClose:h,sale:o,onSave:W})=>{const{customers:G,upsertCustomer:k}=Kt(),{data:D=[]}=Ot(),U=Wt(),{profile:oe}=St(),[L,A]=r.useState([]),[Qe,Ne]=r.useState({id:"",name:"",phone:""}),[Q,pe]=r.useState("cash"),[Ce,Xe]=r.useState(0),[fe,R]=r.useState(""),[ke,Se]=r.useState(!1),[Te,Me]=r.useState(!1),[Le,Pe]=r.useState(""),[De,je]=r.useState(""),[X,J]=r.useState(""),[ae,V]=r.useState(!1);if(r.useEffect(()=>{o&&(A([...o.items]),Ne({id:o.customer.id||"",name:o.customer.name,phone:o.customer.phone||""}),J(o.customer.name),pe(o.paymentMethod),Xe(o.discount||0))},[o]),!Z||!o)return null;const ie=L.reduce((l,f)=>l+f.quantity*f.sellingPrice,0),te=ie-Ce,_=D.filter(l=>l.name.toLowerCase().includes(fe.toLowerCase())||l.sku.toLowerCase().includes(fe.toLowerCase())),re=G.filter(l=>{var w;const f=X.toLowerCase();return l.name.toLowerCase().includes(f)||((w=l.phone)==null?void 0:w.toLowerCase().includes(f))||l.vehicles&&l.vehicles.some(ve=>{var B;return(B=ve.licensePlate)==null?void 0:B.toLowerCase().includes(f)})}),se=l=>{const f=typeof l.stock=="object"?l.stock[o.branchId]||0:l.stock,w=typeof l.retailPrice=="object"?l.retailPrice[o.branchId]||0:l.retailPrice||0,ve=L.find(B=>B.partId===l.id);A(ve?L.map(B=>B.partId===l.id?{...B,quantity:B.quantity+1}:B):[...L,{partId:l.id,partName:l.name,sku:l.sku,quantity:1,sellingPrice:w,stockSnapshot:typeof f=="number"?f:0}]),R(""),Se(!1)},Y=l=>{Ne({id:l.id,name:l.name,phone:l.phone||""}),J(l.name),V(!1)},ee=async()=>{if(!Le.trim()){u.error("Vui l√≤ng nh·∫≠p t√™n kh√°ch h√†ng");return}try{const l={id:crypto.randomUUID(),name:Le,phone:De||void 0,email:"",created_at:new Date().toISOString()};await k(l),Ne({id:l.id,name:l.name,phone:l.phone||""}),J(l.name),Me(!1),Pe(""),je(""),u.success("Th√™m kh√°ch h√†ng th√†nh c√¥ng")}catch(l){console.error("Error adding customer:",l),u.error("L·ªói khi th√™m kh√°ch h√†ng")}},C=(l,f)=>{f<=0?A(L.filter(w=>w.partId!==l)):A(L.map(w=>w.partId===l?{...w,quantity:f}:w))},ze=(l,f)=>{A(L.map(w=>w.partId===l?{...w,sellingPrice:f}:w))},Ye=l=>{A(L.filter(f=>f.partId!==l))},le=async()=>{if(L.length===0){u.error("Vui l√≤ng c√≥ √≠t nh·∫•t m·ªôt s·∫£n ph·∫©m");return}if(!Qe.name){u.error("Vui l√≤ng nh·∫≠p t√™n kh√°ch h√†ng");return}try{await W({id:o.id,items:L,customer:Qe,paymentMethod:Q,discount:Ce}),U.invalidateQueries({queryKey:["salesRepoPaged"]}),h()}catch(l){console.error("Error saving sale:",l)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg w-full max-w-2xl max-h-[95vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("h2",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:["‚úèÔ∏è [Ch·ªânh s·ª≠a] ƒê∆°n Xu·∫•t B√°n ",o.sale_code||Ee(o.id)]}),e.jsx("button",{onClick:h,className:"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 text-2xl leading-none",children:"√ó"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Th·ªùi gian b√°n h√†ng:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:ot(new Date(o.date),!1),disabled:!0,className:"flex-1 px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-slate-50 dark:bg-slate-700 text-slate-900 dark:text-slate-100"}),e.jsx("input",{type:"text",value:new Date(o.date).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}),disabled:!0,className:"w-24 px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-slate-50 dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-center"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Kh√°ch h√†ng: ‚ÑπÔ∏è"}),Te?e.jsxs("div",{className:"border border-slate-300 dark:border-slate-600 rounded-lg p-3 space-y-2",children:[e.jsx("input",{type:"text",value:Le,onChange:l=>Pe(l.target.value),placeholder:"T√™n kh√°ch h√†ng",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"}),e.jsx("input",{type:"tel",value:De,onChange:l=>je(l.target.value),placeholder:"S·ªë ƒëi·ªán tho·∫°i (t√πy ch·ªçn)",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:ee,className:"flex-1 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"L∆∞u"}),e.jsx("button",{onClick:()=>{Me(!1),Pe(""),je("")},className:"px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-300",children:"H·ªßy"})]})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:X,onChange:l=>{J(l.target.value),V(!0)},onFocus:()=>V(!0),placeholder:"T√¨m ki·∫øm v√† ch·ªçn m·ªôt kh√°ch h√†ng",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"}),ae&&re.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg shadow-lg max-h-48 overflow-y-auto z-10",children:re.slice(0,10).map(l=>e.jsxs("button",{onClick:()=>Y(l),className:"w-full px-3 py-2 text-left hover:bg-slate-100 dark:hover:bg-slate-600 text-sm",children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-slate-100",children:l.name}),l.phone&&e.jsx("div",{className:"text-xs text-slate-500",children:l.phone})]},l.id))})]}),e.jsxs("button",{onClick:()=>Me(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[e.jsx(Gt,{className:"w-4 h-4"}),"Th√™m m·ªõi"]})]})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Chi ti·∫øt s·∫£n ph·∫©m:"})}),e.jsxs("div",{className:"relative mb-3",children:[e.jsx("input",{type:"text",value:fe,onChange:l=>{R(l.target.value),Se(!0)},onFocus:()=>Se(!0),placeholder:"T√¨m ki·∫øm v√† th√™m s·∫£n ph·∫©m...",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"}),ke&&fe&&_.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg shadow-lg max-h-60 overflow-y-auto z-10",children:_.slice(0,10).map(l=>e.jsxs("button",{onClick:()=>se(l),className:"w-full px-3 py-2 text-left hover:bg-slate-100 dark:hover:bg-slate-600 text-sm",children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-slate-100",children:l.name}),e.jsxs("div",{className:"text-xs text-slate-500",children:["SKU: ",l.sku]})]},l.id))})]}),e.jsx("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center px-2 py-2 text-xs font-medium text-slate-500 dark:text-slate-400 w-8",children:"-"}),e.jsx("th",{className:"text-left px-3 py-2 text-xs font-medium text-slate-500 dark:text-slate-400",children:"T√™n"}),e.jsx("th",{className:"text-center px-3 py-2 text-xs font-medium text-slate-500 dark:text-slate-400 w-20",children:"SL"}),e.jsx("th",{className:"text-right px-3 py-2 text-xs font-medium text-slate-500 dark:text-slate-400 w-24",children:"ƒê∆°n gi√°"}),e.jsx("th",{className:"text-right px-3 py-2 text-xs font-medium text-slate-500 dark:text-slate-400 w-28",children:"Th√†nh ti·ªÅn"}),e.jsx("th",{className:"w-10"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700",children:L.map((l,f)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 text-center text-sm text-slate-900 dark:text-slate-100",children:f+1}),e.jsxs("td",{className:"px-3 py-2 text-sm",children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-slate-100",children:l.partName}),e.jsx("div",{className:"text-xs text-slate-500",children:l.sku})]}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("input",{type:"number",value:l.quantity,onChange:w=>C(l.partId,parseInt(w.target.value)||0),min:"1",className:"w-full px-2 py-1 border border-slate-300 dark:border-slate-600 rounded text-center text-sm bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("input",{type:"number",value:l.sellingPrice,onChange:w=>ze(l.partId,parseFloat(w.target.value)||0),min:"0",step:"1000",className:"w-full px-2 py-1 border border-slate-300 dark:border-slate-600 rounded text-right text-sm bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"})}),e.jsx("td",{className:"px-3 py-2 text-right text-sm font-semibold text-slate-900 dark:text-slate-100",children:m(l.quantity*l.sellingPrice)}),e.jsx("td",{className:"px-2 py-2 text-center",children:e.jsx("button",{onClick:()=>Ye(l.partId),className:"text-slate-400 hover:text-red-600 transition-colors",children:e.jsx(Ut,{className:"w-5 h-5"})})})]},l.partId))})]})}),L.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Ch∆∞a c√≥ s·∫£n ph·∫©m n√†o"}),L.length>0&&e.jsxs("div",{className:"mt-2 text-right",children:[e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"T·ªîNG:"}),e.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:m(ie)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Ch·ªçn nh√¢n vi√™n b√°n h√†ng"}),e.jsx("select",{disabled:!0,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-slate-50 dark:bg-slate-700 text-slate-900 dark:text-slate-100",children:e.jsx("option",{children:o.username||o.userName})})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"C√¥ng n·ª£:"}),e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-400 mb-3",children:"Kh√°ch h√†ng ph·∫£i thanh to√°n"}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3 mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-green-700 dark:text-green-400",children:"T·ªîNG PH·∫¢I THU:"}),e.jsx("span",{className:"text-lg font-bold text-green-700 dark:text-green-400",children:m(te)})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-green-600 dark:text-green-400",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"ƒê√£ thanh to√°n ƒë·ªß"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-2",children:"- Th·ªùi gian Ng∆∞·ªùi thu - Ghi ch√∫"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>pe("cash"),className:`flex-1 py-2 rounded-lg border transition-colors text-sm font-medium ${Q==="cash"?"bg-green-600 text-white border-green-600":"border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700"}`,children:"Ti·ªÅn m·∫∑t"}),e.jsx("button",{onClick:()=>pe("bank"),className:`flex-1 py-2 rounded-lg border transition-colors text-sm font-medium ${Q==="bank"?"bg-blue-600 text-white border-blue-600":"border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700"}`,children:"Chuy·ªÉn kho·∫£n"})]})]}),e.jsx("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center px-2 py-2 text-xs font-medium text-slate-500 dark:text-slate-400",children:"-"}),e.jsx("th",{className:"text-left px-3 py-2 text-xs font-medium text-slate-500 dark:text-slate-400",children:"Th·ªùi gian"}),e.jsx("th",{className:"text-left px-3 py-2 text-xs font-medium text-slate-500 dark:text-slate-400",children:"Ng∆∞·ªùi thu - Ghi ch√∫"}),e.jsx("th",{className:"text-right px-3 py-2 text-xs font-medium text-slate-500 dark:text-slate-400",children:"S·ªë ti·ªÅn"}),e.jsx("th",{className:"w-10"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-slate-800",children:e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 text-center text-slate-900 dark:text-slate-100",children:"1"}),e.jsxs("td",{className:"px-3 py-2",children:[e.jsxs("div",{className:"text-slate-900 dark:text-slate-100",children:[new Date(o.date).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})," ",ot(new Date(o.date),!1)]}),e.jsx("div",{className:"text-xs text-slate-500",children:"(Ti·ªÅn m·∫∑t)"})]}),e.jsx("td",{className:"px-3 py-2 text-slate-900 dark:text-slate-100",children:o.username||o.userName}),e.jsx("td",{className:"px-3 py-2 text-right text-slate-900 dark:text-slate-100",children:m(te)}),e.jsx("td",{})]})})]})}),e.jsxs("div",{className:"mt-2 text-right",children:[e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"T·ªïng ƒë√£ thu"}),e.jsx("div",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:m(te)})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-700",children:[e.jsx("button",{onClick:h,className:"px-6 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-600 transition-colors font-medium",children:"ƒê√ìNG"}),e.jsx("button",{onClick:le,disabled:L.length===0,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-semibold",children:"L∆ØU"})]})]})})},As=({isOpen:Z,onClose:h,sales:o,currentBranchId:W,onPrintReceipt:G,onEditSale:k,onDeleteSale:D,page:U,totalPages:oe,total:L,hasMore:A,pageSize:Qe,onPrevPage:Ne,onNextPage:Q,onPageSizeChange:pe,search:Ce,onSearchChange:Xe,fromDate:fe,toDate:R,onDateRangeChange:ke,status:Se="all",onStatusChange:Te,paymentMethodFilter:Me="all",onPaymentMethodFilterChange:Le,keysetMode:Pe=!1,onToggleKeyset:De,customerDebts:je=[]})=>{const{profile:X}=St(),[J,ae]=r.useState("7days"),[V,ie]=r.useState(""),[te,_]=r.useState(""),[re,se]=r.useState(""),[Y,ee]=r.useState(null),[C,ze]=r.useState(!1),[Ye,le]=r.useState(!1),[l,f]=r.useState(null),[w,ve]=r.useState({top:0,right:0});r.useEffect(()=>{const a=new Date,b=new Date(a.getFullYear(),a.getMonth(),a.getDate()),S=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59,999);let O,M;switch(J){case"today":O=b,M=S;break;case"week":{const j=a.getDay(),$=j===0?-6:1-j,q=new Date(a);q.setDate(a.getDate()+$),O=new Date(q.getFullYear(),q.getMonth(),q.getDate()),M=S;break}case"month":{O=new Date(a.getFullYear(),a.getMonth(),1),M=S;break}case"7days":{const j=new Date(a);j.setDate(j.getDate()-6),O=new Date(j.getFullYear(),j.getMonth(),j.getDate()),M=S;break}case"30days":{const j=new Date(a);j.setDate(j.getDate()-29),O=new Date(j.getFullYear(),j.getMonth(),j.getDate()),M=S;break}case"custom":{te&&re&&(O=new Date(te),M=new Date(re+"T23:59:59"));break}case"all":O=void 0,M=void 0;break}ke(O?O.toISOString():void 0,M?M.toISOString():void 0)},[J,te,re,ke]);const B=r.useMemo(()=>{let a=o.filter(b=>b.branchId===W||b.branchid===W);return V&&(a=a.filter(b=>b.id.toLowerCase().includes(V.toLowerCase())||(b.sale_code||"").toLowerCase().includes(V.toLowerCase())||b.customer.name.toLowerCase().includes(V.toLowerCase())||(b.username||b.userName||"").toLowerCase().includes(V.toLowerCase()))),a.sort((b,S)=>new Date(S.date).getTime()-new Date(b.date).getTime()),a},[o,W,V]),xt=r.useMemo(()=>B.reduce((a,b)=>a+b.total,0),[B]);return r.useEffect(()=>{const a=b=>{b.target.closest(".dropdown-menu-container")||f(null)};if(l)return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[l]),Z?e.jsxs(Vt.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex md:items-center md:justify-center items-end justify-center p-0 md:p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 w-full md:max-w-7xl max-h-[95vh] md:rounded-2xl rounded-t-3xl shadow-2xl overflow-hidden flex flex-col animate-slide-up-bottom",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700 bg-white/95 dark:bg-slate-900/70 backdrop-blur",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-400 dark:text-slate-500",children:"L·ªãch s·ª≠ b√°n h√†ng"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:"Theo d√µi giao d·ªãch g·∫ßn ƒë√¢y"})]}),e.jsx("button",{onClick:h,className:"text-slate-500 hover:text-slate-900 dark:hover:text-white text-2xl leading-none px-2","aria-label":"ƒê√≥ng l·ªãch s·ª≠ b√°n h√†ng",children:"√ó"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1 -mx-4 px-4 md:mx-0 md:px-0 scrollbar-thin",children:[{key:"7days",label:"7 ng√†y qua"},{key:"week",label:"Tu·∫ßn"},{key:"month",label:"Th√°ng"},{key:"30days",label:"30 ng√†y qua"},{key:"custom",label:"T√πy ch·ªçn"},{key:"all",label:"T·∫•t c·∫£"}].map(a=>e.jsx("button",{onClick:()=>ae(a.key),className:`px-4 py-2 rounded-2xl text-sm font-medium whitespace-nowrap border transition-all min-w-[96px] ${J===a.key?"bg-blue-600 text-white border-blue-600 shadow-lg shadow-blue-500/30":"bg-slate-100 dark:bg-slate-800/80 text-slate-700 dark:text-slate-200 border-transparent"}`,children:a.label},a.key))}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3",children:[e.jsxs("div",{className:"w-full md:flex-1 relative",children:[e.jsx("input",{type:"text",value:V,onChange:a=>ie(a.target.value),placeholder:"T√¨m h√≥a ƒë∆°n, kh√°ch h√†ng ho·∫∑c m√£ phi·∫øu",className:"w-full pl-10 pr-4 py-2.5 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-800 text-sm text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500"}),e.jsxs("svg",{className:"w-5 h-5 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 19a8 8 0 100-16 8 8 0 000 16z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-4.3-4.3"})]})]}),e.jsx("div",{className:"flex items-center justify-between md:justify-end gap-4 w-full md:w-auto",children:e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"T·ªïng doanh thu"}),e.jsx("div",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:m(xt)})]})})]}),J==="custom"&&e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3",children:[e.jsxs("label",{className:"text-sm text-slate-600 dark:text-slate-400 flex items-center gap-2",children:["T·ª´",e.jsx("input",{type:"date",value:te,onChange:a=>_(a.target.value),className:"px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 text-sm"})]}),e.jsxs("label",{className:"text-sm text-slate-600 dark:text-slate-400 flex items-center gap-2",children:["ƒê·∫øn",e.jsx("input",{type:"date",value:re,onChange:a=>se(a.target.value),className:"px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 text-sm"})]})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:B.length===0?e.jsx("div",{className:"text-center py-12 text-slate-400",children:"Kh√¥ng c√≥ h√≥a ƒë∆°n n√†o"}):e.jsxs("div",{children:[e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-4 px-4 py-3 bg-slate-100 dark:bg-slate-700 border-b border-slate-200 dark:border-slate-600 sticky top-0 z-10",children:[e.jsx("div",{className:"col-span-1 text-xs font-semibold text-slate-600 dark:text-slate-300"}),e.jsx("div",{className:"col-span-2 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"M√£ phi·∫øu"}),e.jsx("div",{className:"col-span-2 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"Kh√°ch h√†ng"}),e.jsx("div",{className:"col-span-4 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"Chi ti·∫øt"}),e.jsx("div",{className:"col-span-2 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"Thanh to√°n"}),e.jsx("div",{className:"col-span-1 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"Thao t√°c"})]}),e.jsx("div",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:B.map(a=>{var H,ye,z,xe,et,me;const b=new Date(a.date);a.items.reduce((p,I)=>p+I.quantity*I.sellingPrice,0);const S=(je||[]).find(p=>{var I;return(I=p.description)==null?void 0:I.includes(a.sale_code||a.id)}),O=S?S.totalAmount-S.remainingAmount:a.total,M=(S==null?void 0:S.remainingAmount)||0,j=M>0,q=a.items.slice(0,3),Ze=a.items.length-q.length,Je=b.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}),Ke=b.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}),ce=(((ye=(H=a.customer)==null?void 0:H.name)==null?void 0:ye.charAt(0))||"K").toUpperCase(),ne=a.paymentMethod==="cash"?"Ti·ªÅn m·∫∑t":"Chuy·ªÉn kho·∫£n";return e.jsxs("div",{className:"p-4 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsxs("div",{className:"md:hidden flex flex-col gap-3 bg-white dark:bg-slate-800/60 rounded-2xl border border-slate-200 dark:border-slate-700 p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[a.sale_code&&e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-blue-600 dark:text-blue-300",children:[e.jsx(Ds,{className:"w-4 h-4"}),a.sale_code]}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 flex items-center gap-1 mt-1",children:[e.jsx(Ps,{className:"w-3.5 h-3.5"}),e.jsxs("span",{children:[Je," ¬∑ ",Ke]})]}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 flex items-center gap-1 mt-1",children:[e.jsx("span",{className:"font-medium text-slate-600 dark:text-slate-300",children:"NV"}),e.jsx("span",{children:a.userName||a.username||"N/A"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"T·ªïng ti·ªÅn"}),e.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-white",children:m(a.total)}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 flex items-center gap-1 justify-end mt-1",children:[a.paymentMethod==="cash"?e.jsx(Rt,{className:"w-4 h-4"}):e.jsx(Qt,{className:"w-4 h-4"}),e.jsx("span",{children:ne})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-slate-50 dark:bg-slate-900/30 rounded-2xl p-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-200 font-semibold",children:ce}),e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-semibold text-slate-900 dark:text-white",children:((z=a.customer)==null?void 0:z.name)||"Kh√°ch v√£ng lai"}),((xe=a.customer)==null?void 0:xe.phone)&&e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2 5.5C2 4.119 3.12 3 4.5 3h1.76c.636 0 1.197.4 1.39 1.005l.8 2.47a1.5 1.5 0 01-.35 1.46L7.11 8.94a12.044 12.044 0 005.95 5.95l1.006-1.002a1.5 1.5 0 011.46-.349l2.469.8c.606.193 1.005.754 1.005 1.39V19.5c0 1.38-1.119 2.5-2.5 2.5h-.25C8.268 22 2 15.732 2 7.75v-.25z"})}),a.customer.phone]})]})]}),e.jsxs("div",{className:"space-y-2",children:[q.map((p,I)=>e.jsxs("div",{className:"flex items-start justify-between text-sm text-slate-700 dark:text-slate-200",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"font-semibold",children:[p.quantity," x ",p.partName]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[m(p.sellingPrice||0)," ","/ s·∫£n ph·∫©m"]})]}),e.jsx("span",{className:"font-bold text-slate-900 dark:text-white",children:m(p.quantity*(p.sellingPrice||0))})]},I)),Ze>0&&e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:["+",Ze," s·∫£n ph·∫©m kh√°c"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[j?e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-200",children:["‚ö†Ô∏è C√≤n n·ª£ ",m(M)]}):e.jsx("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-200",children:"‚úì ƒê√£ thanh to√°n"}),e.jsx("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700 dark:bg-slate-800 dark:text-slate-200",children:ne})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-3 border-t border-dashed border-slate-200 dark:border-slate-700",children:[e.jsx("button",{onClick:()=>G(a),className:"flex-1 min-w-[120px] px-3 py-2 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-200 text-sm font-medium",children:"In ho√° ƒë∆°n"}),e.jsx("button",{onClick:()=>{ee(a),ze(!0)},className:"flex-1 min-w-[120px] px-3 py-2 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-200 text-sm font-medium",children:"Xem chi ti·∫øt"}),e.jsx("button",{onClick:()=>{ee(a),le(!0)},className:"flex-1 min-w-[120px] px-3 py-2 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-200 text-sm font-medium",children:"Ch·ªânh s·ª≠a"}),Ct(X==null?void 0:X.role,"sale.delete")&&e.jsx("button",{onClick:()=>D(a.id),className:"flex-1 min-w-[120px] px-3 py-2 rounded-xl bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-300 text-sm font-medium",children:"X√≥a ƒë∆°n"})]})]}),e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-4 items-start",children:[e.jsx("div",{className:"col-span-1 flex items-start pt-1",children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-slate-300"})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"space-y-1",children:[a.sale_code&&e.jsx("div",{className:"text-sm font-bold text-blue-600 dark:text-blue-400",children:a.sale_code}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:[b.getDate(),"/",b.getMonth()+1,"/",b.getFullYear()," ",String(b.getHours()).padStart(2,"0"),":",String(b.getMinutes()).padStart(2,"0")]}),e.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-300",children:[e.jsx("span",{className:"font-medium",children:"NV:"})," ",a.userName||a.username||"N/A"]})]})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100",children:((et=a.customer)==null?void 0:et.name)||"Kh√°ch v√£ng lai"}),((me=a.customer)==null?void 0:me.phone)&&e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:["üìû ",a.customer.phone]})]})}),e.jsx("div",{className:"col-span-4",children:e.jsx("div",{className:"space-y-1",children:a.items.map((p,I)=>e.jsxs("div",{className:"text-xs text-slate-700 dark:text-slate-300",children:[e.jsxs("span",{className:"font-medium",children:[p.quantity," x"]})," ",p.partName,e.jsxs("span",{className:"text-slate-400 ml-1",children:["(",m(p.sellingPrice||0),")"]})," = ",e.jsx("span",{className:"font-semibold text-slate-900 dark:text-slate-100",children:m(p.quantity*(p.sellingPrice||0))})]},I))})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"T·ªïng ti·ªÅn:"}),e.jsx("div",{className:"text-base font-bold text-slate-900 dark:text-slate-100",children:m(a.total)}),j?e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400",children:["ƒê√£ tr·∫£: ",m(O)]}),e.jsxs("div",{className:"text-xs font-semibold text-red-600 dark:text-red-400",children:["C√≤n n·ª£: ",m(M)]}),e.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-medium bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300",children:"‚ö†Ô∏è C√≤n n·ª£"})]}):e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",children:"‚úì ƒê√£ thanh to√°n"})}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:a.paymentMethod==="cash"?"üíµ Ti·ªÅn m·∫∑t":"üè¶ Chuy·ªÉn kho·∫£n"})]})}),e.jsxs("div",{className:"col-span-1 flex items-start justify-end gap-2 pt-1",children:[e.jsx("button",{onClick:()=>{ee(a),le(!0)},className:"p-1.5 text-slate-400 hover:text-amber-600 dark:hover:text-amber-400 transition-colors",title:"Ch·ªânh s·ª≠a",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsxs("div",{className:"relative dropdown-menu-container",children:[e.jsx("button",{onClick:p=>{const I=p.currentTarget.getBoundingClientRect();ve({top:I.bottom+4,right:window.innerWidth-I.right}),f(l===a.id?null:a.id)},className:"p-1.5 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 transition-colors",title:"T√πy ch·ªçn",children:e.jsxs("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"12",cy:"5",r:"2"}),e.jsx("circle",{cx:"12",cy:"12",r:"2"}),e.jsx("circle",{cx:"12",cy:"19",r:"2"})]})}),l===a.id&&e.jsxs("div",{className:"fixed w-48 bg-white dark:bg-slate-800 rounded-lg shadow-lg border border-slate-200 dark:border-slate-700 z-[9999]",style:{top:w.top,right:w.right},children:[e.jsxs("button",{onClick:()=>{G(a),f(null)},className:"w-full text-left px-4 py-2.5 text-sm text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 flex items-center gap-2 rounded-t-lg",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"In l·∫°i h√≥a ƒë∆°n"]}),e.jsxs("button",{onClick:()=>{ee(a),ze(!0),f(null)},className:"w-full text-left px-4 py-2.5 text-sm text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 flex items-center gap-2",children:[e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Xem chi ti·∫øt"]}),Ct(X==null?void 0:X.role,"sale.delete")&&e.jsxs("button",{onClick:()=>{D&&D(a.id),f(null)},className:"w-full text-left px-4 py-2.5 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center gap-2 rounded-b-lg",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"X√≥a h√≥a ƒë∆°n"]})]})]})]})]})]},a.id)})})]})}),e.jsx("div",{className:"p-4 border-t border-slate-200 dark:border-slate-700 flex items-center justify-between",children:e.jsxs("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Hi·ªÉn th·ªã ",B.length," ƒë∆°n h√†ng"]})})]})}),e.jsx(_s,{isOpen:C,onClose:()=>{ze(!1),ee(null)},sale:Y,onPrint:G}),e.jsx(Bs,{isOpen:Ye,onClose:()=>{le(!1),ee(null)},sale:Y,onSave:async a=>{try{const{supabase:b}=await it(async()=>{const{supabase:$}=await import("./index-9wxNecOd.js").then(q=>q.bq);return{supabase:$}},__vite__mapDeps([0,1])),{profile:S}=await it(async()=>{const{profile:$}=await import("./index-9wxNecOd.js").then(q=>q.br);return{profile:$}},__vite__mapDeps([0,1])).then($=>({profile:null})),M=a.items.reduce(($,q)=>$+q.quantity*q.sellingPrice,0)-a.discount,{error:j}=await b.from("sales").update({items:a.items,customer:a.customer,paymentmethod:a.paymentMethod,discount:a.discount,total:M}).eq("id",a.id);if(j)throw j;await Ft(null,{action:"sale_update",tableName:"sales",recordId:a.id,newData:{items:a.items,customer:a.customer,paymentMethod:a.paymentMethod,discount:a.discount,total:M}}),queryClient.invalidateQueries({queryKey:["salesRepo"]}),queryClient.invalidateQueries({queryKey:["salesRepoPaged"]}),queryClient.invalidateQueries({queryKey:["salesRepoKeyset"]}),u.success("ƒê√£ c·∫≠p nh·∫≠t ƒë∆°n h√†ng th√†nh c√¥ng"),le(!1),ee(null)}catch(b){console.error("Error updating sale:",b),u.error("L·ªói khi c·∫≠p nh·∫≠t ƒë∆°n h√†ng: "+b.message)}}})]}):null},Gs=()=>{const{upsertCustomer:Z,cartItems:h,setCartItems:o,clearCart:W,deleteSale:G,currentBranchId:k,finalizeSale:D,setCashTransactions:U,setPaymentSources:oe}=Kt(),L=Wt(),{data:A=[],isLoading:Qe}=js(),Ne=vs(),{data:Q=[],isLoading:pe,error:Ce}=Ot(),{data:Xe=[]}=Ns(),[fe,R]=r.useState(1),[ke,Se]=r.useState(20),[Te,Me]=r.useState(""),[Le,Pe]=r.useState(""),[De,je]=r.useState(),[X,J]=r.useState(),[ae,V]=r.useState("all"),[ie,te]=r.useState("all"),[_,re]=r.useState(!1),[se,Y]=r.useState(null),ee={branchId:k,page:_?void 0:fe,pageSize:ke,search:Le||void 0,fromDate:De,toDate:X,mode:_?"keyset":"offset",afterDate:_?se==null?void 0:se.afterDate:void 0,afterId:_?se==null?void 0:se.afterId:void 0,status:ae==="all"?void 0:ae==="cancelled"?"refunded":ae==="completed"?"completed":ae,paymentMethod:ie==="all"?void 0:ie},{data:C,isLoading:ze,error:Ye}=ys(ee),le=(C==null?void 0:C.data)||[],l=(C==null?void 0:C.meta)||{page:1,totalPages:1,total:le.length,hasMore:!1};r.useEffect(()=>{var t;_&&((t=C==null?void 0:C.meta)==null?void 0:t.mode)==="keyset"&&Y({afterDate:C.meta.nextAfterDate,afterId:C.meta.nextAfterId})},[_,C]);const{mutateAsync:f}=ws(),w=Cs(),ve=r.useCallback(()=>R(t=>Math.max(1,t-1)),[]),B=r.useCallback(()=>R(t=>t+1),[]),xt=r.useCallback(t=>{Se(t),R(1),_&&Y(null)},[]);r.useEffect(()=>{const t=setTimeout(()=>{Pe(Te),R(1)},300);return()=>clearTimeout(t)},[Te]);const[a,b]=r.useState(""),[S,O]=r.useState("all"),[M,j]=r.useState(""),[$,q]=r.useState(!1),[Ze,Je]=r.useState(!1),Ke=r.useRef(null),[ce,ne]=r.useState(""),[H,ye]=r.useState("products"),[z,xe]=r.useState(null),[et,me]=r.useState(!1),[p,I]=r.useState(0),[Ie,Tt]=r.useState("amount"),[Mt,tt]=r.useState(0),[Xt,st]=r.useState(!1),[Yt,We]=r.useState(!1),[E,we]=r.useState({name:"",phone:"",vehicleModel:"",licensePlate:""}),[Lt,Pt]=r.useState(""),[_e,mt]=r.useState(""),[he,ht]=r.useState(""),[Oe,Dt]=r.useState([]),[at,zt]=r.useState(0),[de,gt]=r.useState(null),[F,rt]=r.useState(null),[Be,lt]=r.useState(0),[bt,Zt]=r.useState(!1),[ut,It]=r.useState(!0),[pt,Jt]=r.useState(!1),[es,ts]=r.useState(""),[ss,as]=r.useState("");r.useEffect(()=>{var t;$&&((t=Ke.current)==null||t.focus())},[$]);const[rs,ft]=r.useState(!1),[v,kt]=r.useState(null),[i,ls]=r.useState(null);r.useEffect(()=>{(async()=>{try{const{data:s,error:n}=await $t.from("store_settings").select("store_name, address, phone, email, logo_url, bank_qr_url, bank_name, bank_account_number, bank_account_holder, bank_branch").order("created_at",{ascending:!1}).limit(1).single();if(n){console.error("Error fetching store settings:",n);return}ls(s)}catch(s){console.error("Failed to fetch store settings:",s)}})()},[]);const Re=r.useCallback(t=>{var c,x;const s=((c=t.retailPrice)==null?void 0:c[k])??0,n=((x=t.stock)==null?void 0:x[k])??0,d=h.find(g=>g.partId===t.id);if(d){const g=d.quantity+1;if(g>n){u.error(`Kh√¥ng ƒë·ªß h√†ng! T·ªìn kho: ${n}`);return}o(N=>N.map(T=>T.partId===t.id?{...T,quantity:g}:T))}else{if(n<1){u.error("S·∫£n ph·∫©m ƒë√£ h·∫øt h√†ng!");return}const g={partId:t.id,partName:t.name,sku:t.sku,quantity:1,sellingPrice:s,stockSnapshot:n,discount:0};o(N=>[...N,g])}},[h,o,k]),_t=r.useCallback(t=>{o(s=>s.filter(n=>n.partId!==t))},[o]),Ve=r.useCallback((t,s)=>{if(s<=0){_t(t);return}const n=h.find(d=>d.partId===t);if(n&&s>n.stockSnapshot){u.error(`Kh√¥ng ƒë·ªß h√†ng! T·ªìn kho: ${n.stockSnapshot}`);return}o(d=>d.map(c=>c.partId===t?{...c,quantity:s}:c))},[h,o,_t]),ge=r.useMemo(()=>h.reduce((t,s)=>t+s.sellingPrice*s.quantity,0),[h]),Bt=r.useMemo(()=>Math.max(0,ge-p),[ge,p]),ns=r.useMemo(()=>{const t=new Map;return h.forEach(s=>t.set(s.partId,s)),t},[h]),Ae=t=>{if(!t)return{bg:"bg-slate-100 dark:bg-slate-700",text:"text-slate-500 dark:text-slate-400"};const s={Nh·ªõt:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-400"},D·∫ßu:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-400"},L·ªçc:{bg:"bg-cyan-100 dark:bg-cyan-900/30",text:"text-cyan-700 dark:text-cyan-400"},"L·ªçc gi√≥":{bg:"bg-cyan-100 dark:bg-cyan-900/30",text:"text-cyan-700 dark:text-cyan-400"},"L·ªçc nh·ªõt":{bg:"bg-cyan-100 dark:bg-cyan-900/30",text:"text-cyan-700 dark:text-cyan-400"},Bugi:{bg:"bg-rose-100 dark:bg-rose-900/30",text:"text-rose-700 dark:text-rose-400"},Phanh:{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-400"},"M√° phanh":{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-400"},X√≠ch:{bg:"bg-zinc-200 dark:bg-zinc-700/50",text:"text-zinc-700 dark:text-zinc-300"},S√™n:{bg:"bg-zinc-200 dark:bg-zinc-700/50",text:"text-zinc-700 dark:text-zinc-300"},"Nh√¥ng s√™n dƒ©a":{bg:"bg-zinc-200 dark:bg-zinc-700/50",text:"text-zinc-700 dark:text-zinc-300"},L·ªëp:{bg:"bg-slate-700 dark:bg-slate-600",text:"text-white dark:text-slate-100"},"V·ªè xe":{bg:"bg-slate-700 dark:bg-slate-600",text:"text-white dark:text-slate-100"},"·∫Æc quy":{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-700 dark:text-green-400"},"B√¨nh ƒëi·ªán":{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-700 dark:text-green-400"},ƒê√®n:{bg:"bg-yellow-100 dark:bg-yellow-900/30",text:"text-yellow-700 dark:text-yellow-400"},"B√≥ng ƒë√®n":{bg:"bg-yellow-100 dark:bg-yellow-900/30",text:"text-yellow-700 dark:text-yellow-400"},ƒêi·ªán:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-400"},IC:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-400"},GioƒÉng:{bg:"bg-orange-100 dark:bg-orange-900/30",text:"text-orange-700 dark:text-orange-400"},Ron:{bg:"bg-orange-100 dark:bg-orange-900/30",text:"text-orange-700 dark:text-orange-400"},"V√≤ng bi":{bg:"bg-indigo-100 dark:bg-indigo-900/30",text:"text-indigo-700 dark:text-indigo-400"},"B·∫°c ƒë·∫°n":{bg:"bg-indigo-100 dark:bg-indigo-900/30",text:"text-indigo-700 dark:text-indigo-400"},"Cao su":{bg:"bg-stone-200 dark:bg-stone-700/50",text:"text-stone-700 dark:text-stone-300"},"Ph·ª• ki·ªán":{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-700 dark:text-purple-400"},Honda:{bg:"bg-red-100 dark:bg-red-900/40",text:"text-red-700 dark:text-red-400"},Yamaha:{bg:"bg-blue-100 dark:bg-blue-900/40",text:"text-blue-700 dark:text-blue-400"},Suzuki:{bg:"bg-blue-200 dark:bg-blue-900/50",text:"text-blue-800 dark:text-blue-300"},SYM:{bg:"bg-sky-100 dark:bg-sky-900/40",text:"text-sky-700 dark:text-sky-400"},Piaggio:{bg:"bg-emerald-100 dark:bg-emerald-900/40",text:"text-emerald-700 dark:text-emerald-400"},Vespa:{bg:"bg-emerald-100 dark:bg-emerald-900/40",text:"text-emerald-700 dark:text-emerald-400"},Kymco:{bg:"bg-orange-100 dark:bg-orange-900/40",text:"text-orange-700 dark:text-orange-400"},NGK:{bg:"bg-green-100 dark:bg-green-900/40",text:"text-green-700 dark:text-green-400"},Denso:{bg:"bg-rose-100 dark:bg-rose-900/40",text:"text-rose-700 dark:text-rose-400"},DENSO:{bg:"bg-rose-100 dark:bg-rose-900/40",text:"text-rose-700 dark:text-rose-400"},Kenda:{bg:"bg-amber-100 dark:bg-amber-900/40",text:"text-amber-700 dark:text-amber-400"},IRC:{bg:"bg-violet-100 dark:bg-violet-900/40",text:"text-violet-700 dark:text-violet-400"},"IRC Tire":{bg:"bg-violet-100 dark:bg-violet-900/40",text:"text-violet-700 dark:text-violet-400"},Michelin:{bg:"bg-indigo-100 dark:bg-indigo-900/40",text:"text-indigo-700 dark:text-indigo-400"},Dunlop:{bg:"bg-yellow-100 dark:bg-yellow-900/40",text:"text-yellow-700 dark:text-yellow-400"},Castrol:{bg:"bg-lime-100 dark:bg-lime-900/40",text:"text-lime-700 dark:text-lime-400"},Shell:{bg:"bg-amber-100 dark:bg-amber-900/40",text:"text-amber-700 dark:text-amber-400"},Motul:{bg:"bg-red-100 dark:bg-red-900/40",text:"text-red-700 dark:text-red-400"},Bosch:{bg:"bg-slate-200 dark:bg-slate-700/50",text:"text-slate-700 dark:text-slate-300"},Kh√°c:{bg:"bg-slate-100 dark:bg-slate-700",text:"text-slate-600 dark:text-slate-400"}};if(s[t])return s[t];const n=t.toLowerCase();for(const[x,g]of Object.entries(s))if(n.includes(x.toLowerCase())||x.toLowerCase().includes(n))return g;const d=[{bg:"bg-pink-100 dark:bg-pink-900/30",text:"text-pink-700 dark:text-pink-400"},{bg:"bg-violet-100 dark:bg-violet-900/30",text:"text-violet-700 dark:text-violet-400"},{bg:"bg-teal-100 dark:bg-teal-900/30",text:"text-teal-700 dark:text-teal-400"},{bg:"bg-lime-100 dark:bg-lime-900/30",text:"text-lime-700 dark:text-lime-400"},{bg:"bg-fuchsia-100 dark:bg-fuchsia-900/30",text:"text-fuchsia-700 dark:text-fuchsia-400"},{bg:"bg-emerald-100 dark:bg-emerald-900/30",text:"text-emerald-700 dark:text-emerald-400"}],c=t.split("").reduce((x,g)=>x+g.charCodeAt(0),0);return d[c%d.length]},jt=r.useMemo(()=>Oe.reduce((t,s)=>t+s.sellingPrice*s.quantity,0),[Oe]),ds=r.useMemo(()=>Math.max(0,jt-at),[jt,at]),os=r.useMemo(()=>Oe.reduce((t,s)=>t+s.quantity,0),[Oe]),be=r.useMemo(()=>{if(pe||Ce)return[];let t=Q;return a&&(t=t.filter(s=>s.name.toLowerCase().includes(a.toLowerCase())||s.sku.toLowerCase().includes(a.toLowerCase()))),t},[Q,a,pe,Ce]),vt=r.useMemo(()=>{if(!be.length)return[];const t=be.filter(n=>{var c;const d=Number(((c=n.stock)==null?void 0:c[k])??0);return S==="low"?d>0&&d<=dt:S==="out"?d<=0:!0}),s=n=>n<=0?2:n<=dt?1:0;return t.slice().sort((n,d)=>{var N,T;const c=Number(((N=n.stock)==null?void 0:N[k])??0),x=Number(((T=d.stock)==null?void 0:T[k])??0),g=s(c)-s(x);return g!==0?g:n.name.localeCompare(d.name)}).slice(0,36)},[be,S,k]),qe=t=>t.toLowerCase().replace(/[-\s./\\]/g,""),is=t=>{if(t.preventDefault(),!M.trim())return;const s=M.trim(),n=qe(s),d=be.find(c=>{var x,g,N;return qe(c.barcode||"")===n||((x=c.barcode)==null?void 0:x.toLowerCase())===s.toLowerCase()||qe(c.sku||"")===n||((g=c.sku)==null?void 0:g.toLowerCase())===s.toLowerCase()||((N=c.name)==null?void 0:N.toLowerCase().includes(s.toLowerCase()))});d?(Re(d),u.success(`ƒê√£ th√™m ${d.name} v√†o gi·ªè h√†ng`),j(""),setTimeout(()=>{var c;return(c=Ke.current)==null?void 0:c.focus()},100)):(u.error(`Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m c√≥ m√£: ${s}`),j(""))},cs=t=>{console.log("üì∑ Camera scanned:",t);const s=qe(t),n=Q.find(d=>{var c,x;return qe(d.barcode||"")===s||((c=d.barcode)==null?void 0:c.toLowerCase())===t.toLowerCase()||qe(d.sku||"")===s||((x=d.sku)==null?void 0:x.toLowerCase())===t.toLowerCase()});if(n){const d=h.find(c=>c.partId===n.id);d?Ve(n.id,d.quantity+1):(Re(n),u.success(`ƒê√£ th√™m ${n.name}`))}else u.error(`Kh√¥ng t√¨m th·∫•y: ${t}`)},{lowStockCount:Fe,outOfStockCount:Ge}=Is(Q,k,dt),xs=[{key:"all",label:"T·∫•t c·∫£",count:be.length,activeClass:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white border-transparent shadow-blue-500/30",inactiveClass:"bg-white/80 dark:bg-slate-900/50 text-slate-700 dark:text-slate-200 border border-slate-200 dark:border-slate-700"},{key:"low",label:"T·ªìn th·∫•p",count:Fe,activeClass:"bg-gradient-to-r from-amber-500 to-orange-500 text-white border-transparent shadow-amber-500/30",inactiveClass:"bg-white/80 dark:bg-slate-900/50 text-amber-700 dark:text-amber-200 border border-amber-200/70 dark:border-amber-800/60"},{key:"out",label:"H·∫øt h√†ng",count:Ge,activeClass:"bg-gradient-to-r from-rose-500 to-red-500 text-white border-transparent shadow-rose-500/30",inactiveClass:"bg-white/80 dark:bg-slate-900/50 text-rose-700 dark:text-rose-200 border border-rose-200/70 dark:border-rose-800/60"}],At=r.useRef(!1);r.useEffect(()=>{if(!At.current&&(Fe>0||Ge>0)){const t=[];Ge>0&&t.push(`H·∫øt h√†ng: ${Ge}`),Fe>0&&t.push(`T·ªìn th·∫•p: ${Fe}`),u.info(t.join(" ¬∑ ")),At.current=!0}},[Fe,Ge]);const qt=r.useMemo(()=>ce?A.filter(t=>{var s;return t.name.toLowerCase().includes(ce.toLowerCase())||((s=t.phone)==null?void 0:s.includes(ce))||!1}).slice(0,10):A.slice(0,10),[A,ce]),ms=()=>{if(!E.name||!E.phone){alert("Vui l√≤ng nh·∫≠p t√™n v√† s·ªë ƒëi·ªán tho·∫°i");return}if(A.find(n=>n.phone===E.phone)){alert("S·ªë ƒëi·ªán tho·∫°i n√†y ƒë√£ t·ªìn t·∫°i!");return}const s={id:`CUST-${Date.now()}`,name:E.name,phone:E.phone,vehicleModel:E.vehicleModel,licensePlate:E.licensePlate,status:"active",segment:"New",loyaltyPoints:0,totalSpent:0,visitCount:1,lastVisit:new Date().toISOString(),created_at:new Date().toISOString()};Ne.mutate(s,{onSuccess:()=>{xe(s),ne(s.name),we({name:"",phone:"",vehicleModel:"",licensePlate:""}),We(!1),u.success("ƒê√£ th√™m kh√°ch h√†ng m·ªõi!")},onError:n=>{console.error("Error creating customer:",n),u.error("Kh√¥ng th·ªÉ th√™m kh√°ch h√†ng. Vui l√≤ng th·ª≠ l·∫°i.")}})},hs=t=>{kt(t),ft(!0)},yt=r.useRef(null),gs=async()=>{if(!(!yt.current||!v))try{u.info("ƒêang t·∫°o h√¨nh ·∫£nh...");const t=(await it(async()=>{const{default:g}=await import("./html2canvas.esm-QH1iLAAe.js");return{default:g}},[])).default,s=await t(yt.current,{backgroundColor:"#ffffff",scale:2,useCORS:!0,allowTaint:!0}),n=await new Promise(g=>{s.toBlob(N=>g(N),"image/png",1)}),d=`hoa-don-${v.sale_code||Ee(v.id)||v.id}.png`;if(navigator.share&&navigator.canShare){const g=new File([n],d,{type:"image/png"}),N={files:[g]};if(navigator.canShare(N)){await navigator.share({files:[g],title:"H√≥a ƒë∆°n b√°n h√†ng",text:`H√≥a ƒë∆°n ${v.sale_code||Ee(v.id)}`}),u.success("ƒê√£ chia s·∫ª h√≥a ƒë∆°n!");return}}const c=URL.createObjectURL(n),x=document.createElement("a");x.href=c,x.download=d,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(c),u.success("ƒê√£ t·∫£i xu·ªëng h√¨nh ·∫£nh h√≥a ƒë∆°n!")}catch(t){console.error("Share error:",t),u.error("Kh√¥ng th·ªÉ chia s·∫ª h√≥a ƒë∆°n")}},bs=()=>{if(!v)return;Pt(v.sale_code||Ee(v.id)||v.id),mt(v.customer.name),ht(v.customer.phone||"");const t=v.items.map(s=>({partId:s.partId||s.partid||"",partName:s.partName||s.partname||"",sku:s.sku||"",quantity:s.quantity||0,sellingPrice:s.sellingPrice||s.sellingprice||s.price||0,stockSnapshot:s.stockSnapshot||0,discount:s.discount||0}));Dt(t),zt(v.discount||0),setTimeout(()=>{Ht("last-receipt"),ft(!1),kt(null)},100)},{profile:y}=St(),us=async t=>{var s;if(!Ct(y==null?void 0:y.role,"sale.delete")){u.error("B·∫°n kh√¥ng c√≥ quy·ªÅn x√≥a h√≥a ƒë∆°n");return}if(confirm("X√°c nh·∫≠n x√≥a h√≥a ƒë∆°n n√†y? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c."))try{const{deleteSaleById:n}=await it(async()=>{const{deleteSaleById:c}=await import("./index-9wxNecOd.js").then(x=>x.bs);return{deleteSaleById:c}},__vite__mapDeps([0,1])),d=await n(t);if(!d.ok){u.error(((s=d.error)==null?void 0:s.message)||"X√≥a h√≥a ƒë∆°n th·∫•t b·∫°i!");return}L.invalidateQueries({queryKey:["sales"]}),u.success("ƒê√£ x√≥a h√≥a ƒë∆°n th√†nh c√¥ng!"),Ft((y==null?void 0:y.id)||null,{action:"sale.delete",tableName:"sales",recordId:t,oldData:null,newData:null})}catch(n){u.error("X√≥a h√≥a ƒë∆°n th·∫•t b·∫°i!"),console.error("Delete sale error:",n)}},ps=t=>{if(confirm("M·ªü l·∫°i h√≥a ƒë∆°n n√†y ƒë·ªÉ ch·ªânh s·ª≠a? Gi·ªè h√†ng hi·ªán t·∫°i s·∫Ω b·ªã x√≥a.")){if(W(),t.items.forEach(s=>{const n=Q.find(d=>d.id===s.partId);if(n)for(let d=0;d<s.quantity;d++)Re(n)}),t.customer.id){const s=A.find(n=>n.id===t.customer.id);s&&(xe(s),ne(s.name))}else mt(t.customer.name),ht(t.customer.phone||"");I(t.discount||0),st(!1),alert("H√≥a ƒë∆°n ƒë√£ ƒë∆∞·ª£c t·∫£i v√†o gi·ªè h√†ng ƒë·ªÉ ch·ªânh s·ª≠a")}},fs=async(t,s,n,d)=>{var c;if(!(s<=0)){console.log("[createCustomerDebtIfNeeded] CALLED with:",{saleId:t.id,totalAmount:n,paidAmount:d,remainingAmount:s,customerName:t.customer.name,timestamp:new Date().toISOString()});try{const x=t.customer.id||t.customer.phone||`CUST-ANON-${Date.now()}`,g=((c=t.customer.name)==null?void 0:c.trim())||t.customer.phone||"Kh√°ch l·∫ª";let T=`B√°n h√†ng - H√≥a ƒë∆°n ${t.sale_code||t.id}`;t.items&&t.items.length>0&&(T+=`

S·∫£n ph·∫©m ƒë√£ mua:`,t.items.forEach(P=>{const K=P.quantity*P.sellingPrice,He=P.discount||0;T+=`
  ‚Ä¢ ${P.quantity} x ${P.partName} - ${m(K)}`,He>0&&(T+=` (Gi·∫£m: ${m(He)})`)})),t.discount&&t.discount>0&&(T+=`

Gi·∫£m gi√° ƒë∆°n h√†ng: -${m(t.discount)}`);const ue=t.paymentMethod==="cash"?"Ti·ªÅn m·∫∑t":"Chuy·ªÉn kho·∫£n";T+=`

Ph∆∞∆°ng th·ª©c: ${ue}`,T+=`

NV: ${t.userName||"N/A"}`;const $e={customerId:x,customerName:g,phone:t.customer.phone||null,licensePlate:null,description:T,totalAmount:n,paidAmount:d,remainingAmount:s,createdDate:new Date().toISOString().split("T")[0],branchId:k,saleId:t.id};console.log("[SalesManager] createCustomerDebt payload:",$e);const Ue=await w.mutateAsync($e);console.log("[SalesManager] createCustomerDebt result:",Ue),u.success(`ƒê√£ t·∫°o c√¥ng n·ª£ ${m(s)} cho ${g}`)}catch(x){console.error("Error creating customer debt:",x),console.error("Error details:",{message:x==null?void 0:x.message,cause:x==null?void 0:x.cause,stack:x==null?void 0:x.stack}),u.error(`Kh√¥ng th·ªÉ t·∫°o c√¥ng n·ª£ t·ª± ƒë·ªông: ${(x==null?void 0:x.message)||"L·ªói kh√¥ng x√°c ƒë·ªãnh"}`)}}},ks=async()=>{var t,s,n,d;if(h.length===0){alert("Vui l√≤ng th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng");return}if(!z&&!_e&&!he){alert("Vui l√≤ng nh·∫≠p th√¥ng tin kh√°ch h√†ng tr∆∞·ªõc khi b√°n h√†ng");return}if(!de){alert("Vui l√≤ng ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n");return}if(!F){alert("Vui l√≤ng ch·ªçn h√¨nh th·ª©c thanh to√°n");return}if(F==="partial"&&Be<=0){alert("Vui l√≤ng nh·∫≠p s·ªë ti·ªÅn kh√°ch tr·∫£");return}try{for(const P of h){const K=Q.find(nt=>nt.id===P.partId);if(!K){u.error(`Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m: ${P.partName}`);return}const He=((t=K.stock)==null?void 0:t[k])??0;if(P.quantity>He){u.error(`Kh√¥ng ƒë·ªß h√†ng cho ${K.name}. T·ªìn kho: ${He}`);return}}const c=`SALE-${Date.now()}`,x=h.reduce((P,K)=>P+K.sellingPrice*K.quantity,0),g=h.reduce((P,K)=>P+(K.discount||0),0),N=Math.max(0,x-g-p),T={id:z==null?void 0:z.id,name:(z==null?void 0:z.name)||_e||"Kh√°ch l·∫ª",phone:(z==null?void 0:z.phone)||he};Pt(c),mt(T.name),ht(T.phone||""),Dt([...h]),zt(p+g),!z&&he&&_e&&(A.find(K=>K.phone===he)||Z({id:`CUST-${Date.now()}`,name:_e,phone:he,status:"active",segment:"New",loyaltyPoints:0,totalSpent:0,visitCount:1,lastVisit:new Date().toISOString(),created_at:new Date().toISOString()}));const ue=await f({id:c,items:h,discount:p+g,customer:T,paymentMethod:de,userId:(y==null?void 0:y.id)||"local-user",userName:(y==null?void 0:y.email)||(y==null?void 0:y.full_name)||"Local User",branchId:k});if(ue!=null&&ue.error)throw ue.error;const $e=F==="full"?N:F==="partial"?Be:0,Ue=N-$e;if(console.log("[SalesManager] Payment details:",{paymentType:F,total:N,paidAmount:$e,partialAmount:Be,remainingAmount:Ue,hasCustomer:!!(z||_e||he)}),Ue>0){console.log("[SalesManager] Creating debt because remaining > 0");const{data:P,error:K}=await $t.from("sales").select(`
            *,
            user:userid(
              full_name,
              display_name,
              email
            )
          `).eq("id",c).single();K&&console.error("[SalesManager] Error fetching sale:",K);const nt=(P?{...P,userName:((s=P.user)==null?void 0:s.full_name)||((n=P.user)==null?void 0:n.display_name)||((d=P.user)==null?void 0:d.email)||"N/A"}:null)||{id:c,sale_code:void 0,date:new Date().toISOString(),items:h,subtotal:ge,discount:p+g,total:N,customer:T,paymentMethod:de,userName:(y==null?void 0:y.email)||(y==null?void 0:y.full_name)||"Local User",userId:(y==null?void 0:y.id)||"",branchId:k||""};console.log("[SalesManager] Sale data for debt:",nt),await fs(nt,Ue,N,$e)}else console.log("[SalesManager] No debt needed, paid in full");xe(null),ne(""),I(0),tt(0),Tt("amount"),gt(null),rt(null),lt(0),W(),bt&&setTimeout(()=>{Ht("last-receipt")},100)}catch(c){console.error("Error finalizing sale (atomic):",c),u.error((c==null?void 0:c.message)||"C√≥ l·ªói khi t·∫°o h√≥a ƒë∆°n (atomic)")}};return r.useEffect(()=>{const t=s=>{s.target.closest(".customer-dropdown-container")||me(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]),e.jsxs("div",{className:"min-h-screen max-w-full overflow-x-hidden bg-gradient-to-br from-slate-50 via-blue-50/20 to-indigo-50/30 dark:from-slate-900 dark:via-slate-900 dark:to-slate-800 pb-16 md:pb-0",children:[e.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-50 bg-white dark:bg-slate-800 border-t border-slate-200 dark:border-slate-700 safe-area-bottom",children:[e.jsx("div",{className:"absolute inset-0 bg-white/80 dark:bg-slate-800/80 backdrop-blur-lg -z-10"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 px-2 py-2",children:[e.jsxs("button",{onClick:()=>ye("products"),className:`flex flex-col items-center gap-1 px-1 py-1.5 rounded-lg transition-all duration-200 ${H==="products"?"text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/30":"text-slate-600 dark:text-slate-400 active:scale-95"}`,children:[e.jsx(wt,{className:`w-6 h-6 transition-transform ${H==="products"?"scale-105":""}`}),e.jsx("span",{className:`text-[9px] font-medium ${H==="products"?"font-semibold":""}`,children:"S·∫£n ph·∫©m"})]}),e.jsxs("button",{onClick:()=>ye("cart"),className:`flex flex-col items-center gap-1 px-1 py-1.5 rounded-lg transition-all duration-200 relative ${H==="cart"?"text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-900/30":"text-slate-600 dark:text-slate-400 active:scale-95"}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx(Nt,{className:`w-6 h-6 transition-transform ${H==="cart"?"scale-105":""}`}),h.length>0&&e.jsx("span",{className:"absolute -top-1 -right-2 px-1 min-w-[14px] h-[14px] text-[8px] font-bold rounded-full bg-red-500 text-white flex items-center justify-center",children:h.length})]}),e.jsx("span",{className:`text-[9px] font-medium ${H==="cart"?"font-semibold":""}`,children:"Gi·ªè h√†ng"})]}),e.jsxs("button",{onClick:()=>{ye("history"),st(!0)},className:`flex flex-col items-center gap-1 px-1 py-1.5 rounded-lg transition-all duration-200 ${H==="history"?"text-indigo-600 dark:text-indigo-400 bg-indigo-50 dark:bg-indigo-900/30":"text-slate-600 dark:text-slate-400 active:scale-95"}`,children:[e.jsx(Et,{className:`w-6 h-6 transition-transform ${H==="history"?"scale-105":""}`}),e.jsx("span",{className:`text-[9px] font-medium ${H==="history"?"font-semibold":""}`,children:"L·ªãch s·ª≠"})]})]})]}),e.jsxs("div",{className:"flex h-[calc(100vh-64px)] md:h-screen",children:[e.jsxs("div",{className:`flex-1 flex flex-col transition-all duration-300 ${H!=="products"?"hidden md:flex":"animate-fade-in"}`,children:[e.jsx("div",{className:"bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border-b border-slate-200/50 dark:border-slate-700/50 p-3 md:p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-3",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-stretch gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",placeholder:"T√¨m ki·∫øm s·∫£n ph·∫©m...",value:a,onChange:t=>b(t.target.value),className:"w-full pl-10 pr-4 py-2.5 border-2 border-slate-300/50 dark:border-slate-600/50 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm md:text-base transition-all placeholder:text-slate-400"})]}),e.jsxs("button",{type:"button",onClick:()=>q(t=>!t),className:`px-4 py-2 rounded-xl border-2 font-semibold text-sm flex items-center gap-2 transition-all ${$?"border-blue-500 text-blue-600 bg-blue-50 dark:bg-blue-900/20":"border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-200 bg-white dark:bg-slate-800"}`,children:[e.jsx(zs,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:$?"ƒê√≥ng qu√©t":"Qu√©t m√£"})]}),e.jsx("button",{type:"button",onClick:()=>Je(!0),className:"md:hidden px-3 py-2 rounded-xl border-2 border-green-500 text-green-600 bg-green-50 dark:bg-green-900/20 font-semibold text-sm flex items-center gap-1.5 transition-all hover:bg-green-100",title:"Qu√©t b·∫±ng camera",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),$&&e.jsxs("form",{onSubmit:is,className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-blue-500",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})})}),e.jsx("input",{ref:Ke,type:"text",placeholder:"Nh·∫≠p ho·∫∑c qu√©t m√£ v·∫°ch...",value:M,onChange:t=>j(t.target.value),className:"w-full pl-10 pr-10 py-2.5 border-2 border-blue-400 dark:border-blue-600 rounded-xl bg-blue-50/50 dark:bg-blue-900/20 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm md:text-base transition-all placeholder:text-blue-500/70 font-mono"}),M&&e.jsx("button",{type:"button",onClick:()=>j(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsx("div",{className:"hidden md:flex items-center gap-2",children:e.jsxs("button",{onClick:()=>st(!0),className:"px-4 py-2.5 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-xl whitespace-nowrap transition-all inline-flex items-center gap-2 text-sm font-bold shadow-lg hover:shadow-xl hover:scale-105 active:scale-95",title:"L·ªãch s·ª≠ b√°n h√†ng",children:[e.jsx(Et,{className:"w-5 h-5"}),e.jsx("span",{children:"L·ªãch s·ª≠"})]})})]})}),e.jsxs("div",{className:"bg-white/80 dark:bg-slate-800/80 border-b border-slate-200/60 dark:border-slate-700/60 px-3 md:px-6 py-3 flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsxs("div",{className:"text-xs md:text-sm text-slate-600 dark:text-slate-400 font-medium",children:["Hi·ªÉn th·ªã ",vt.length," / ",be.length||0," s·∫£n ph·∫©m",a&&" theo t·ª´ kh√≥a"]}),e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pb-1",children:xs.map(t=>{const s=S===t.key;return e.jsxs("button",{type:"button","aria-pressed":s,onClick:()=>O(t.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-semibold transition-all whitespace-nowrap ${s?t.activeClass:t.inactiveClass}`,children:[e.jsx("span",{children:t.label}),e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] font-black ${s?"bg-white/30":"bg-slate-100 dark:bg-slate-800"}`,children:t.count})]},t.key)})})]}),e.jsx("div",{className:"flex-1 p-0 md:p-6 overflow-y-auto bg-slate-50 dark:bg-slate-900 pb-24 md:pb-6",children:vt.length===0?e.jsxs("div",{className:"text-center text-slate-400 mt-20",children:[e.jsx("div",{className:"mb-4 flex items-center justify-center",children:e.jsx(wt,{className:"w-16 h-16 text-slate-300"})}),e.jsx("div",{className:"text-xl font-medium mb-2",children:be.length===0?a?"Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m n√†o":"Ch∆∞a c√≥ s·∫£n ph·∫©m":S==="low"?"Kh√¥ng c√≥ s·∫£n ph·∫©m t·ªìn th·∫•p":"Kh√¥ng c√≥ s·∫£n ph·∫©m h·∫øt h√†ng"}),e.jsx("div",{className:"text-sm",children:be.length===0?a?"H√£y th·ª≠ m·ªôt t·ª´ kh√≥a t√¨m ki·∫øm kh√°c":"Vui l√≤ng th√™m s·∫£n ph·∫©m v√†o h·ªá th·ªëng":"H√£y ch·ªçn b·ªô l·ªçc kh√°c ƒë·ªÉ xem th√™m s·∫£n ph·∫©m"})]}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2.5 md:gap-3",children:vt.map(t=>{var N,T;const s=Number(((N=t.retailPrice)==null?void 0:N[k])??0),n=Number(((T=t.stock)==null?void 0:T[k])??0),d=n<=0,c=n>0&&n<=dt,x=ns.get(t.id),g=!!x;return e.jsx("div",{className:`group relative text-left p-2.5 md:p-3 rounded-xl border transition-all duration-200 h-full ${d?"bg-slate-100/50 dark:bg-slate-900/50 border-slate-200 dark:border-slate-800 opacity-60":"bg-white dark:bg-slate-800/70 border-slate-200/70 dark:border-slate-700 md:hover:border-blue-400 md:dark:hover:border-blue-500 md:hover:shadow-xl md:hover:-translate-y-0.5 md:cursor-pointer"} ${g?"ring-2 ring-blue-400 dark:ring-blue-500/60 shadow-md shadow-blue-500/20":""}`,onClick:()=>{window.innerWidth>=768&&!d&&Re(t)},children:e.jsxs("div",{className:"flex flex-col h-full",children:[g&&e.jsx("div",{className:"absolute -top-2.5 -right-2.5 z-10",children:e.jsx("span",{className:"flex items-center justify-center min-w-[28px] h-7 px-2 text-sm font-bold rounded-full bg-blue-500 text-white shadow-lg ring-2 ring-white dark:ring-slate-800",children:x==null?void 0:x.quantity})}),e.jsxs("div",{className:"mb-2 flex-1",children:[e.jsx("h3",{className:"font-semibold text-xs md:text-sm text-slate-900 dark:text-slate-100 line-clamp-2 leading-tight",title:t.name,children:t.name}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-1",children:[e.jsx("span",{className:"px-1.5 py-0.5 bg-slate-100 dark:bg-slate-700 rounded text-[10px] font-mono text-slate-500 dark:text-slate-400 truncate max-w-[100px]",children:t.sku}),t.category&&e.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-medium truncate max-w-[70px] ${Ae(t.category).bg} ${Ae(t.category).text}`,children:t.category})]})]}),e.jsxs("div",{className:"flex items-end justify-between pt-2 border-t border-slate-100 dark:border-slate-700/50",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-bold ${d?"text-slate-400 dark:text-slate-500":"text-blue-600 dark:text-blue-400"}`,children:m(s)}),e.jsxs("span",{className:`inline-flex items-center justify-center px-1.5 py-0.5 text-[10px] font-bold rounded ${d?"bg-rose-100 text-rose-600 dark:bg-rose-900/30 dark:text-rose-400":c?"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400":"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400"}`,children:["T·ªìn: ",Math.max(0,Math.floor(n))]})]}),e.jsx("button",{type:"button",onClick:ue=>{ue.stopPropagation(),d||Re(t)},disabled:d,className:`md:hidden w-9 h-9 rounded-lg flex items-center justify-center transition-all ${d?"bg-slate-100 dark:bg-slate-700 cursor-not-allowed":"bg-blue-500 text-white shadow-md active:scale-95"}`,children:d?e.jsx("span",{className:"text-slate-400 text-xs",children:"‚úï"}):e.jsx(Ts,{className:"w-5 h-5"})})]})]})},t.id)})})})]}),e.jsxs("div",{className:`w-full md:w-[40%] bg-white dark:bg-slate-800 md:border-l border-slate-200 dark:border-slate-700 flex flex-col transition-all duration-300 overflow-y-auto ${H!=="cart"?"hidden md:flex":"animate-fade-in"}`,children:[e.jsx("div",{className:"p-3 md:p-4 border-b border-slate-200 md:border-slate-200/50 dark:border-slate-700/50 bg-white dark:bg-slate-800 md:bg-gradient-to-r md:from-emerald-50/30 md:via-teal-50/20 md:to-cyan-50/30 dark:md:from-slate-800/50 dark:md:via-slate-800/30 dark:md:to-slate-800/50",children:e.jsxs("div",{className:"customer-dropdown-container",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold md:font-bold text-slate-900 dark:text-slate-100 mb-2 md:mb-3",children:[e.jsx("div",{className:"w-7 h-7 md:w-8 md:h-8 bg-emerald-500 md:bg-gradient-to-br md:from-emerald-500 md:to-teal-500 rounded-lg flex items-center justify-center md:shadow-lg",children:e.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),e.jsx("span",{children:"Kh√°ch h√†ng"})]}),e.jsxs("div",{className:"relative flex flex-col md:flex-row gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",placeholder:"T√¨m t√™n, s·ªë ƒëi·ªán tho·∫°i...",value:ce,onChange:t=>{ne(t.target.value),me(!0)},onFocus:()=>me(!0),onBlur:()=>{setTimeout(()=>me(!1),200)},className:"w-full pl-10 pr-4 py-2 md:py-2.5 border md:border-2 border-slate-300 md:border-slate-300/50 dark:border-slate-600/50 rounded-lg md:rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-all placeholder:text-slate-400"}),et&&e.jsx("div",{className:"absolute top-full left-0 right-0 z-50 mt-1 max-h-48 overflow-y-auto bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg shadow-lg",children:qt.length>0?qt.map(t=>e.jsxs("button",{onClick:()=>{xe(t),ne(t.name),me(!1)},className:"w-full text-left px-3 py-2.5 hover:bg-slate-50 dark:hover:bg-slate-600 border-b border-slate-100 dark:border-slate-600 last:border-b-0",children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-slate-100 text-sm",children:t.name}),t.phone&&e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:["üìû ",t.phone]})]},t.id)):e.jsx("div",{className:"px-3 py-3 text-center text-slate-500 dark:text-slate-400 text-sm",children:ce?e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Kh√¥ng t√¨m th·∫•y kh√°ch h√†ng"}),e.jsx("button",{onClick:()=>We(!0),className:"mt-2 text-emerald-500 hover:text-emerald-600 font-medium",children:"+ Th√™m kh√°ch h√†ng m·ªõi"})]}):A.length===0?e.jsx("div",{children:"Ch∆∞a c√≥ kh√°ch h√†ng n√†o"}):e.jsx("div",{children:"Nh·∫≠p t√™n ho·∫∑c SƒêT ƒë·ªÉ t√¨m..."})})})]}),e.jsxs("button",{onClick:()=>We(!0),className:"px-3 py-2 md:px-4 md:py-2.5 bg-emerald-500 md:bg-gradient-to-r md:from-emerald-500 md:to-teal-500 hover:bg-emerald-600 md:hover:from-emerald-600 md:hover:to-teal-600 text-white rounded-lg md:rounded-xl flex items-center justify-center gap-2 transition-all md:shadow-lg md:hover:shadow-xl md:hover:scale-105 md:active:scale-95 font-semibold md:font-bold",title:"Th√™m kh√°ch h√†ng m·ªõi",children:[e.jsx(Gt,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"hidden sm:inline text-sm",children:"Th√™m"})]})]}),z&&e.jsx("div",{className:"mt-2 md:mt-3 p-2 md:p-3.5 bg-emerald-50 dark:bg-emerald-900/20 md:bg-gradient-to-r md:from-emerald-50 md:to-teal-50 dark:md:from-emerald-900/20 dark:md:to-teal-900/20 rounded-lg md:rounded-xl border md:border-2 border-emerald-200 dark:border-emerald-800 md:shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-2.5 flex-1 min-w-0",children:[e.jsx("div",{className:"hidden md:flex w-10 h-10 bg-gradient-to-br from-emerald-500 to-teal-500 rounded-lg items-center justify-center shadow-lg flex-shrink-0",children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium md:font-bold text-emerald-900 dark:text-emerald-100 truncate text-sm md:text-base",children:z.name}),z.phone&&e.jsxs("div",{className:"text-xs text-emerald-700 dark:text-emerald-300 flex items-center gap-1 mt-0.5",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0 hidden md:inline",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),e.jsx("span",{className:"truncate",children:z.phone})]})]})]}),e.jsx("button",{onClick:()=>{xe(null),ne("")},className:"w-7 h-7 md:w-8 md:h-8 bg-red-100 dark:bg-red-900/30 hover:bg-red-200 dark:hover:bg-red-900/50 text-red-600 dark:text-red-400 rounded-md md:rounded-lg flex items-center justify-center transition-all flex-shrink-0 md:shadow-sm md:hover:shadow-md text-lg",title:"X√≥a",children:"√ó"})]})})]})}),e.jsxs("div",{className:"p-3 md:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 md:mb-4 pb-2 md:pb-3 border-b md:border-b-2 border-slate-200 md:border-slate-200/50 dark:border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"hidden md:flex w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-lg items-center justify-center shadow-lg",children:e.jsx(Nt,{className:"w-4 h-4 text-white"})}),e.jsx("h3",{className:"text-base md:text-lg font-semibold md:font-black text-slate-900 dark:text-slate-100",children:"Gi·ªè h√†ng"})]}),e.jsx("span",{className:"px-2 py-0.5 md:px-3 md:py-1 bg-blue-100 md:bg-gradient-to-r md:from-blue-100 md:to-indigo-100 dark:from-blue-900/30 dark:to-indigo-900/30 text-blue-700 dark:text-blue-300 rounded-full text-xs font-semibold md:font-bold md:shadow-sm",children:h.length})]}),h.length===0?e.jsxs("div",{className:"text-center py-12 md:py-16 mb-3",children:[e.jsx("div",{className:"mb-3 md:mb-4 flex items-center justify-center",children:e.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 bg-slate-100 md:bg-gradient-to-br md:from-slate-100 md:to-slate-200 dark:from-slate-800 dark:to-slate-700 rounded-2xl md:rounded-3xl flex items-center justify-center md:shadow-lg",children:e.jsx(Nt,{className:"w-8 h-8 md:w-10 md:h-10 text-slate-400 dark:text-slate-500"})})}),e.jsx("div",{className:"text-sm md:text-base font-semibold md:font-bold text-slate-600 dark:text-slate-400 mb-1",children:"Gi·ªè h√†ng tr·ªëng"}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-500",children:"Ch·ªçn s·∫£n ph·∫©m ƒë·ªÉ th√™m v√†o gi·ªè"})]}):e.jsx("div",{className:"space-y-1.5 md:space-y-2.5",children:h.map(t=>{const s=Q.find(n=>n.id===t.partId);return e.jsxs("div",{className:"group p-2 md:p-3 border md:border-2 border-slate-200 md:border-slate-200/50 dark:border-slate-700/50 rounded-lg md:rounded-xl bg-white dark:bg-slate-800 md:hover:border-blue-400 dark:hover:border-blue-600 transition-all duration-200 md:hover:shadow-lg md:hover:shadow-blue-500/10",children:[e.jsx("div",{className:"md:hidden",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-semibold text-sm text-slate-900 dark:text-slate-100 leading-tight truncate",title:t.partName,children:t.partName}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5 flex-wrap",children:[e.jsx("span",{className:"text-[11px] text-slate-500 dark:text-slate-400 font-mono",children:t.sku}),(s==null?void 0:s.category)&&e.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded-full text-[9px] font-medium ${Ae(s.category).bg} ${Ae(s.category).text}`,children:s.category})]}),e.jsx("div",{className:"text-sm font-bold text-blue-600 dark:text-blue-400 mt-0.5",children:m(t.sellingPrice)})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx("button",{onClick:()=>Ve(t.partId,t.quantity-1),className:"w-7 h-7 flex items-center justify-center bg-slate-100 dark:bg-slate-700 rounded-md text-slate-700 dark:text-slate-300 hover:bg-red-100 dark:hover:bg-red-900/30 hover:text-red-500 transition-all font-bold text-base",children:"-"}),e.jsx("span",{className:"w-7 text-center font-bold text-xs text-slate-900 dark:text-slate-100",children:t.quantity}),e.jsx("button",{onClick:()=>Ve(t.partId,t.quantity+1),className:"w-7 h-7 flex items-center justify-center bg-blue-500 dark:bg-blue-600 rounded-md text-white hover:bg-blue-600 dark:hover:bg-blue-700 transition-all font-bold text-base",children:"+"})]})]})}),e.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-orange-100 to-amber-100 dark:from-orange-900/30 dark:to-amber-900/30 rounded-xl flex items-center justify-center flex-shrink-0 shadow-sm group-hover:scale-110 transition-transform",children:e.jsx(wt,{className:"w-6 h-6 text-orange-500 dark:text-orange-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-bold text-sm text-slate-900 dark:text-slate-100 line-clamp-1 mb-0.5",title:t.partName,children:t.partName}),e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx("span",{className:"px-1.5 py-0.5 bg-slate-100 dark:bg-slate-700 rounded text-[10px] text-slate-500 dark:text-slate-400 font-semibold",children:t.sku}),(s==null?void 0:s.category)&&e.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-medium ${Ae(s.category).bg} ${Ae(s.category).text}`,children:s.category})]}),e.jsx("div",{className:"text-sm font-black bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-blue-400 dark:to-indigo-400 bg-clip-text text-transparent",children:m(t.sellingPrice)})]}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[e.jsx("button",{onClick:()=>Ve(t.partId,t.quantity-1),className:"w-8 h-8 flex items-center justify-center bg-gradient-to-r from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-600 rounded-lg text-slate-700 dark:text-slate-300 hover:from-red-100 hover:to-red-200 dark:hover:from-red-900/30 dark:hover:to-red-800/30 hover:text-red-500 transition-all shadow-sm hover:shadow-md font-bold",children:"-"}),e.jsx("span",{className:"w-10 text-center font-black text-sm text-slate-900 dark:text-slate-100 px-2 py-1 bg-slate-50 dark:bg-slate-700 rounded-lg",children:t.quantity}),e.jsx("button",{onClick:()=>Ve(t.partId,t.quantity+1),className:"w-8 h-8 flex items-center justify-center bg-gradient-to-r from-blue-500 to-indigo-500 dark:from-blue-600 dark:to-indigo-600 rounded-lg text-white hover:from-blue-600 hover:to-indigo-600 dark:hover:from-blue-700 dark:hover:to-indigo-700 transition-all shadow-md hover:shadow-lg font-bold",children:"+"})]})]})]},t.partId)})})]}),h.length>0&&e.jsxs("div",{className:"border-t md:border-t-2 border-slate-200 md:border-slate-200/50 dark:border-slate-700/50 bg-slate-50 dark:bg-slate-800 md:bg-gradient-to-br md:from-slate-50 md:to-blue-50/30 dark:md:from-slate-800 dark:md:to-slate-800/50",children:[e.jsxs("div",{className:"p-3 md:p-4 space-y-2 md:space-y-3 pb-20 md:pb-3",children:[e.jsxs("div",{className:"flex justify-between text-xs md:text-sm",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400 font-medium",children:"T·ªïng ti·ªÅn h√†ng"}),e.jsx("span",{className:"font-semibold md:font-bold text-slate-900 dark:text-slate-100",children:m(ge)})]}),e.jsxs("div",{className:"space-y-2 md:space-y-2.5",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between text-xs md:text-sm gap-1.5 md:gap-2",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400 font-medium",children:"Gi·∫£m gi√°:"}),e.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2 w-full md:w-auto",children:[e.jsx("input",{type:"number",value:Ie==="amount"?p:Mt,onChange:t=>{const s=Number(t.target.value)||0;if(Ie==="amount")I(Math.min(s,ge));else{const n=Math.min(s,100);tt(n),I(Math.round(ge*n/100))}},className:"flex-1 md:w-24 px-2 md:px-3 py-1.5 md:py-2 text-right text-xs md:text-sm border md:border-2 border-slate-300 md:border-slate-300 dark:border-slate-600 rounded-lg md:rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all font-medium md:font-semibold",placeholder:"0",min:"0",max:Ie==="amount"?ge:100}),e.jsxs("select",{value:Ie,onChange:t=>{const s=t.target.value;Tt(s),I(0),tt(0)},className:"px-2 md:px-3 py-1.5 md:py-2 border md:border-2 border-slate-300 md:border-slate-300 dark:border-slate-600 rounded-lg md:rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-xs md:text-sm font-semibold md:font-bold focus:ring-2 focus:ring-purple-500 transition-all",children:[e.jsx("option",{value:"amount",children:"‚Ç´"}),e.jsx("option",{value:"percent",children:"%"})]})]})]}),Ie==="percent"&&e.jsx("div",{className:"flex gap-1.5 md:gap-2 justify-end flex-wrap",children:[5,10,15,20].map(t=>e.jsxs("button",{onClick:()=>{tt(t),I(Math.round(ge*t/100))},className:"px-2 md:px-3 py-1 md:py-1.5 text-[10px] md:text-xs font-semibold md:font-bold bg-purple-100 md:bg-gradient-to-r md:from-purple-100 md:to-pink-100 dark:from-purple-900/30 dark:to-pink-900/30 hover:bg-purple-200 md:hover:from-purple-200 md:hover:to-pink-200 dark:hover:from-purple-900/50 dark:hover:to-pink-900/50 text-purple-700 dark:text-purple-300 rounded-md md:rounded-lg transition-all md:shadow-sm md:hover:shadow-md",children:[t,"%"]},t))}),Ie==="percent"&&Mt>0&&e.jsxs("div",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400 text-right",children:["= ",m(p)]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 md:pt-3 mt-2 md:mt-3 border-t md:border-t-2 border-slate-200 dark:border-slate-700 p-2 md:p-3 -mx-3 md:-mx-4 bg-blue-600 md:bg-gradient-to-r md:from-blue-600 md:to-indigo-600 dark:from-blue-700 dark:to-indigo-700 rounded-b-lg md:rounded-b-xl md:shadow-lg",children:[e.jsx("span",{className:"font-semibold md:font-bold text-white text-xs md:text-sm",children:"Kh√°ch ph·∫£i tr·∫£"}),e.jsx("span",{className:"font-black text-lg md:text-2xl text-white",children:m(Math.max(0,Bt-p))})]})]}),e.jsxs("div",{className:"px-3 md:px-4 pb-3 md:pb-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs md:text-sm font-semibold md:font-bold text-slate-900 dark:text-slate-100 mb-2 md:mb-3",children:[e.jsx("span",{children:"Ph∆∞∆°ng th·ª©c thanh to√°n"}),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 md:gap-3",children:[e.jsxs("button",{onClick:()=>gt("cash"),className:`flex items-center justify-center gap-1.5 md:gap-2 px-3 md:px-4 py-2 md:py-3 rounded-lg md:rounded-xl border md:border-2 transition-all font-semibold md:font-bold md:shadow-sm md:hover:shadow-md ${de==="cash"?"border-emerald-600 bg-emerald-500 text-white dark:bg-emerald-600 dark:text-white md:shadow-lg":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:border-emerald-400"}`,children:[e.jsx(Rt,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"text-xs md:text-sm",children:"Ti·ªÅn m·∫∑t"})]}),e.jsxs("button",{onClick:()=>gt("bank"),className:`flex items-center justify-center gap-1.5 md:gap-2 px-3 md:px-4 py-2 md:py-3 rounded-lg md:rounded-xl border md:border-2 transition-all font-semibold md:font-bold md:shadow-sm md:hover:shadow-md ${de==="bank"?"border-blue-600 bg-blue-500 text-white dark:bg-blue-600 dark:text-white md:shadow-lg":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:border-blue-400"}`,children:[e.jsx(Qt,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"text-xs md:text-sm",children:"Chuy·ªÉn kho·∫£n"})]})]})]}),de&&e.jsxs("div",{className:"px-3 md:px-4 pb-3 md:pb-4",children:[e.jsx("label",{className:"block text-xs md:text-sm font-semibold md:font-bold text-slate-900 dark:text-slate-100 mb-2 md:mb-3",children:"H√¨nh th·ª©c"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1.5 md:gap-2",children:[e.jsx("button",{onClick:()=>{rt("full"),lt(0)},className:`px-2 md:px-3 py-2 md:py-2.5 text-xs md:text-sm rounded-lg md:rounded-xl border md:border-2 transition-all font-bold md:shadow-sm ${F==="full"?"border-orange-600 bg-orange-500 text-white dark:bg-orange-600 dark:text-white md:shadow-lg":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-600 dark:text-slate-400 hover:border-orange-400"}`,children:"ƒê·ªß"}),e.jsx("button",{onClick:()=>rt("partial"),className:`px-2 md:px-3 py-2 md:py-2.5 text-xs md:text-sm rounded-lg md:rounded-xl border md:border-2 transition-all font-bold md:shadow-sm ${F==="partial"?"border-orange-600 bg-orange-500 text-white dark:bg-orange-600 dark:text-white md:shadow-lg":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-600 dark:text-slate-400 hover:border-orange-400"}`,children:"1 ph·∫ßn"}),e.jsx("button",{onClick:()=>{rt("note"),lt(0)},className:`px-2 md:px-3 py-2 md:py-2.5 text-xs md:text-sm rounded-lg md:rounded-xl border md:border-2 transition-all font-bold md:shadow-sm ${F==="note"?"border-orange-600 bg-orange-500 text-white dark:bg-orange-600 dark:text-white md:shadow-lg":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-600 dark:text-slate-400 hover:border-orange-400"}`,children:"Ghi n·ª£"})]})]}),F==="partial"&&e.jsxs("div",{className:"px-4 pb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-900 dark:text-slate-100 mb-2",children:"S·ªë ti·ªÅn kh√°ch tr·∫£"}),e.jsx("input",{type:"number",value:Be,onChange:t=>lt(Number(t.target.value)||0),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",placeholder:"0"}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["C√≤n l·∫°i:"," ",m(Math.max(0,Bt-p-Be))," ","ƒë"]})]}),e.jsxs("div",{className:"px-3 md:px-4 pb-3 md:pb-3 space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 dark:text-slate-400 mb-2",children:"Th·ªùi gian b√°n h√†ng"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>It(!0),className:`flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg border transition-all font-semibold ${ut?"border-blue-500 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:border-blue-400"}`,children:e.jsx("span",{className:"text-xs",children:"üïê Hi·ªán t·∫°i"})}),e.jsx("button",{type:"button",onClick:()=>It(!1),className:`flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg border transition-all font-semibold ${ut?"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:border-blue-400":"border-blue-500 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400"}`,children:e.jsx("span",{className:"text-xs",children:"üìÖ T√πy ch·ªânh"})})]}),!ut&&e.jsx("input",{type:"datetime-local",value:es,onChange:t=>ts(t.target.value),className:"mt-2 w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>Jt(!pt),className:`flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg border transition-all font-semibold ${pt?"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:border-emerald-400"}`,children:e.jsx("span",{className:"text-xs",children:"üìù Ghi ch√∫"})}),e.jsx("button",{type:"button",onClick:()=>Zt(!bt),className:`flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg border transition-all font-semibold ${bt?"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:border-emerald-400"}`,children:e.jsx("span",{className:"text-xs",children:"üñ®Ô∏è In ho√° ƒë∆°n"})})]}),pt&&e.jsx("textarea",{value:ss,onChange:t=>as(t.target.value),placeholder:"Nh·∫≠p ghi ch√∫ cho ƒë∆°n h√†ng...",rows:3,className:"w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 placeholder-slate-400 dark:placeholder-slate-500 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 resize-none"})]}),e.jsxs("div",{className:"p-3 md:p-4 pt-0 flex flex-col md:flex-row gap-2 md:gap-3",children:[e.jsx("button",{onClick:W,className:"flex-1 px-3 md:px-4 py-2 md:py-3 bg-white dark:bg-slate-700 border md:border-2 border-slate-300 dark:border-slate-600 hover:border-slate-400 dark:hover:border-slate-500 hover:bg-slate-50 dark:hover:bg-slate-600 text-slate-700 dark:text-slate-300 font-semibold md:font-bold rounded-lg md:rounded-xl transition-all md:shadow-sm md:hover:shadow-md text-sm md:text-base",children:"L∆ØU NH√ÅP"}),e.jsx("button",{onClick:ks,disabled:!de||!F,className:`flex-1 px-3 md:px-4 py-2 md:py-3 font-bold md:font-black rounded-lg md:rounded-xl transition-all md:shadow-lg text-sm md:text-base ${de&&F?"bg-orange-500 md:bg-gradient-to-r md:from-orange-500 md:to-red-500 hover:bg-orange-600 md:hover:from-orange-600 md:hover:to-red-600 text-white md:shadow-orange-500/30 md:hover:shadow-xl md:hover:shadow-orange-500/40 md:hover:scale-105 md:active:scale-95":"bg-slate-300 dark:bg-slate-700 text-slate-500 dark:text-slate-500 cursor-not-allowed opacity-60"}`,children:"XU·∫§T B√ÅN"})]})]})]})]}),e.jsx(As,{isOpen:Xt,onClose:()=>{st(!1),H==="history"&&ye("products")},sales:le,currentBranchId:k,onPrintReceipt:hs,onEditSale:ps,onDeleteSale:us,page:l.page,totalPages:l.totalPages,total:l.total,hasMore:l.hasMore,pageSize:ke,onPrevPage:ve,onNextPage:()=>{var t,s;if(_){const n=(t=C==null?void 0:C.meta)==null?void 0:t.nextAfterDate,d=(s=C==null?void 0:C.meta)==null?void 0:s.nextAfterId;(n||d)&&Y({afterDate:n,afterId:d})}else B()},onPageSizeChange:xt,search:Te,onSearchChange:t=>{Me(t),t||R(1)},fromDate:De,toDate:X,onDateRangeChange:(t,s)=>{je(t),J(s),R(1),_&&Y(null)},status:ae,onStatusChange:t=>{V(t),R(1),_&&Y(null)},paymentMethodFilter:ie,onPaymentMethodFilterChange:t=>{te(t),R(1),_&&Y(null)},keysetMode:_,onToggleKeyset:t=>{re(t),R(1),Y(null)},customerDebts:Xe}),Lt&&e.jsx("div",{id:"last-receipt",className:"hidden print:block",children:e.jsxs("div",{style:{width:"148mm",minHeight:"210mm",margin:"0 auto",padding:"15mm",fontFamily:"Arial, sans-serif",fontSize:"12px",backgroundColor:"white",color:"#000",boxSizing:"border-box"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"15px",marginBottom:"20px",borderBottom:"2px solid #333",paddingBottom:"15px"},children:[e.jsx("img",{src:(i==null?void 0:i.logo_url)||"https://raw.githubusercontent.com/Nhan-Lam-SmartCare/Motocare/main/public/logo.png",alt:"Logo",style:{width:"60px",height:"60px",objectFit:"contain",flexShrink:0},onError:t=>{t.currentTarget.style.display="none"}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h1",{style:{fontSize:"18px",fontWeight:"bold",margin:"0 0 5px 0",color:"#1e40af"},children:(i==null?void 0:i.store_name)||"Nh·∫°n-L√¢m SmartCare"}),e.jsxs("div",{style:{fontSize:"11px",lineHeight:"1.5"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"4px"},children:[e.jsx("svg",{style:{width:"12px",height:"12px",flexShrink:0,marginTop:"2px"},viewBox:"0 0 24 24",fill:"#ef4444",children:e.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})}),e.jsx("span",{children:(i==null?void 0:i.address)||"·∫§p Ph√∫ L·ª£i B, Ph√∫ Thu·∫≠n B, H·ªìng Ng·ª±, ƒê·ªìng Th√°p"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx("svg",{style:{width:"12px",height:"12px",flexShrink:0},viewBox:"0 0 24 24",fill:"#16a34a",children:e.jsx("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})}),e.jsx("span",{children:(i==null?void 0:i.phone)||"0947-747-907"})]})]})]})]}),(i==null?void 0:i.bank_name)&&e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",backgroundColor:"#f0f9ff",border:"1px solid #dee2e6",borderRadius:"6px",padding:"10px 12px",marginBottom:"20px",fontSize:"11px"},children:[e.jsxs("div",{style:{flex:1,lineHeight:"1.5"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"3px",color:"#1e40af",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx("svg",{style:{width:"12px",height:"12px",flexShrink:0},viewBox:"0 0 24 24",fill:"#0891b2",children:e.jsx("path",{d:"M4 10h3v7H4zm6.5 0h3v7h-3zM2 19h20v3H2zm15-9h3v7h-3zm-5-9L2 6v2h20V6z"})}),e.jsx("span",{children:"Th√¥ng tin chuy·ªÉn kho·∫£n:"})]}),e.jsxs("div",{children:["‚Ä¢ Ng√¢n h√†ng: ",e.jsx("strong",{children:i.bank_name})]}),i.bank_account_number&&e.jsxs("div",{children:["‚Ä¢ S·ªë t√†i kho·∫£n:"," ",e.jsx("strong",{style:{color:"#2563eb"},children:i.bank_account_number})]}),i.bank_account_holder&&e.jsxs("div",{children:["‚Ä¢ Ch·ªß t√†i kho·∫£n:"," ",e.jsx("strong",{children:i.bank_account_holder})]})]}),i.bank_qr_url&&e.jsx("div",{style:{flexShrink:0},children:e.jsx("img",{src:i.bank_qr_url,alt:"QR Banking",style:{width:"50px",height:"50px",objectFit:"contain"}})})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:"15px"},children:[e.jsx("h2",{style:{fontSize:"18px",fontWeight:"bold",margin:"0 0 8px 0",textTransform:"uppercase",letterSpacing:"1px"},children:"H√ìA ƒê∆†N B√ÅN H√ÄNG"}),e.jsxs("div",{style:{fontSize:"11px",color:"#666"},children:["S·ªë: ",e.jsx("strong",{style:{color:"#000"},children:Lt})," - Ng√†y:"," ",e.jsx("strong",{style:{color:"#000"},children:ot(new Date,!0)})]})]}),e.jsx("div",{style:{marginBottom:"15px",padding:"10px",backgroundColor:"#f8f9fa",borderRadius:"4px"},children:e.jsxs("div",{style:{fontSize:"12px",lineHeight:"1.8"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Kh√°ch h√†ng:"})," ",_e||"Kh√°ch l·∫ª"]}),he&&e.jsxs("div",{children:[e.jsx("strong",{children:"ƒêi·ªán tho·∫°i:"})," ",he]})]})}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"15px",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f1f3f5",borderTop:"2px solid #333",borderBottom:"2px solid #333"},children:[e.jsx("th",{style:{textAlign:"center",padding:"8px 4px",width:"8%",fontWeight:"bold"},children:"STT"}),e.jsx("th",{style:{textAlign:"left",padding:"8px 6px",width:"37%",fontWeight:"bold"},children:"T√™n s·∫£n ph·∫©m"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 4px",width:"10%",fontWeight:"bold"},children:"SL"}),e.jsx("th",{style:{textAlign:"right",padding:"8px 6px",width:"20%",fontWeight:"bold"},children:"ƒê∆°n gi√°"}),e.jsx("th",{style:{textAlign:"right",padding:"8px 6px",width:"25%",fontWeight:"bold"},children:"Th√†nh ti·ªÅn"})]})}),e.jsx("tbody",{children:Oe.map((t,s)=>e.jsx(Vt.Fragment,{children:e.jsxs("tr",{style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("td",{style:{textAlign:"center",padding:"10px 4px",verticalAlign:"top"},children:s+1}),e.jsxs("td",{style:{padding:"10px 6px",verticalAlign:"top"},children:[e.jsx("div",{style:{fontWeight:"600",marginBottom:"3px"},children:t.partName}),t.sku&&e.jsxs("div",{style:{fontSize:"9px",color:"#868e96"},children:["SKU: ",t.sku]})]}),e.jsx("td",{style:{textAlign:"center",padding:"10px 4px",verticalAlign:"top",fontWeight:"600"},children:t.quantity}),e.jsx("td",{style:{textAlign:"right",padding:"10px 6px",verticalAlign:"top"},children:m(t.sellingPrice)}),e.jsx("td",{style:{textAlign:"right",padding:"10px 6px",verticalAlign:"top",fontWeight:"600"},children:m(t.sellingPrice*t.quantity)})]})},t.partId))})]}),e.jsx("div",{style:{borderTop:"2px solid #333",paddingTop:"12px",marginBottom:"15px"},children:e.jsx("table",{style:{width:"100%",fontSize:"12px"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsxs("td",{style:{padding:"6px 0",textAlign:"right"},children:["T·ªïng c·ªông (",os," s·∫£n ph·∫©m):"]}),e.jsx("td",{style:{padding:"6px 0 6px 20px",textAlign:"right",width:"30%",fontWeight:"600"},children:m(jt)})]}),at>0&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 0",textAlign:"right",color:"#c92a2a"},children:"Gi·∫£m gi√°:"}),e.jsxs("td",{style:{padding:"6px 0 6px 20px",textAlign:"right",fontWeight:"600",color:"#c92a2a"},children:["-",m(at)]})]}),e.jsxs("tr",{style:{borderTop:"1px solid #dee2e6",fontSize:"14px"},children:[e.jsx("td",{style:{padding:"10px 0",textAlign:"right",fontWeight:"bold"},children:"T·ªîNG THANH TO√ÅN:"}),e.jsx("td",{style:{padding:"10px 0 10px 20px",textAlign:"right",fontWeight:"bold",fontSize:"16px",color:"#2f9e44"},children:m(ds)})]})]})})}),e.jsxs("div",{style:{marginBottom:"20px",padding:"10px 12px",backgroundColor:"#f8f9fa",borderRadius:"4px",fontSize:"11px"},children:[e.jsxs("div",{style:{marginBottom:"4px"},children:[e.jsx("strong",{children:"H√¨nh th·ª©c thanh to√°n:"})," ",de==="cash"?"Ti·ªÅn m·∫∑t":"Chuy·ªÉn kho·∫£n"]}),e.jsx("div",{style:{fontStyle:"italic",color:"#495057"},children:F==="full"?"‚úì ƒê√£ thanh to√°n ƒë·ªß":F==="partial"?`Thanh to√°n m·ªôt ph·∫ßn: ${m(Be)}`:"Ghi n·ª£"})]}),e.jsx("div",{style:{marginTop:"30px",borderTop:"1px solid #dee2e6",paddingTop:"20px"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"11px"},children:[e.jsxs("div",{style:{textAlign:"center",width:"40%"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"50px",fontSize:"12px"},children:"Kh√°ch h√†ng"}),e.jsx("div",{style:{fontStyle:"italic",color:"#868e96"},children:"(K√Ω v√† ghi r√µ h·ªç t√™n)"})]}),e.jsxs("div",{style:{textAlign:"center",width:"40%"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"50px",fontSize:"12px"},children:"Ng∆∞·ªùi b√°n h√†ng"}),e.jsx("div",{style:{fontStyle:"italic",color:"#868e96"},children:"(K√Ω v√† ghi r√µ h·ªç t√™n)"})]})]})}),e.jsxs("div",{style:{textAlign:"center",marginTop:"25px",paddingTop:"15px",borderTop:"1px dashed #adb5bd",fontSize:"11px",fontStyle:"italic",color:"#495057"},children:[e.jsxs("div",{style:{marginBottom:"5px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[e.jsx("span",{style:{display:"inline-flex"},children:"*"}),"C·∫£m ∆°n qu√Ω kh√°ch ƒë√£ s·ª≠ d·ª•ng d·ªãch v·ª•",e.jsx("span",{style:{display:"inline-flex"},children:"*"})]}),e.jsx("div",{children:"H·∫πn g·∫∑p l·∫°i qu√Ω kh√°ch!"})]})]})}),Yt&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Th√™m kh√°ch h√†ng m·ªõi"}),e.jsx("button",{onClick:()=>{We(!1),we({name:"",phone:"",vehicleModel:"",licensePlate:""})},className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200",children:e.jsx(Ut,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:["T√™n kh√°ch h√†ng ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:E.name,onChange:t=>we({...E,name:t.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500",placeholder:"Nh·∫≠p t√™n kh√°ch h√†ng"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:["S·ªë ƒëi·ªán tho·∫°i ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",value:E.phone,onChange:t=>we({...E,phone:t.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500",placeholder:"Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"D√≤ng xe"}),e.jsx("input",{type:"text",value:E.vehicleModel,onChange:t=>we({...E,vehicleModel:t.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500",placeholder:"VD: Honda SH 2023"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Bi·ªÉn s·ªë xe"}),e.jsx("input",{type:"text",value:E.licensePlate,onChange:t=>we({...E,licensePlate:t.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500",placeholder:"VD: 30A-12345"})]})]}),e.jsxs("div",{className:"flex gap-2 p-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("button",{onClick:()=>{We(!1),we({name:"",phone:"",vehicleModel:"",licensePlate:""})},className:"flex-1 px-4 py-2 bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-600",children:"H·ªßy"}),e.jsx("button",{onClick:ms,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"L∆∞u"})]})]})}),rs&&v&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 px-6 py-4 flex items-center justify-between rounded-t-xl flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"Xem tr∆∞·ªõc h√≥a ƒë∆°n"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:gs,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg flex items-center gap-2 transition",title:"Chia s·∫ª / T·∫£i ·∫£nh",children:[e.jsx(Ms,{className:"w-4 h-4"}),"Chia s·∫ª"]}),e.jsxs("button",{onClick:bs,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center gap-2 transition",children:[e.jsx(Ls,{className:"w-4 h-4"}),"In h√≥a ƒë∆°n"]}),e.jsx("button",{onClick:()=>{ft(!1),kt(null)},className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300","aria-label":"ƒê√≥ng",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-100 dark:bg-slate-900",children:e.jsx("div",{ref:yt,className:"bg-white shadow-lg mx-auto",style:{width:"80mm",minHeight:"100mm",color:"#000"},children:e.jsxs("div",{style:{padding:"5mm"},children:[e.jsxs("div",{style:{borderBottom:"2px solid #3b82f6",paddingBottom:"2mm",marginBottom:"3mm",display:"flex",alignItems:"center",gap:"3mm"},children:[(i==null?void 0:i.logo_url)&&e.jsx("img",{src:i.logo_url,alt:"Logo",style:{height:"14mm",width:"14mm",objectFit:"contain",flexShrink:0}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"10pt",color:"#1e40af",marginBottom:"1mm"},children:(i==null?void 0:i.store_name)||"Nh·∫°n L√¢m SmartCare"}),(i==null?void 0:i.address)&&e.jsxs("div",{style:{fontSize:"7pt",color:"#000",display:"flex",alignItems:"flex-start",gap:"1mm",lineHeight:"1.3"},children:[e.jsx("svg",{style:{width:"8px",height:"8px",flexShrink:0,marginTop:"1px"},viewBox:"0 0 24 24",fill:"#ef4444",children:e.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})}),e.jsx("span",{children:i.address})]}),(i==null?void 0:i.phone)&&e.jsxs("div",{style:{fontSize:"7pt",color:"#000",display:"flex",alignItems:"center",gap:"1mm"},children:[e.jsx("svg",{style:{width:"8px",height:"8px",flexShrink:0},viewBox:"0 0 24 24",fill:"#16a34a",children:e.jsx("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})}),e.jsx("span",{children:i.phone})]})]})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:"3mm"},children:[e.jsx("h1",{style:{fontSize:"14pt",fontWeight:"bold",margin:"0",color:"#1e40af"},children:"H√ìA ƒê∆†N B√ÅN H√ÄNG"}),e.jsx("div",{style:{fontSize:"8pt",color:"#666",marginTop:"1mm"},children:new Date(v.date).toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}),e.jsxs("div",{style:{fontSize:"8pt",fontWeight:"bold",marginTop:"0.5mm"},children:["M√£: ",Ee(v.id)||v.id]})]}),e.jsxs("div",{style:{border:"1px solid #ddd",padding:"2mm",marginBottom:"3mm",borderRadius:"2mm",backgroundColor:"#f8fafc",fontSize:"8.5pt"},children:[e.jsxs("div",{style:{marginBottom:"1mm"},children:[e.jsx("span",{style:{fontWeight:"bold"},children:"KH:"})," ",v.customer.name]}),v.customer.phone&&e.jsxs("div",{children:[e.jsx("span",{style:{fontWeight:"bold"},children:"SƒêT:"})," ",v.customer.phone]})]}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"3mm",fontSize:"8.5pt"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid #ddd"},children:[e.jsx("th",{style:{textAlign:"left",padding:"1mm",fontSize:"8pt"},children:"S·∫£n ph·∫©m"}),e.jsx("th",{style:{textAlign:"center",padding:"1mm",width:"15%",fontSize:"8pt"},children:"SL"}),e.jsx("th",{style:{textAlign:"right",padding:"1mm",width:"28%",fontSize:"8pt"},children:"Th√†nh ti·ªÅn"})]})}),e.jsx("tbody",{children:v.items.map((t,s)=>{const n=t.sellingPrice||t.sellingprice||t.price||0,d=t.quantity||0;return e.jsxs("tr",{style:{borderBottom:"1px dashed #ddd"},children:[e.jsx("td",{style:{padding:"1.5mm 1mm",fontSize:"8.5pt"},children:t.partName||t.partname}),e.jsx("td",{style:{textAlign:"center",padding:"1.5mm 1mm",fontSize:"8.5pt"},children:d}),e.jsx("td",{style:{textAlign:"right",padding:"1.5mm 1mm",fontSize:"8.5pt",fontWeight:"bold"},children:m(n*d)})]},s)})})]}),e.jsxs("div",{style:{borderTop:"2px solid #333",paddingTop:"2mm",marginBottom:"3mm",fontSize:"9pt"},children:[v.discount>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1mm",color:"#e74c3c"},children:[e.jsx("span",{children:"Gi·∫£m gi√°:"}),e.jsxs("span",{children:["-",m(v.discount)]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:"bold",fontSize:"11pt"},children:[e.jsx("span",{children:"T·ªîNG C·ªòNG:"}),e.jsxs("span",{style:{color:"#2563eb"},children:[m(v.total)," ‚Ç´"]})]})]}),(i==null?void 0:i.bank_name)&&e.jsx("div",{style:{marginTop:"2mm",border:"1px solid #ddd",padding:"2mm",borderRadius:"2mm",backgroundColor:"#f0f9ff",fontSize:"7.5pt"},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"2mm"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"1mm",color:"#1e40af",fontSize:"8pt"},children:["Chuy·ªÉn kho·∫£n: ",i.bank_name]}),i.bank_account_number&&e.jsxs("div",{style:{color:"#2563eb",fontWeight:"bold"},children:["STK: ",i.bank_account_number]}),i.bank_account_holder&&e.jsx("div",{children:i.bank_account_holder})]}),i.bank_qr_url&&e.jsx("div",{style:{flexShrink:0},children:e.jsx("img",{src:i.bank_qr_url,alt:"QR Banking",style:{height:"18mm",width:"18mm",objectFit:"contain"}})})]})}),e.jsxs("div",{style:{textAlign:"center",fontSize:"7.5pt",color:"#666",borderTop:"1px dashed #999",paddingTop:"2mm"},children:[e.jsx("div",{children:"C·∫£m ∆°n qu√Ω kh√°ch!"}),e.jsx("div",{children:"H·∫πn g·∫∑p l·∫°i"})]})]})})})]})}),e.jsx(Ss,{isOpen:Ze,onClose:()=>Je(!1),onScan:cs,title:"Qu√©t m√£ v·∫°ch s·∫£n ph·∫©m"})]})};export{Gs as default};
