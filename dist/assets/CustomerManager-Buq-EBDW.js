import{c as G,b as se,d as ae,a2 as le,r as n,a3 as re,a4 as ne,j as e,a5 as de,O as oe,l as F,i as B,m as ie,a6 as ce,s as J}from"./index-9wxNecOd.js";import{a as xe}from"./validation-CmPBxZwi.js";import{U as he,P as K,T as Z,X}from"./Icons-Dya5WI08.js";import{u as me}from"./useWorkOrdersRepository-D2Ec2NwQ.js";import{B as E,C as be}from"./cog-DDnvKWbr.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=G("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=G("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=G("Wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]]),fe=({isOpen:a,onClose:f,customer:x,sales:b,workOrders:h})=>{const[m,y]=n.useState("sales");if(!a||!x)return null;const u=b.filter(s=>{var r,c;return((r=s.customer)==null?void 0:r.id)===x.id||((c=s.customer)==null?void 0:c.phone)===x.phone}),d=h.filter(s=>s.customerPhone===x.phone),C=u.reduce((s,r)=>s+(r.total||0),0),o=d.reduce((s,r)=>s+(r.total||0),0),g=C+o,T=[...u.map(s=>new Date(s.date).toDateString()),...d.map(s=>new Date(s.creationDate||s.id).toDateString())],w=new Set(T).size,S=Math.floor(g/1e4);return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[70] p-0 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg w-full max-h-[90vh] overflow-hidden flex flex-col shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:["Lá»‹ch sá»­: ",x.name]}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:["ðŸ“ž ",x.phone]})]}),e.jsx("button",{onClick:f,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx(X,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3 p-4 bg-slate-50 dark:bg-slate-900/50 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:u.length}),e.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"HÃ³a Ä‘Æ¡n"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:d.length}),e.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Phiáº¿u SC"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold text-purple-600 dark:text-purple-400",children:B(g)}),e.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Tá»•ng chi"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold text-orange-600 dark:text-orange-400",children:w}),e.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Láº§n Ä‘áº¿n"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xl font-bold text-yellow-600 dark:text-yellow-400",children:["â­ ",S.toLocaleString()]}),e.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Äiá»ƒm TL"})]})]}),e.jsxs("div",{className:"flex gap-3 px-4 pt-3 border-b border-slate-200 dark:border-slate-700 overflow-x-auto no-scrollbar",children:[e.jsxs("button",{onClick:()=>y("sales"),className:`px-3 py-1.5 font-medium text-sm transition-colors ${m==="sales"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100"}`,children:["ðŸ›’ HÃ³a Ä‘Æ¡n (",u.length,")"]}),e.jsxs("button",{onClick:()=>y("workorders"),className:`px-3 py-1.5 font-medium text-sm transition-colors ${m==="workorders"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100"}`,children:["ðŸ”§ Phiáº¿u sá»­a chá»¯a (",d.length,")"]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-6 custom-scrollbar",children:m==="sales"?e.jsx("div",{className:"space-y-3",children:u.length===0?e.jsx("div",{className:"text-center py-12 text-slate-500",children:"ChÆ°a cÃ³ hÃ³a Ä‘Æ¡n nÃ o"}):u.map(s=>e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg p-4 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-blue-600 dark:text-blue-400",children:s.sale_code||s.id}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:F(s.date)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:B(s.total)}),e.jsx("div",{className:"text-xs text-slate-500",children:s.paymentMethod==="cash"?"ðŸ’µ Tiá»n máº·t":"ðŸ¦ CK"})]})]}),e.jsx("div",{className:"space-y-1",children:s.items.map((r,c)=>e.jsxs("div",{className:"text-sm text-slate-700 dark:text-slate-300 flex justify-between",children:[e.jsxs("span",{children:[r.quantity," x ",r.partName]}),e.jsx("span",{className:"font-medium",children:B(r.quantity*r.sellingPrice)})]},c))})]},s.id))}):e.jsx("div",{className:"space-y-3",children:d.length===0?e.jsx("div",{className:"text-center py-12 text-slate-500",children:"ChÆ°a cÃ³ phiáº¿u sá»­a chá»¯a nÃ o"}):d.map(s=>{const r=s.status==="Tráº£ mÃ¡y"||s.status==="ÄÃ£ sá»­a xong",c=s.status==="Äang sá»­a",$=r?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":c?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-slate-100 text-slate-700 dark:bg-slate-700 dark:text-slate-300",M=r?"HoÃ n thÃ nh":c?"Äang SC":"Chá» xá»­ lÃ½";return e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg p-4 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-green-600 dark:text-green-400",children:ie(s.id)}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:[s.vehicleModel," - ",s.licensePlate]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:B(s.total)}),e.jsx("div",{className:`text-xs px-2 py-1 rounded inline-block ${$}`,children:M})]})]}),e.jsxs("div",{className:"text-sm text-slate-700 dark:text-slate-300",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Váº¥n Ä‘á»:"})," ",s.issueDescription]}),s.partsUsed&&s.partsUsed.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Phá»¥ tÃ¹ng:"}),e.jsx("div",{className:"ml-4 space-y-1 mt-1",children:s.partsUsed.map((P,H)=>e.jsxs("div",{className:"text-xs flex justify-between",children:[e.jsxs("span",{children:[P.quantity," x ",P.name]}),e.jsx("span",{children:B(P.price*P.quantity)})]},H))})]})]})]},s.id)})})}),e.jsx("div",{className:"p-4 border-t border-slate-200 dark:border-slate-700 flex justify-end",children:e.jsx("button",{onClick:f,className:"px-4 py-2 bg-slate-600 hover:bg-slate-700 text-white rounded-lg transition-colors",children:"ÄÃ³ng"})})]})})},ke=a=>{const f=a.loyaltyPoints||0,x=a.totalSpent||0,b=a.visitCount||0,h=a.lastVisit?new Date(a.lastVisit):new Date,m=Math.floor((Date.now()-h.getTime())/(1e3*60*60*24));return f>=5e3||x>=2e7||b>=20?"VIP":f>=2e3||x>=1e7||b>=10?"Loyal":m>180&&b>0?"Lost":m>90&&b>0?"At Risk":b>=2&&b<10?"Potential":"New"},Me=()=>{const{data:a=[],isLoading:f,refetch:x}=se(),b=ae(),h=le(),[m,y]=n.useState(20),u=async t=>{if(t.id)await h.mutateAsync({id:t.id,updates:t});else{const i={...t,id:`CUS-${Date.now()}-${Math.random().toString(16).slice(2)}`};await b.mutateAsync(i)}x(),g(null)},[d,C]=n.useState(""),[o,g]=n.useState(null),[T,k]=n.useState(!1),[w,S]=n.useState(!1),[s,r]=n.useState("customers"),[c,$]=n.useState("all"),[M,P]=n.useState(null),[H,I]=n.useState("grid"),[O,V]=n.useState(!1),{data:A=[]}=re(),{data:R=[]}=me();n.useEffect(()=>{y(20)},[d,c]);const _=t=>{const i=A.filter(v=>{var D,L;return((D=v.customer)==null?void 0:D.id)===t.id||((L=v.customer)==null?void 0:L.phone)===t.phone}),l=R.filter(v=>v.customerPhone===t.phone),p=i.reduce((v,D)=>v+(D.total||0),0),j=l.reduce((v,D)=>v+(D.total||0),0),U=p+j;return Math.floor(U/1e4)};n.useEffect(()=>{a.forEach(t=>{if(!t.segment){const i=ke(t);h.mutate({id:t.id,updates:{segment:i}})}})},[a.length]);const W=n.useMemo(()=>{const t=d.toLowerCase();let i=a.filter(l=>l.name.toLowerCase().includes(t)||l.phone&&l.phone.includes(t)||l.vehicles&&l.vehicles.some(p=>{var j;return(j=p.licensePlate)==null?void 0:j.toLowerCase().includes(t)}));if(c!=="all"){const p={vip:"VIP",loyal:"Loyal",potential:"Potential","at-risk":"At Risk",lost:"Lost",new:"New"}[c];i=i.filter(j=>j.segment===p)}return i},[a,d,c]),Y=n.useMemo(()=>W.slice(0,m),[W,m]),Q=async t=>{confirm("XÃ¡c nháº­n xoÃ¡ khÃ¡ch hÃ ng nÃ y?")&&(await h.mutateAsync({id:t,updates:{status:"inactive"}}),x())},N=n.useMemo(()=>{const t=a.length,i=a.filter(l=>l.status==="active").length;return{total:t,active:i,newThisMonth:a.filter(l=>{if(!l.created_at)return!1;const p=new Date(l.created_at),j=new Date;return p.getMonth()===j.getMonth()&&p.getFullYear()===j.getFullYear()}).length,revenue:0,vip:a.filter(l=>l.segment==="VIP").length,loyal:a.filter(l=>l.segment==="Loyal").length,potential:a.filter(l=>l.segment==="Potential").length,atRisk:a.filter(l=>l.segment==="At Risk").length,lost:a.filter(l=>l.segment==="Lost").length,new:a.filter(l=>l.segment==="New").length}},[a]),z=n.useMemo(()=>ne(a),[a]),ee=n.useMemo(()=>[{id:"all",label:"Táº¥t cáº£",hint:"ToÃ n bá»™ danh sÃ¡ch",count:N.total,icon:"ðŸŒ",activeClasses:"border-slate-300 bg-slate-100/80 text-slate-900 shadow-sm"},{id:"vip",label:"VIP",hint:"â‰¥ 5.000 Ä‘iá»ƒm",count:N.vip,icon:"ðŸ‘‘",activeClasses:"border-purple-200 bg-purple-50 text-purple-700 shadow-sm"},{id:"loyal",label:"Trung thÃ nh",hint:"10+ lÆ°á»£t",count:N.loyal,icon:"ðŸ’Ž",activeClasses:"border-blue-200 bg-blue-50 text-blue-700 shadow-sm"},{id:"potential",label:"Tiá»m nÄƒng",hint:"2-9 lÆ°á»£t",count:N.potential,icon:"â­",activeClasses:"border-green-200 bg-green-50 text-green-700 shadow-sm"},{id:"at-risk",label:"Cáº§n chÄƒm sÃ³c",hint:">90 ngÃ y chÆ°a Ä‘áº¿n",count:N.atRisk,icon:"âš ï¸",activeClasses:"border-orange-200 bg-orange-50 text-orange-700 shadow-sm"},{id:"lost",label:"ÄÃ£ máº¥t",hint:"KhÃ´ng quay láº¡i",count:N.lost,icon:"âŒ",activeClasses:"border-red-200 bg-red-50 text-red-700 shadow-sm"},{id:"new",label:"KhÃ¡ch má»›i",hint:"ThÃ¡ng nÃ y",count:N.new,icon:"ðŸ†•",activeClasses:"border-cyan-200 bg-cyan-50 text-cyan-700 shadow-sm"}],[N]),te=n.useMemo(()=>[{id:"total",title:"Tá»•ng KH",value:N.total.toLocaleString(),subLabel:`${N.active} hoáº¡t Ä‘á»™ng`,gradient:"from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/20",border:"border-blue-200 dark:border-blue-800",labelClass:"text-blue-700 dark:text-blue-300",valueClass:"text-blue-900 dark:text-blue-100"},{id:"new",title:"KhÃ¡ch má»›i",value:N.newThisMonth.toLocaleString(),subLabel:"â†‘ 0% thÃ¡ng nÃ y",gradient:"from-green-50 to-emerald-100 dark:from-green-900/30 dark:to-emerald-800/20",border:"border-green-200 dark:border-green-800",labelClass:"text-green-700 dark:text-green-300",valueClass:"text-green-900 dark:text-green-100"},{id:"avg",title:"DT TB",value:"0 Ä‘",subLabel:"/ khÃ¡ch hÃ ng",gradient:"from-purple-50 to-violet-100 dark:from-purple-900/30 dark:to-violet-800/20",border:"border-purple-200 dark:border-purple-800",labelClass:"text-purple-700 dark:text-purple-300",valueClass:"text-purple-900 dark:text-purple-100"},{id:"atRisk",title:"Cáº§n CS",value:N.atRisk.toLocaleString(),subLabel:"0Ä‘ tiá»m nÄƒng",gradient:"from-orange-50 to-amber-100 dark:from-orange-900/30 dark:to-amber-800/20",border:"border-orange-200 dark:border-orange-800",labelClass:"text-orange-700 dark:text-orange-300",valueClass:"text-orange-900 dark:text-orange-100"}],[N]),q={VIP:{label:"VIP",badgeClass:"bg-purple-100 text-purple-700 border border-purple-200 dark:bg-purple-900/30 dark:text-purple-200 dark:border-purple-700",avatarClass:"bg-purple-50 text-purple-700 dark:bg-purple-900/40",icon:"ðŸ‘‘"},Loyal:{label:"Trung thÃ nh",badgeClass:"bg-blue-100 text-blue-700 border border-blue-200 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700",avatarClass:"bg-blue-50 text-blue-700 dark:bg-blue-900/40",icon:"ðŸ’Ž"},Potential:{label:"Tiá»m nÄƒng",badgeClass:"bg-green-100 text-green-700 border border-green-200 dark:bg-green-900/30 dark:text-green-200 dark:border-green-700",avatarClass:"bg-green-50 text-green-700 dark:bg-green-900/40",icon:"â­"},"At Risk":{label:"Cáº§n chÄƒm sÃ³c",badgeClass:"bg-orange-100 text-orange-700 border border-orange-200 dark:bg-orange-900/30 dark:text-orange-200 dark:border-orange-700",avatarClass:"bg-orange-50 text-orange-700 dark:bg-orange-900/40",icon:"âš ï¸"},Lost:{label:"ÄÃ£ máº¥t",badgeClass:"bg-red-100 text-red-600 border border-red-200 dark:bg-red-900/30 dark:text-red-200 dark:border-red-700",avatarClass:"bg-red-50 text-red-600 dark:bg-red-900/40",icon:"âŒ"},New:{label:"KhÃ¡ch má»›i",badgeClass:"bg-cyan-100 text-cyan-700 border border-cyan-200 dark:bg-cyan-900/30 dark:text-cyan-200 dark:border-cyan-700",avatarClass:"bg-cyan-50 text-cyan-700 dark:bg-cyan-900/40",icon:"ðŸ†•"},default:{label:"KhÃ¡ch hÃ ng",badgeClass:"bg-slate-100 text-slate-700 border border-slate-200 dark:bg-slate-800 dark:text-slate-200 dark:border-slate-600",avatarClass:"bg-slate-100 text-slate-600 dark:bg-slate-800",icon:"ðŸ‘¤"}};return e.jsxs("div",{className:"h-full flex flex-col bg-slate-50 dark:bg-slate-900 overflow-hidden",children:[e.jsx("div",{className:"bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 flex-none z-20 shadow-sm",children:e.jsxs("div",{className:"flex items-center px-4 overflow-x-auto no-scrollbar",children:[e.jsxs("button",{onClick:()=>r("customers"),className:`flex items-center gap-1.5 px-3 py-2 md:py-3 border-b-2 font-medium text-sm transition-colors whitespace-nowrap ${s==="customers"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"}`,children:[e.jsx(he,{className:"w-4 h-4"}),e.jsxs("span",{children:["KhÃ¡ch hÃ ng (",N.total,")"]})]}),e.jsxs("button",{onClick:()=>r("suppliers"),className:`flex items-center gap-1.5 px-3 py-2 md:py-3 border-b-2 font-medium text-sm transition-colors whitespace-nowrap ${s==="suppliers"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"}`,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),e.jsx("span",{children:"NhÃ  cung cáº¥p (0)"})]})]})}),s==="customers"?e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar relative",children:[e.jsxs("div",{className:"sticky top-0 z-10 pb-3 -mt-2 pt-2 bg-slate-50/95 dark:bg-slate-900/95 backdrop-blur-sm transition-all",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-2 mb-3",children:[e.jsxs("div",{className:"flex-1 relative w-full",children:[e.jsx("svg",{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",placeholder:"TÃ¬m theo tÃªn, SÄT, biá»ƒn sá»‘ xe...",value:d,onChange:t=>C(t.target.value),className:"w-full pl-9 pr-14 md:pr-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-sm text-sm"}),e.jsxs("button",{onClick:()=>V(!0),className:"md:hidden absolute right-2 top-1/2 -translate-y-1/2 inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-[11px] font-semibold text-slate-600 shadow-sm transition-colors hover:text-slate-900 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300",children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.75a.75.75 0 100-1.5.75.75 0 000 1.5zm0 6a.75.75 0 100-1.5.75.75 0 000 1.5zm0 6a.75.75 0 100-1.5.75.75 0 000 1.5z"})}),e.jsx("span",{children:"TÃ¡c vá»¥"})]})]}),e.jsxs("div",{className:"hidden md:flex gap-2 overflow-x-auto pb-2 md:pb-0 no-scrollbar",children:[e.jsxs("button",{onClick:()=>S(!0),className:"flex items-center gap-1.5 px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors whitespace-nowrap shadow-sm text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("span",{children:"Upload DS"})]}),e.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg font-medium transition-colors whitespace-nowrap shadow-sm text-sm",onClick:()=>alert("TÃ­nh nÄƒng Ä‘ang phÃ¡t triá»ƒn"),children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),e.jsx("span",{children:"Nháº¯c BD"})]}),e.jsxs("button",{onClick:()=>g({}),className:"flex items-center gap-1.5 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors whitespace-nowrap shadow-sm text-sm",children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:"ThÃªm KH"})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white/80 p-3 shadow-sm dark:border-slate-700 dark:bg-slate-800/60 md:border-none md:bg-transparent md:p-0 md:shadow-none",children:[e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-slate-500",children:"PhÃ¢n khÃºc khÃ¡ch hÃ ng"}),e.jsx("p",{className:"text-[10px] text-slate-400",children:"Cháº¡m Ä‘á»ƒ lá»c nhanh"})]}),e.jsxs("div",{className:"hidden sm:inline-flex rounded-xl border border-slate-200 bg-white p-0.5 text-xs font-semibold dark:border-slate-600 dark:bg-slate-900/40",children:[e.jsxs("button",{onClick:()=>I("grid"),className:`flex flex-1 items-center justify-center gap-1 rounded-lg px-2 py-1.5 transition-colors sm:flex-none ${H==="grid"?"bg-slate-900 text-white dark:bg-slate-100 dark:text-slate-900":"text-slate-500 hover:text-slate-900 dark:text-slate-400 dark:hover:text-white"}`,children:[e.jsx(pe,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:"Tháº»"})]}),e.jsxs("button",{onClick:()=>I("list"),className:`flex flex-1 items-center justify-center gap-1 rounded-lg px-2 py-1.5 transition-colors sm:flex-none ${H==="list"?"bg-slate-900 text-white dark:bg-slate-100 dark:text-slate-900":"text-slate-500 hover:text-slate-900 dark:text-slate-400 dark:hover:text-white"}`,children:[e.jsx(de,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:"Danh sÃ¡ch"})]})]})]}),e.jsx("div",{className:"mt-2 flex gap-2 overflow-x-auto pb-1 no-scrollbar snap-x snap-mandatory md:mt-3 md:snap-none",children:ee.map(t=>e.jsx("button",{onClick:()=>$(t.id),className:`min-w-[160px] snap-start rounded-xl border px-3 py-2 text-left transition-all md:min-w-0 ${c===t.id?`${t.activeClasses} dark:bg-slate-800/80 dark:border-slate-600 dark:text-white`:"bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 border-slate-200 dark:border-slate-700 hover:border-slate-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-base",children:t.icon}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold",children:t.label}),e.jsx("p",{className:"text-[10px] text-slate-500",children:t.hint})]})]}),e.jsx("div",{className:"text-base font-black text-slate-900 dark:text-slate-100",children:t.count})]})},t.id))})]})]}),e.jsxs("div",{className:"mb-6 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("svg",{className:"w-5 h-5 text-slate-600 dark:text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Thá»‘ng kÃª tá»•ng quan"})]}),e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2 snap-x snap-mandatory md:grid md:grid-cols-4 md:gap-4 md:overflow-visible md:snap-none",children:te.map(t=>e.jsxs("div",{className:`snap-start min-w-[170px] rounded-lg border bg-gradient-to-br p-3 md:p-4 ${t.gradient} ${t.border}`,children:[e.jsx("div",{className:`text-[10px] md:text-sm font-semibold mb-1 uppercase ${t.labelClass}`,children:t.title}),e.jsx("div",{className:`text-2xl md:text-3xl font-black ${t.valueClass}`,children:t.value}),e.jsx("div",{className:"text-[10px] md:text-xs mt-0.5 text-slate-600 dark:text-slate-300",children:t.subLabel})]},t.id))})]}),z.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(oe,{className:"w-5 h-5 text-orange-500"}),e.jsxs("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:["Xe cáº§n báº£o dÆ°á»¡ng (",z.length,")"]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-amber-50 dark:from-orange-900/20 dark:to-amber-900/20 rounded-xl border border-orange-200 dark:border-orange-800 p-4",children:[e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2 snap-x snap-mandatory md:grid md:grid-cols-2 lg:grid-cols-3 md:overflow-visible md:snap-none",children:z.slice(0,9).map((t,i)=>e.jsxs("div",{className:"snap-start min-w-[280px] md:min-w-0 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-semibold text-slate-900 dark:text-slate-100 truncate",children:t.customer.name||"KhÃ¡ch hÃ ng"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:t.customer.phone})]}),e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-slate-100 dark:bg-slate-700 rounded-lg",children:[e.jsx(E,{className:"w-3.5 h-3.5 text-slate-600 dark:text-slate-300"}),e.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-200",children:t.vehicle.licensePlate})]})]}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-2",children:["Sá»‘ km hiá»‡n táº¡i:"," ",e.jsxs("span",{className:"font-semibold text-slate-700 dark:text-slate-200",children:[(t.vehicle.currentKm||0).toLocaleString()," km"]})]}),e.jsx("div",{className:"space-y-2",children:t.warnings.map((l,p)=>{const j=l.type==="oilChange"?ue:l.type==="gearboxOil"?be:ge;return e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg text-xs ${l.isOverdue?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-300"}`,children:[e.jsx(j,{className:"w-4 h-4 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"font-medium",children:l.name}),e.jsx("span",{className:"ml-1",children:l.isOverdue?`(quÃ¡ ${Math.abs(l.kmUntilDue).toLocaleString()} km)`:`(cÃ²n ${l.kmUntilDue.toLocaleString()} km)`})]}),e.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-bold ${l.isOverdue?"bg-red-200 text-red-800 dark:bg-red-800 dark:text-red-100":"bg-amber-200 text-amber-800 dark:bg-amber-800 dark:text-amber-100"}`,children:l.isOverdue?"QUÃ Háº N":"Sáº®P Äáº¾N"})]},p)})})]},`${t.customer.id}-${t.vehicle.licensePlate}-${i}`))}),z.length>9&&e.jsxs("p",{className:"text-center text-sm text-orange-600 dark:text-orange-400 mt-3 font-medium",children:["VÃ  ",z.length-9," xe khÃ¡c cáº§n báº£o dÆ°á»¡ng..."]})]})]}),W.length===0?e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 p-12 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("svg",{className:"w-16 h-16 text-slate-300 dark:text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})})}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-lg",children:"KhÃ´ng tÃ¬m tháº¥y khÃ¡ch hÃ ng nÃ o."})]}):e.jsxs(e.Fragment,{children:[H==="grid"?e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:Y.map(t=>{const i=t.segment&&q[t.segment]||q.default,l=_(t),p=Math.min(l/1e4*100,100),j=t.totalSpent||0,U=t.visitCount||0,v=t.vehicles||[];v.find(L=>L.isPrimary)||v[0];const D=v.length>2;return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm transition-shadow hover:shadow-lg dark:border-slate-700 dark:bg-slate-800",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:`flex h-12 w-12 items-center justify-center rounded-2xl text-2xl ${i.avatarClass}`,children:i.icon}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-base font-semibold text-slate-900 dark:text-slate-100 truncate",children:t.name||"ChÆ°a Ä‘áº·t tÃªn"}),e.jsxs("p",{className:"mt-0.5 flex flex-wrap items-center gap-2 text-xs text-slate-500 dark:text-slate-400",children:[e.jsx("span",{children:t.phone||"ChÆ°a cÃ³ sá»‘"}),t.lastVisit&&e.jsxs("span",{className:"text-slate-400",children:["â€¢ Láº§n cuá»‘i ",F(t.lastVisit)]})]})]})]}),e.jsx("span",{className:`text-[10px] font-semibold uppercase px-3 py-1 rounded-full ${i.badgeClass}`,children:i.label})]}),v.length>0?e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[v.slice(0,2).map(L=>e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-slate-50 px-3 py-1 text-xs font-medium text-slate-600 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200",children:[L.isPrimary&&e.jsx("span",{className:"text-amber-500",children:"â˜…"}),e.jsx("span",{children:L.model||"KhÃ´ng rÃµ"}),L.licensePlate&&e.jsxs("span",{className:"text-[10px] text-slate-400",children:["â€¢ ",L.licensePlate]})]},L.id)),D&&e.jsxs("span",{className:"rounded-full bg-slate-100 px-3 py-1 text-xs text-slate-500 dark:bg-slate-700 dark:text-slate-300",children:["+",v.length-2," xe ná»¯a"]})]}):t.vehicleModel?e.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 rounded-full border border-slate-200 bg-slate-50 px-3 py-1 text-xs text-slate-600 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200",children:[e.jsx(E,{className:"h-3.5 w-3.5"}),e.jsxs("span",{children:[t.vehicleModel,t.licensePlate?` â€¢ ${t.licensePlate}`:""]})]}):null,e.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase text-slate-500",children:"Tá»•ng chi"}),e.jsx("p",{className:"text-base font-semibold text-slate-900 dark:text-slate-100",children:B(j)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase text-slate-500",children:"Láº§n Ä‘áº¿n"}),e.jsx("p",{className:"text-base font-semibold text-slate-900 dark:text-slate-100",children:U})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase text-slate-500",children:"Cuá»‘i cÃ¹ng"}),e.jsx("p",{className:"text-base font-semibold text-slate-900 dark:text-slate-100",children:t.lastVisit?F(t.lastVisit):"â€”"})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-[11px] font-semibold text-amber-700 dark:text-amber-300",children:[e.jsx("span",{children:"Äiá»ƒm tÃ­ch luá»¹"}),e.jsx("span",{children:l.toLocaleString()})]}),e.jsx("div",{className:"mt-1 h-1.5 rounded-full bg-amber-100 dark:bg-amber-900/50",children:e.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-amber-500 via-yellow-400 to-orange-500",style:{width:`${p}%`}})})]}),"Cháº¡m Ä‘á»ƒ lá»c nhanh",e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2 border-t border-dashed border-slate-200 pt-3 dark:border-slate-700",children:[e.jsx("button",{onClick:()=>P(t),className:"rounded-full bg-blue-50 px-3 py-1.5 text-xs font-semibold text-blue-600 transition-colors hover:bg-blue-100 dark:bg-blue-900/30 dark:text-blue-300",children:"Xem lá»‹ch sá»­"}),e.jsx("button",{onClick:()=>g(t),className:"rounded-full bg-slate-100 px-3 py-1.5 text-xs font-semibold text-slate-700 transition-colors hover:bg-slate-200 dark:bg-slate-700 dark:text-slate-200",children:"Chá»‰nh sá»­a"}),e.jsx("button",{onClick:()=>Q(t.id),className:"rounded-full bg-red-50 px-3 py-1.5 text-xs font-semibold text-red-600 transition-colors hover:bg-red-100 dark:bg-red-900/30 dark:text-red-300",children:"XÃ³a"})]})]},t.id)})}):e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white shadow-sm dark:border-slate-700 dark:bg-slate-800",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-left text-[11px] font-semibold uppercase tracking-wide text-slate-500 dark:bg-slate-900/40 dark:text-slate-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"KhÃ¡ch hÃ ng"}),e.jsx("th",{className:"px-4 py-3",children:"LiÃªn há»‡"}),e.jsx("th",{className:"px-4 py-3",children:"Xe"}),e.jsx("th",{className:"px-4 py-3",children:"Tá»•ng chi"}),e.jsx("th",{className:"px-4 py-3",children:"Láº§n Ä‘áº¿n"}),e.jsx("th",{className:"px-4 py-3",children:"Láº§n cuá»‘i"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"TÃ¡c vá»¥"})]})}),e.jsx("tbody",{children:Y.map(t=>{const i=t.segment&&q[t.segment]||q.default,l=t.vehicles||[],p=l.find(U=>U.isPrimary)||l[0],j=p?`${p.model||"KhÃ´ng rÃµ"}${p.licensePlate?` â€¢ ${p.licensePlate}`:""}`:t.vehicleModel?`${t.vehicleModel}${t.licensePlate?` â€¢ ${t.licensePlate}`:""}`:"â€”";return e.jsxs("tr",{className:"border-t border-slate-100 text-slate-600 dark:border-slate-700/60 dark:text-slate-300",children:[e.jsxs("td",{className:"px-4 py-3 align-top",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:t.name||"ChÆ°a Ä‘áº·t tÃªn"}),e.jsxs("span",{className:`mt-1 inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[10px] font-semibold ${i.badgeClass}`,children:[i.icon," ",i.label]})]}),e.jsxs("td",{className:"px-4 py-3 align-top",children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-slate-100",children:t.phone||"â€”"}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Äiá»ƒm:"," ",_(t).toLocaleString()]})]}),e.jsx("td",{className:"px-4 py-3 align-top text-slate-900 dark:text-slate-100",children:j}),e.jsx("td",{className:"px-4 py-3 align-top font-semibold text-slate-900 dark:text-slate-100",children:B(t.totalSpent||0)}),e.jsx("td",{className:"px-4 py-3 align-top text-slate-900 dark:text-slate-100",children:t.visitCount||0}),e.jsx("td",{className:"px-4 py-3 align-top text-slate-900 dark:text-slate-100",children:t.lastVisit?F(t.lastVisit):"â€”"}),e.jsx("td",{className:"px-4 py-3 align-top",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>P(t),className:"rounded-lg border border-slate-200 p-2 text-slate-500 transition-colors hover:border-blue-500 hover:text-blue-600 dark:border-slate-600 dark:text-slate-400 dark:hover:border-blue-500",title:"Xem lá»‹ch sá»­",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("button",{onClick:()=>g(t),className:"rounded-lg border border-slate-200 p-2 text-slate-500 transition-colors hover:border-blue-500 hover:text-blue-600 dark:border-slate-600 dark:text-slate-400 dark:hover:border-blue-500",title:"Chá»‰nh sá»­a",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>Q(t.id),className:"rounded-lg border border-red-200 p-2 text-red-500 transition-colors hover:bg-red-50 dark:border-red-900/60 dark:text-red-300 dark:hover:bg-red-900/40",title:"XÃ³a",children:e.jsx(Z,{className:"h-4 w-4"})})]})})]},t.id)})})]})}),m<W.length&&e.jsx("div",{className:"flex justify-center pb-4 pt-8",children:e.jsxs("button",{onClick:()=>y(t=>t+20),className:"group flex items-center gap-2 rounded-full border border-slate-200 bg-white px-6 py-3 text-sm font-semibold text-slate-600 shadow-sm transition hover:border-blue-500 hover:text-blue-600 hover:shadow-md dark:border-slate-600 dark:bg-slate-800 dark:text-slate-200",children:[e.jsxs("span",{children:["Hiá»ƒn thá»‹ thÃªm"," ",Math.min(20,W.length-m)," khÃ¡ch hÃ ng"]}),e.jsx("svg",{className:"h-4 w-4 transition-transform group-hover:translate-y-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})]}),e.jsxs("button",{onClick:()=>g({}),className:"md:hidden fixed bottom-28 right-5 z-40 inline-flex items-center justify-center rounded-full bg-blue-600 p-4 text-white shadow-lg transition hover:bg-blue-700",children:[e.jsx(K,{className:"h-6 w-6"}),e.jsx("span",{className:"sr-only",children:"ThÃªm khÃ¡ch hÃ ng"})]}),O&&e.jsxs("div",{className:"md:hidden fixed inset-0 z-30",children:[e.jsx("button",{onClick:()=>V(!1),className:"absolute inset-0 bg-black/40","aria-label":"ÄÃ³ng"}),e.jsxs("div",{className:"absolute inset-x-0 bottom-0 rounded-t-3xl bg-white p-5 shadow-2xl dark:bg-slate-800",children:[e.jsx("div",{className:"mx-auto mb-4 h-1.5 w-12 rounded-full bg-slate-200 dark:bg-slate-600"}),e.jsx("h3",{className:"mb-4 text-sm font-semibold text-slate-600 dark:text-slate-300",children:"TÃ¡c vá»¥ nhanh"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>{V(!1),S(!0)},className:"flex w-full items-center gap-3 rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-left text-sm font-semibold text-slate-700 transition hover:border-blue-500 dark:border-slate-700 dark:bg-slate-700/40 dark:text-slate-200",children:[e.jsx("svg",{className:"h-5 w-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Upload danh sÃ¡ch"]}),e.jsxs("button",{onClick:()=>{V(!1),alert("TÃ­nh nÄƒng Ä‘ang phÃ¡t triá»ƒn")},className:"flex w-full items-center gap-3 rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-left text-sm font-semibold text-slate-700 transition hover:border-blue-500 dark:border-slate-700 dark:bg-slate-700/40 dark:text-slate-200",children:[e.jsx("svg",{className:"h-5 w-5 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),"Nháº¯c báº£o dÆ°á»¡ng"]}),e.jsxs("button",{onClick:()=>{V(!1),g({})},className:"flex w-full items-center gap-3 rounded-2xl bg-blue-600 px-4 py-3 text-left text-sm font-semibold text-white shadow-lg transition hover:bg-blue-700",children:[e.jsx(K,{className:"h-5 w-5"})," ThÃªm khÃ¡ch hÃ ng"]})]})]})]})]}):e.jsxs("div",{className:"flex-1 overflow-auto p-6 custom-scrollbar",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("svg",{className:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",placeholder:"TÃ¬m theo tÃªn hoáº·c sá»‘ Ä‘iá»‡n thoáº¡i...",className:"w-full pl-10 pr-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"text-slate-600 dark:text-slate-400 text-sm font-medium",children:["Tá»•ng: ",e.jsx("span",{className:"font-bold",children:"0"})," nhÃ  cung cáº¥p"]}),e.jsxs("button",{onClick:()=>S(!0),className:"flex items-center gap-2 px-4 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("span",{children:"Upload CSV"})]}),e.jsxs("button",{onClick:()=>k(!0),className:"flex items-center gap-2 px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:[e.jsx(K,{className:"w-5 h-5"}),e.jsx("span",{children:"ThÃªm má»›i"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 p-12 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("svg",{className:"w-16 h-16 text-slate-300 dark:text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-lg",children:"ChÆ°a cÃ³ nhÃ  cung cáº¥p."})]})]}),e.jsx(fe,{isOpen:!!M,onClose:()=>P(null),customer:M,sales:A,workOrders:R}),o&&e.jsx(je,{customer:o,onSave:u,onClose:()=>g(null)}),T&&e.jsx(ve,{onClose:()=>k(!1)}),w&&e.jsx(Ne,{onClose:()=>S(!1),type:s})]})},je=({customer:a,onSave:f,onClose:x})=>{const[b,h]=n.useState(a.name||""),[m,y]=n.useState(a.phone||""),u=()=>a.vehicles&&a.vehicles.length>0?a.vehicles:a.vehicleModel||a.licensePlate?[{id:`VEH-${Date.now()}`,model:a.vehicleModel||"",licensePlate:a.licensePlate||"",isPrimary:!0}]:[],[d,C]=n.useState(u()),[o,g]=n.useState({model:"",licensePlate:""}),T=()=>{if(!o.model.trim()&&!o.licensePlate.trim())return;const s={id:`VEH-${Date.now()}`,model:o.model.trim(),licensePlate:o.licensePlate.trim(),isPrimary:d.length===0};C([...d,s]),g({model:"",licensePlate:""})},k=s=>{C(d.filter(r=>r.id!==s))},w=s=>{C(d.map(r=>({...r,isPrimary:r.id===s})))},S=s=>{if(s.preventDefault(),!b.trim()){J.error("Vui lÃ²ng nháº­p tÃªn khÃ¡ch hÃ ng");return}if(m.trim()){const c=xe(m.trim());if(!c.ok){J.error(c.error||"Sá»‘ Ä‘iá»‡n thoáº¡i khÃ´ng há»£p lá»‡");return}}const r=d.find(c=>c.isPrimary)||d[0];f({id:a.id,name:b.trim(),phone:m.trim(),vehicles:d,vehicleModel:(r==null?void 0:r.model)||"",licensePlate:(r==null?void 0:r.licensePlate)||""}),x()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-slate-800 rounded-xl shadow-2xl max-w-md w-full p-6 border border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:a.id?"Sá»­a khÃ¡ch hÃ ng":"ThÃªm khÃ¡ch hÃ ng"}),e.jsx("button",{onClick:x,className:"text-slate-400 hover:text-white transition-colors",children:e.jsx(X,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"TÃªn khÃ¡ch"}),e.jsx("input",{type:"text",placeholder:"Nháº­p tÃªn khÃ¡ch",required:!0,value:b,onChange:s=>h(s.target.value),className:"w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Sá»‘ Ä‘iá»‡n thoáº¡i"}),e.jsx("input",{type:"text",placeholder:"VD: 09xxxx",value:m,onChange:s=>y(s.target.value),className:"w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Danh sÃ¡ch xe"}),d.length>0&&e.jsx("div",{className:"space-y-2 mb-3",children:d.map(s=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-slate-700 rounded-lg",children:[e.jsx("button",{type:"button",onClick:()=>w(s.id),className:`flex-shrink-0 ${s.isPrimary?"text-yellow-400":"text-slate-500 hover:text-yellow-400"}`,title:s.isPrimary?"Xe chÃ­nh":"Äáº·t lÃ m xe chÃ­nh",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})}),e.jsx(E,{className:"w-4 h-4 text-blue-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 text-sm text-white",children:[e.jsx("span",{className:"font-medium",children:s.model||"â€”"}),s.licensePlate&&e.jsxs("span",{className:"text-slate-400 ml-2",children:["â€¢ ",s.licensePlate]})]}),e.jsx("button",{type:"button",onClick:()=>k(s.id),className:"flex-shrink-0 text-red-400 hover:text-red-300",title:"XÃ³a xe",children:e.jsx(Z,{className:"w-4 h-4"})})]},s.id))}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",placeholder:"DÃ²ng xe",value:o.model,onChange:s=>g({...o,model:s.target.value}),className:"px-3 py-2 bg-slate-900 border border-slate-600 rounded-lg text-white placeholder-slate-500 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("input",{type:"text",placeholder:"Biá»ƒn sá»‘",value:o.licensePlate,onChange:s=>g({...o,licensePlate:s.target.value}),className:"px-3 py-2 bg-slate-900 border border-slate-600 rounded-lg text-white placeholder-slate-500 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("button",{type:"button",onClick:T,className:"mt-2 w-full px-3 py-2 bg-green-600 hover:bg-green-700 text-white text-sm rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),"ThÃªm xe"]})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-2",children:[e.jsx("button",{type:"button",onClick:x,className:"px-6 py-2.5 bg-slate-700 hover:bg-slate-600 text-white border border-slate-600 rounded-lg font-medium transition-colors",children:"Há»§y"}),e.jsx("button",{type:"submit",className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"LÆ°u"})]})]})]})})},ve=({onClose:a})=>{const[f,x]=n.useState(""),[b,h]=n.useState(""),[m,y]=n.useState(""),[u,d]=n.useState(""),C=o=>{o.preventDefault(),f.trim()&&(alert(`[MÃ´ phá»ng] ÄÃ£ lÆ°u nhÃ  cung cáº¥p: ${f}`),a())};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-slate-800 rounded-xl shadow-2xl max-w-md w-full p-6 border border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"ThÃªm nhÃ  cung cáº¥p"}),e.jsx("button",{onClick:a,className:"text-slate-400 hover:text-white transition-colors",children:e.jsx(X,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["TÃªn nhÃ  cung cáº¥p ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",placeholder:"Nháº­p tÃªn NCC",required:!0,value:f,onChange:o=>x(o.target.value),className:"w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Sá»‘ Ä‘iá»‡n thoáº¡i"}),e.jsx("input",{type:"text",placeholder:"VD: 09xxxx",value:b,onChange:o=>h(o.target.value),className:"w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Äá»‹a chá»‰"}),e.jsx("input",{type:"text",placeholder:"Äá»‹a chá»‰ liÃªn há»‡",value:m,onChange:o=>y(o.target.value),className:"w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Ghi chÃº"}),e.jsx("textarea",{rows:3,placeholder:"Ghi chÃº thÃªm...",value:u,onChange:o=>d(o.target.value),className:"w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none"})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-2",children:[e.jsx("button",{type:"button",onClick:a,className:"px-6 py-2.5 bg-slate-700 hover:bg-slate-600 text-white border border-slate-600 rounded-lg font-medium transition-colors",children:"Há»§y"}),e.jsx("button",{type:"submit",className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"LÆ°u"})]})]})]})})},Ne=({onClose:a,type:f})=>{const x=ce(),b=n.useRef(null),[h,m]=n.useState([]),[y,u]=n.useState(""),[d,C]=n.useState(!1),o=k=>{var s;const w=(s=k.target.files)==null?void 0:s[0];if(!w)return;u("");const S=new FileReader;S.onload=r=>{var O;const c=(O=r.target)==null?void 0:O.result;if(!c)return;const $=c.split(`
`).map(V=>V.trim()).filter(Boolean);if($.length===0){u("File CSV trá»‘ng.");return}const M=$[0].toLowerCase(),H=M.includes("name")||M.includes("phone")||M.includes("tÃªn")||M.includes("sÄ‘t")?$.slice(1):$,I=[];for(const V of H){const A=V.split(",").map(R=>R.trim());A.length===0||!A[0]||I.push({name:A[0],phone:A[1]||void 0})}if(I.length===0){u("KhÃ´ng tÃ¬m tháº¥y dá»¯ liá»‡u há»£p lá»‡ trong CSV.");return}m(I)},S.readAsText(w)},g=async()=>{if(h.length!==0){C(!0);try{if(f==="customers"){const k=h.map(w=>({id:typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`CUS-${Date.now()}-${Math.random().toString(16).slice(2)}`,name:w.name,phone:w.phone||"",created_at:new Date().toISOString()}));await x.mutateAsync(k),alert(`ÄÃ£ import thÃ nh cÃ´ng ${k.length} khÃ¡ch hÃ ng!`)}else alert("Chá»©c nÄƒng import NhÃ  cung cáº¥p Ä‘ang Ä‘Æ°á»£c phÃ¡t triá»ƒn. Vui lÃ²ng thÃªm hook useCreateSuppliersBulk Ä‘á»ƒ kÃ­ch hoáº¡t.");a()}catch(k){console.error("Import error:",k),u("CÃ³ lá»—i xáº£y ra khi import. Vui lÃ²ng thá»­ láº¡i.")}finally{C(!1)}}},T=f==="customers";return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl w-full max-h-[90vh] overflow-y-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:["Import ",T?"khÃ¡ch hÃ ng":"nhÃ  cung cáº¥p"," tá»« CSV"]}),e.jsx("button",{onClick:a,className:"text-slate-500 hover:text-slate-700",children:e.jsx(X,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("p",{className:"text-slate-600 dark:text-slate-300",children:["Chá»n file CSV vá»›i cá»™t Ä‘áº§u tiÃªn lÃ "," ",e.jsxs("strong",{children:["tÃªn ",T?"khÃ¡ch hÃ ng":"nhÃ  cung cáº¥p"]}),", cá»™t thá»© hai lÃ  ",e.jsx("strong",{children:"sá»‘ Ä‘iá»‡n thoáº¡i"})," (tÃ¹y chá»n)."]}),e.jsx("input",{ref:b,type:"file",accept:".csv",onChange:o,className:"block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),y&&e.jsx("div",{className:"text-red-600 text-xs",children:y}),h.length>0&&e.jsxs("div",{className:"border rounded p-3 bg-slate-50 dark:bg-slate-900 max-h-64 overflow-y-auto custom-scrollbar",children:[e.jsxs("div",{className:"font-semibold mb-2 text-slate-900 dark:text-slate-100",children:["Xem trÆ°á»›c (",h.length," má»¥c):"]}),e.jsxs("table",{className:"w-full text-xs text-slate-700 dark:text-slate-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b dark:border-slate-700",children:[e.jsx("th",{className:"p-1",children:"TÃªn"}),e.jsx("th",{className:"p-1",children:"SÄT"})]})}),e.jsx("tbody",{children:h.slice(0,20).map((k,w)=>e.jsxs("tr",{className:"border-b dark:border-slate-700",children:[e.jsx("td",{className:"p-1",children:k.name}),e.jsx("td",{className:"p-1",children:k.phone||"--"})]},w))})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 border rounded hover:bg-slate-50 dark:border-slate-600 dark:hover:bg-slate-700 dark:text-slate-300",children:"Huá»·"}),e.jsx("button",{disabled:h.length===0||d,onClick:g,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Äang import...":`Import ${h.length>0?`(${h.length})`:""}`})]})]})]})})};export{Me as default};
