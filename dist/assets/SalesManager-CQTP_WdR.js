const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-B2tLSL14.js","assets/index-Cui4VmEh.css"])))=>i.map(i=>d[i]);
import{c as ct,r as a,u as Ht,a as Et,b as ks,d as js,e as Kt,f as vs,g as ys,s as u,h as Wt,j as e,B as wt,S as Nt,i as m,k as Ot,l as ot,R as Rt,m as He,n as At,_ as it,o as Vt}from"./index-B2tLSL14.js";import{B as ws,c as Ns}from"./BarcodeScannerModal-Dc-VD1kc.js";import{p as qt}from"./print-TOU0k1YY.js";import{P as Ft,X as Gt}from"./Icons-BQOuv3J_.js";import{u as Cs,a as Ss}from"./useDebtsRepository-CvWhwdYQ.js";import{H as $t}from"./history-Ck6DoLpc.js";import{P as Ts}from"./plus-hSEeUq78.js";import{S as Ms}from"./share-2-t4izYr8p.js";import{P as Ls}from"./printer-qPx7NBJU.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=ct("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=ct("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=ct("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=ct("ScanLine",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);function Is(Y,g,o=5){return a.useMemo(()=>{const O=Array.isArray(Y)?Y:[],U=g||"",p=O.filter(Q=>{var ne;return(((ne=Q.stock)==null?void 0:ne[U])??0)<=0}),z=O.filter(Q=>{var M;const ne=((M=Q.stock)==null?void 0:M[U])??0;return ne>0&&ne<=o});return{lowStock:z,outOfStock:p,lowStockCount:z.length,outOfStockCount:p.length}},[Y,g,o])}const dt=5,_s=({isOpen:Y,onClose:g,sale:o,onPrint:O})=>{if(!Y||!o)return null;const U=o.items.reduce((z,Q)=>z+Q.quantity*Q.sellingPrice,0),p=U-o.total;return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"Chi ti·∫øt ƒë∆°n h√†ng"}),e.jsx("button",{onClick:g,className:"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 text-2xl",children:"√ó"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-slate-400",children:"M√£ ƒë∆°n h√†ng"}),e.jsx("div",{className:"text-base font-semibold text-slate-900 dark:text-slate-100",children:o.sale_code||He(o.id)||o.id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Ng√†y t·∫°o"}),e.jsxs("div",{className:"text-base font-semibold text-slate-900 dark:text-slate-100",children:[ot(new Date(o.date),!1)," ",new Date(o.date).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Kh√°ch h√†ng"}),e.jsx("div",{className:"text-base font-semibold text-slate-900 dark:text-slate-100",children:o.customer.name}),o.customer.phone&&e.jsx("div",{className:"text-sm text-slate-500",children:o.customer.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Nh√¢n vi√™n b√°n h√†ng"}),e.jsx("div",{className:"text-base font-semibold text-slate-900 dark:text-slate-100",children:o.username||o.userName||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Ph∆∞∆°ng th·ª©c thanh to√°n"}),e.jsx("div",{className:"text-base font-semibold text-slate-900 dark:text-slate-100",children:o.paymentMethod==="cash"?"Ti·ªÅn m·∫∑t":"Chuy·ªÉn kho·∫£n"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-3",children:"S·∫£n ph·∫©m"}),e.jsx("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-xs font-medium text-slate-500 dark:text-slate-400 uppercase",children:"T√™n s·∫£n ph·∫©m"}),e.jsx("th",{className:"text-right px-4 py-3 text-xs font-medium text-slate-500 dark:text-slate-400 uppercase",children:"SL"}),e.jsx("th",{className:"text-right px-4 py-3 text-xs font-medium text-slate-500 dark:text-slate-400 uppercase",children:"ƒê∆°n gi√°"}),e.jsx("th",{className:"text-right px-4 py-3 text-xs font-medium text-slate-500 dark:text-slate-400 uppercase",children:"Th√†nh ti·ªÅn"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700",children:o.items.map((z,Q)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-4 py-3 text-sm text-slate-900 dark:text-slate-100",children:[z.partName,z.sku&&e.jsxs("div",{className:"text-xs text-slate-500",children:["SKU: ",z.sku]})]}),e.jsx("td",{className:"px-4 py-3 text-sm text-right text-slate-900 dark:text-slate-100",children:z.quantity}),e.jsx("td",{className:"px-4 py-3 text-sm text-right text-slate-900 dark:text-slate-100",children:m(z.sellingPrice)}),e.jsx("td",{className:"px-4 py-3 text-sm text-right font-semibold text-slate-900 dark:text-slate-100",children:m(z.quantity*z.sellingPrice)})]},Q))})]})})]}),e.jsx("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"T·∫°m t√≠nh:"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-slate-100",children:m(U)})]}),p>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Gi·∫£m gi√°:"}),e.jsxs("span",{className:"font-semibold text-red-600 dark:text-red-400",children:["-",m(p)]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold border-t border-slate-200 dark:border-slate-700 pt-2",children:[e.jsx("span",{className:"text-slate-900 dark:text-slate-100",children:"T·ªïng c·ªông:"}),e.jsx("span",{className:"text-green-600 dark:text-green-400",children:m(o.total)})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 p-6 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("button",{onClick:g,className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:"ƒê√≥ng"}),e.jsxs("button",{onClick:()=>{O(o),g()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"In h√≥a ƒë∆°n"]})]})]})})},Bs=({isOpen:Y,onClose:g,sale:o,onSave:O})=>{const{customers:U,upsertCustomer:p}=Ht(),{data:z=[]}=Kt(),Q=Et(),{profile:ne}=Wt(),[M,$]=a.useState([]),[Qe,ye]=a.useState({id:"",name:"",phone:""}),[X,he]=a.useState("cash"),[we,Xe]=a.useState(0),[ge,V]=a.useState(""),[be,Ne]=a.useState(!1),[Ce,Se]=a.useState(!1),[Te,Me]=a.useState(""),[Le,ue]=a.useState(""),[te,de]=a.useState(""),[H,pe]=a.useState(!1);if(a.useEffect(()=>{o&&($([...o.items]),ye({id:o.customer.id||"",name:o.customer.name,phone:o.customer.phone||""}),de(o.customer.name),he(o.paymentMethod),Xe(o.discount||0))},[o]),!Y||!o)return null;const Z=M.reduce((l,y)=>l+y.quantity*y.sellingPrice,0),fe=Z-we,L=z.filter(l=>l.name.toLowerCase().includes(ge.toLowerCase())||l.sku.toLowerCase().includes(ge.toLowerCase())),Pe=U.filter(l=>{var S;const y=te.toLowerCase();return l.name.toLowerCase().includes(y)||((S=l.phone)==null?void 0:S.toLowerCase().includes(y))||l.vehicles&&l.vehicles.some(ee=>{var F;return(F=ee.licensePlate)==null?void 0:F.toLowerCase().includes(y)})}),J=l=>{const y=typeof l.stock=="object"?l.stock[o.branchId]||0:l.stock,S=typeof l.retailPrice=="object"?l.retailPrice[o.branchId]||0:l.retailPrice||0,ee=M.find(F=>F.partId===l.id);$(ee?M.map(F=>F.partId===l.id?{...F,quantity:F.quantity+1}:F):[...M,{partId:l.id,partName:l.name,sku:l.sku,quantity:1,sellingPrice:S,stockSnapshot:typeof y=="number"?y:0}]),V(""),Ne(!1)},q=l=>{ye({id:l.id,name:l.name,phone:l.phone||""}),de(l.name),pe(!1)},Ee=async()=>{if(!Te.trim()){u.error("Vui l√≤ng nh·∫≠p t√™n kh√°ch h√†ng");return}try{const l={id:crypto.randomUUID(),name:Te,phone:Le||void 0,email:"",created_at:new Date().toISOString()};await p(l),ye({id:l.id,name:l.name,phone:l.phone||""}),de(l.name),Se(!1),Me(""),ue(""),u.success("Th√™m kh√°ch h√†ng th√†nh c√¥ng")}catch(l){console.error("Error adding customer:",l),u.error("L·ªói khi th√™m kh√°ch h√†ng")}},j=(l,y)=>{y<=0?$(M.filter(S=>S.partId!==l)):$(M.map(S=>S.partId===l?{...S,quantity:y}:S))},Ye=(l,y)=>{$(M.map(S=>S.partId===l?{...S,sellingPrice:y}:S))},ke=l=>{$(M.filter(y=>y.partId!==l))},se=async()=>{if(M.length===0){u.error("Vui l√≤ng c√≥ √≠t nh·∫•t m·ªôt s·∫£n ph·∫©m");return}if(!Qe.name){u.error("Vui l√≤ng nh·∫≠p t√™n kh√°ch h√†ng");return}try{await O({id:o.id,items:M,customer:Qe,paymentMethod:X,discount:we}),Q.invalidateQueries({queryKey:["salesRepoPaged"]}),g()}catch(l){console.error("Error saving sale:",l)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg w-full max-w-2xl max-h-[95vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("h2",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:["‚úèÔ∏è [Ch·ªânh s·ª≠a] ƒê∆°n Xu·∫•t B√°n ",o.sale_code||He(o.id)]}),e.jsx("button",{onClick:g,className:"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 text-2xl leading-none",children:"√ó"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Th·ªùi gian b√°n h√†ng:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:ot(new Date(o.date),!1),disabled:!0,className:"flex-1 px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-slate-50 dark:bg-slate-700 text-slate-900 dark:text-slate-100"}),e.jsx("input",{type:"text",value:new Date(o.date).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}),disabled:!0,className:"w-24 px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-slate-50 dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-center"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Kh√°ch h√†ng: ‚ÑπÔ∏è"}),Ce?e.jsxs("div",{className:"border border-slate-300 dark:border-slate-600 rounded-lg p-3 space-y-2",children:[e.jsx("input",{type:"text",value:Te,onChange:l=>Me(l.target.value),placeholder:"T√™n kh√°ch h√†ng",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"}),e.jsx("input",{type:"tel",value:Le,onChange:l=>ue(l.target.value),placeholder:"S·ªë ƒëi·ªán tho·∫°i (t√πy ch·ªçn)",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:Ee,className:"flex-1 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"L∆∞u"}),e.jsx("button",{onClick:()=>{Se(!1),Me(""),ue("")},className:"px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-300",children:"H·ªßy"})]})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:te,onChange:l=>{de(l.target.value),pe(!0)},onFocus:()=>pe(!0),placeholder:"T√¨m ki·∫øm v√† ch·ªçn m·ªôt kh√°ch h√†ng",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"}),H&&Pe.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg shadow-lg max-h-48 overflow-y-auto z-10",children:Pe.slice(0,10).map(l=>e.jsxs("button",{onClick:()=>q(l),className:"w-full px-3 py-2 text-left hover:bg-slate-100 dark:hover:bg-slate-600 text-sm",children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-slate-100",children:l.name}),l.phone&&e.jsx("div",{className:"text-xs text-slate-500",children:l.phone})]},l.id))})]}),e.jsxs("button",{onClick:()=>Se(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[e.jsx(Ft,{className:"w-4 h-4"}),"Th√™m m·ªõi"]})]})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Chi ti·∫øt s·∫£n ph·∫©m:"})}),e.jsxs("div",{className:"relative mb-3",children:[e.jsx("input",{type:"text",value:ge,onChange:l=>{V(l.target.value),Ne(!0)},onFocus:()=>Ne(!0),placeholder:"T√¨m ki·∫øm v√† th√™m s·∫£n ph·∫©m...",className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"}),be&&ge&&L.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg shadow-lg max-h-60 overflow-y-auto z-10",children:L.slice(0,10).map(l=>e.jsxs("button",{onClick:()=>J(l),className:"w-full px-3 py-2 text-left hover:bg-slate-100 dark:hover:bg-slate-600 text-sm",children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-slate-100",children:l.name}),e.jsxs("div",{className:"text-xs text-slate-500",children:["SKU: ",l.sku]})]},l.id))})]}),e.jsx("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center px-2 py-2 text-xs font-medium text-slate-500 dark:text-slate-400 w-8",children:"-"}),e.jsx("th",{className:"text-left px-3 py-2 text-xs font-medium text-slate-500 dark:text-slate-400",children:"T√™n"}),e.jsx("th",{className:"text-center px-3 py-2 text-xs font-medium text-slate-500 dark:text-slate-400 w-20",children:"SL"}),e.jsx("th",{className:"text-right px-3 py-2 text-xs font-medium text-slate-500 dark:text-slate-400 w-24",children:"ƒê∆°n gi√°"}),e.jsx("th",{className:"text-right px-3 py-2 text-xs font-medium text-slate-500 dark:text-slate-400 w-28",children:"Th√†nh ti·ªÅn"}),e.jsx("th",{className:"w-10"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700",children:M.map((l,y)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 text-center text-sm text-slate-900 dark:text-slate-100",children:y+1}),e.jsxs("td",{className:"px-3 py-2 text-sm",children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-slate-100",children:l.partName}),e.jsx("div",{className:"text-xs text-slate-500",children:l.sku})]}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("input",{type:"number",value:l.quantity,onChange:S=>j(l.partId,parseInt(S.target.value)||0),min:"1",className:"w-full px-2 py-1 border border-slate-300 dark:border-slate-600 rounded text-center text-sm bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("input",{type:"number",value:l.sellingPrice,onChange:S=>Ye(l.partId,parseFloat(S.target.value)||0),min:"0",step:"1000",className:"w-full px-2 py-1 border border-slate-300 dark:border-slate-600 rounded text-right text-sm bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"})}),e.jsx("td",{className:"px-3 py-2 text-right text-sm font-semibold text-slate-900 dark:text-slate-100",children:m(l.quantity*l.sellingPrice)}),e.jsx("td",{className:"px-2 py-2 text-center",children:e.jsx("button",{onClick:()=>ke(l.partId),className:"text-slate-400 hover:text-red-600 transition-colors",children:e.jsx(Gt,{className:"w-5 h-5"})})})]},l.partId))})]})}),M.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Ch∆∞a c√≥ s·∫£n ph·∫©m n√†o"}),M.length>0&&e.jsxs("div",{className:"mt-2 text-right",children:[e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"T·ªîNG:"}),e.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:m(Z)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Ch·ªçn nh√¢n vi√™n b√°n h√†ng"}),e.jsx("select",{disabled:!0,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-slate-50 dark:bg-slate-700 text-slate-900 dark:text-slate-100",children:e.jsx("option",{children:o.username||o.userName})})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"C√¥ng n·ª£:"}),e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-400 mb-3",children:"Kh√°ch h√†ng ph·∫£i thanh to√°n"}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3 mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-green-700 dark:text-green-400",children:"T·ªîNG PH·∫¢I THU:"}),e.jsx("span",{className:"text-lg font-bold text-green-700 dark:text-green-400",children:m(fe)})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-green-600 dark:text-green-400",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"ƒê√£ thanh to√°n ƒë·ªß"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-2",children:"- Th·ªùi gian Ng∆∞·ªùi thu - Ghi ch√∫"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>he("cash"),className:`flex-1 py-2 rounded-lg border transition-colors text-sm font-medium ${X==="cash"?"bg-green-600 text-white border-green-600":"border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700"}`,children:"Ti·ªÅn m·∫∑t"}),e.jsx("button",{onClick:()=>he("bank"),className:`flex-1 py-2 rounded-lg border transition-colors text-sm font-medium ${X==="bank"?"bg-blue-600 text-white border-blue-600":"border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700"}`,children:"Chuy·ªÉn kho·∫£n"})]})]}),e.jsx("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center px-2 py-2 text-xs font-medium text-slate-500 dark:text-slate-400",children:"-"}),e.jsx("th",{className:"text-left px-3 py-2 text-xs font-medium text-slate-500 dark:text-slate-400",children:"Th·ªùi gian"}),e.jsx("th",{className:"text-left px-3 py-2 text-xs font-medium text-slate-500 dark:text-slate-400",children:"Ng∆∞·ªùi thu - Ghi ch√∫"}),e.jsx("th",{className:"text-right px-3 py-2 text-xs font-medium text-slate-500 dark:text-slate-400",children:"S·ªë ti·ªÅn"}),e.jsx("th",{className:"w-10"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-slate-800",children:e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 text-center text-slate-900 dark:text-slate-100",children:"1"}),e.jsxs("td",{className:"px-3 py-2",children:[e.jsxs("div",{className:"text-slate-900 dark:text-slate-100",children:[new Date(o.date).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})," ",ot(new Date(o.date),!1)]}),e.jsx("div",{className:"text-xs text-slate-500",children:"(Ti·ªÅn m·∫∑t)"})]}),e.jsx("td",{className:"px-3 py-2 text-slate-900 dark:text-slate-100",children:o.username||o.userName}),e.jsx("td",{className:"px-3 py-2 text-right text-slate-900 dark:text-slate-100",children:m(fe)}),e.jsx("td",{})]})})]})}),e.jsxs("div",{className:"mt-2 text-right",children:[e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"T·ªïng ƒë√£ thu"}),e.jsx("div",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:m(fe)})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-700",children:[e.jsx("button",{onClick:g,className:"px-6 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-600 transition-colors font-medium",children:"ƒê√ìNG"}),e.jsx("button",{onClick:se,disabled:M.length===0,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-semibold",children:"L∆ØU"})]})]})})},As=({isOpen:Y,onClose:g,sales:o,currentBranchId:O,onPrintReceipt:U,onEditSale:p,onDeleteSale:z,page:Q,totalPages:ne,total:M,hasMore:$,pageSize:Qe,onPrevPage:ye,onNextPage:X,onPageSizeChange:he,search:we,onSearchChange:Xe,fromDate:ge,toDate:V,onDateRangeChange:be,status:Ne="all",onStatusChange:Ce,paymentMethodFilter:Se="all",onPaymentMethodFilterChange:Te,keysetMode:Me=!1,onToggleKeyset:Le,customerDebts:ue=[]})=>{const[te,de]=a.useState("7days"),[H,pe]=a.useState(""),[Z,fe]=a.useState(""),[L,Pe]=a.useState(""),[J,q]=a.useState(null),[Ee,j]=a.useState(!1),[Ye,ke]=a.useState(!1),[se,l]=a.useState(null),[y,S]=a.useState({top:0,right:0});a.useEffect(()=>{const r=new Date,h=new Date(r.getFullYear(),r.getMonth(),r.getDate()),_=new Date(r.getFullYear(),r.getMonth(),r.getDate(),23,59,59,999);let B,A;switch(te){case"today":B=h,A=_;break;case"week":{const f=r.getDay(),R=f===0?-6:1-f,P=new Date(r);P.setDate(r.getDate()+R),B=new Date(P.getFullYear(),P.getMonth(),P.getDate()),A=_;break}case"month":{B=new Date(r.getFullYear(),r.getMonth(),1),A=_;break}case"7days":{const f=new Date(r);f.setDate(f.getDate()-6),B=new Date(f.getFullYear(),f.getMonth(),f.getDate()),A=_;break}case"30days":{const f=new Date(r);f.setDate(f.getDate()-29),B=new Date(f.getFullYear(),f.getMonth(),f.getDate()),A=_;break}case"custom":{Z&&L&&(B=new Date(Z),A=new Date(L+"T23:59:59"));break}case"all":B=void 0,A=void 0;break}be(B?B.toISOString():void 0,A?A.toISOString():void 0)},[te,Z,L,be]);const ee=a.useMemo(()=>{let r=o.filter(h=>h.branchId===O||h.branchid===O);return H&&(r=r.filter(h=>h.id.toLowerCase().includes(H.toLowerCase())||(h.sale_code||"").toLowerCase().includes(H.toLowerCase())||h.customer.name.toLowerCase().includes(H.toLowerCase())||(h.username||h.userName||"").toLowerCase().includes(H.toLowerCase()))),r.sort((h,_)=>new Date(_.date).getTime()-new Date(h.date).getTime()),r},[o,O,H]),F=a.useMemo(()=>ee.reduce((r,h)=>r+h.total,0),[ee]);return a.useEffect(()=>{const r=h=>{h.target.closest(".dropdown-menu-container")||l(null)};if(se)return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[se]),Y?e.jsxs(Rt.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex md:items-center md:justify-center items-end justify-center p-0 md:p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 w-full md:max-w-7xl max-h-[95vh] md:rounded-2xl rounded-t-3xl shadow-2xl overflow-hidden flex flex-col animate-slide-up-bottom",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700 bg-white/95 dark:bg-slate-900/70 backdrop-blur",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-400 dark:text-slate-500",children:"L·ªãch s·ª≠ b√°n h√†ng"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:"Theo d√µi giao d·ªãch g·∫ßn ƒë√¢y"})]}),e.jsx("button",{onClick:g,className:"text-slate-500 hover:text-slate-900 dark:hover:text-white text-2xl leading-none px-2","aria-label":"ƒê√≥ng l·ªãch s·ª≠ b√°n h√†ng",children:"√ó"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1 -mx-4 px-4 md:mx-0 md:px-0 scrollbar-thin",children:[{key:"7days",label:"7 ng√†y qua"},{key:"week",label:"Tu·∫ßn"},{key:"month",label:"Th√°ng"},{key:"30days",label:"30 ng√†y qua"},{key:"custom",label:"T√πy ch·ªçn"},{key:"all",label:"T·∫•t c·∫£"}].map(r=>e.jsx("button",{onClick:()=>de(r.key),className:`px-4 py-2 rounded-2xl text-sm font-medium whitespace-nowrap border transition-all min-w-[96px] ${te===r.key?"bg-blue-600 text-white border-blue-600 shadow-lg shadow-blue-500/30":"bg-slate-100 dark:bg-slate-800/80 text-slate-700 dark:text-slate-200 border-transparent"}`,children:r.label},r.key))}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3",children:[e.jsxs("div",{className:"w-full md:flex-1 relative",children:[e.jsx("input",{type:"text",value:H,onChange:r=>pe(r.target.value),placeholder:"T√¨m h√≥a ƒë∆°n, kh√°ch h√†ng ho·∫∑c m√£ phi·∫øu",className:"w-full pl-10 pr-4 py-2.5 rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-50 dark:bg-slate-800 text-sm text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500"}),e.jsxs("svg",{className:"w-5 h-5 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 19a8 8 0 100-16 8 8 0 000 16z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-4.3-4.3"})]})]}),e.jsx("div",{className:"flex items-center justify-between md:justify-end gap-4 w-full md:w-auto",children:e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"T·ªïng doanh thu"}),e.jsx("div",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:m(F)})]})})]}),te==="custom"&&e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3",children:[e.jsxs("label",{className:"text-sm text-slate-600 dark:text-slate-400 flex items-center gap-2",children:["T·ª´",e.jsx("input",{type:"date",value:Z,onChange:r=>fe(r.target.value),className:"px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 text-sm"})]}),e.jsxs("label",{className:"text-sm text-slate-600 dark:text-slate-400 flex items-center gap-2",children:["ƒê·∫øn",e.jsx("input",{type:"date",value:L,onChange:r=>Pe(r.target.value),className:"px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 text-sm"})]})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:ee.length===0?e.jsx("div",{className:"text-center py-12 text-slate-400",children:"Kh√¥ng c√≥ h√≥a ƒë∆°n n√†o"}):e.jsxs("div",{children:[e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-4 px-4 py-3 bg-slate-100 dark:bg-slate-700 border-b border-slate-200 dark:border-slate-600 sticky top-0 z-10",children:[e.jsx("div",{className:"col-span-1 text-xs font-semibold text-slate-600 dark:text-slate-300"}),e.jsx("div",{className:"col-span-2 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"M√£ phi·∫øu"}),e.jsx("div",{className:"col-span-2 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"Kh√°ch h√†ng"}),e.jsx("div",{className:"col-span-4 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"Chi ti·∫øt"}),e.jsx("div",{className:"col-span-2 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"Thanh to√°n"}),e.jsx("div",{className:"col-span-1 text-xs font-semibold text-slate-600 dark:text-slate-300",children:"Thao t√°c"})]}),e.jsx("div",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:ee.map(r=>{var re,E,je,I,oe,et;const h=new Date(r.date);r.items.reduce((w,N)=>w+N.quantity*N.sellingPrice,0);const _=(ue||[]).find(w=>{var N;return(N=w.description)==null?void 0:N.includes(r.sale_code||r.id)}),B=_?_.totalAmount-_.remainingAmount:r.total,A=(_==null?void 0:_.remainingAmount)||0,f=A>0,P=r.items.slice(0,3),Ze=r.items.length-P.length,xt=h.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}),Je=h.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}),Ke=(((E=(re=r.customer)==null?void 0:re.name)==null?void 0:E.charAt(0))||"K").toUpperCase(),ae=r.paymentMethod==="cash"?"Ti·ªÅn m·∫∑t":"Chuy·ªÉn kho·∫£n";return e.jsxs("div",{className:"p-4 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsxs("div",{className:"md:hidden flex flex-col gap-3 bg-white dark:bg-slate-800/60 rounded-2xl border border-slate-200 dark:border-slate-700 p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[r.sale_code&&e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-blue-600 dark:text-blue-300",children:[e.jsx(Ds,{className:"w-4 h-4"}),r.sale_code]}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 flex items-center gap-1 mt-1",children:[e.jsx(Ps,{className:"w-3.5 h-3.5"}),e.jsxs("span",{children:[xt," ¬∑ ",Je]})]}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 flex items-center gap-1 mt-1",children:[e.jsx("span",{className:"font-medium text-slate-600 dark:text-slate-300",children:"NV"}),e.jsx("span",{children:r.userName||r.username||"N/A"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"T·ªïng ti·ªÅn"}),e.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-white",children:m(r.total)}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 flex items-center gap-1 justify-end mt-1",children:[r.paymentMethod==="cash"?e.jsx(Ot,{className:"w-4 h-4"}):e.jsx(Ut,{className:"w-4 h-4"}),e.jsx("span",{children:ae})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-slate-50 dark:bg-slate-900/30 rounded-2xl p-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-200 font-semibold",children:Ke}),e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-semibold text-slate-900 dark:text-white",children:((je=r.customer)==null?void 0:je.name)||"Kh√°ch v√£ng lai"}),((I=r.customer)==null?void 0:I.phone)&&e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2 5.5C2 4.119 3.12 3 4.5 3h1.76c.636 0 1.197.4 1.39 1.005l.8 2.47a1.5 1.5 0 01-.35 1.46L7.11 8.94a12.044 12.044 0 005.95 5.95l1.006-1.002a1.5 1.5 0 011.46-.349l2.469.8c.606.193 1.005.754 1.005 1.39V19.5c0 1.38-1.119 2.5-2.5 2.5h-.25C8.268 22 2 15.732 2 7.75v-.25z"})}),r.customer.phone]})]})]}),e.jsxs("div",{className:"space-y-2",children:[P.map((w,N)=>e.jsxs("div",{className:"flex items-start justify-between text-sm text-slate-700 dark:text-slate-200",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"font-semibold",children:[w.quantity," x ",w.partName]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[m(w.sellingPrice||0)," ","/ s·∫£n ph·∫©m"]})]}),e.jsx("span",{className:"font-bold text-slate-900 dark:text-white",children:m(w.quantity*(w.sellingPrice||0))})]},N)),Ze>0&&e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:["+",Ze," s·∫£n ph·∫©m kh√°c"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[f?e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-200",children:["‚ö†Ô∏è C√≤n n·ª£ ",m(A)]}):e.jsx("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-200",children:"‚úì ƒê√£ thanh to√°n"}),e.jsx("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700 dark:bg-slate-800 dark:text-slate-200",children:ae})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-3 border-t border-dashed border-slate-200 dark:border-slate-700",children:[e.jsx("button",{onClick:()=>U(r),className:"flex-1 min-w-[120px] px-3 py-2 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-200 text-sm font-medium",children:"In ho√° ƒë∆°n"}),e.jsx("button",{onClick:()=>{q(r),j(!0)},className:"flex-1 min-w-[120px] px-3 py-2 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-200 text-sm font-medium",children:"Xem chi ti·∫øt"}),e.jsx("button",{onClick:()=>{q(r),ke(!0)},className:"flex-1 min-w-[120px] px-3 py-2 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-200 text-sm font-medium",children:"Ch·ªânh s·ª≠a"}),e.jsx("button",{onClick:()=>z(r.id),className:"flex-1 min-w-[120px] px-3 py-2 rounded-xl bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-300 text-sm font-medium",children:"X√≥a ƒë∆°n"})]})]}),e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-4 items-start",children:[e.jsx("div",{className:"col-span-1 flex items-start pt-1",children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-slate-300"})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"space-y-1",children:[r.sale_code&&e.jsx("div",{className:"text-sm font-bold text-blue-600 dark:text-blue-400",children:r.sale_code}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:[h.getDate(),"/",h.getMonth()+1,"/",h.getFullYear()," ",String(h.getHours()).padStart(2,"0"),":",String(h.getMinutes()).padStart(2,"0")]}),e.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-300",children:[e.jsx("span",{className:"font-medium",children:"NV:"})," ",r.userName||r.username||"N/A"]})]})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100",children:((oe=r.customer)==null?void 0:oe.name)||"Kh√°ch v√£ng lai"}),((et=r.customer)==null?void 0:et.phone)&&e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:["üìû ",r.customer.phone]})]})}),e.jsx("div",{className:"col-span-4",children:e.jsx("div",{className:"space-y-1",children:r.items.map((w,N)=>e.jsxs("div",{className:"text-xs text-slate-700 dark:text-slate-300",children:[e.jsxs("span",{className:"font-medium",children:[w.quantity," x"]})," ",w.partName,e.jsxs("span",{className:"text-slate-400 ml-1",children:["(",m(w.sellingPrice||0),")"]})," = ",e.jsx("span",{className:"font-semibold text-slate-900 dark:text-slate-100",children:m(w.quantity*(w.sellingPrice||0))})]},N))})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"T·ªïng ti·ªÅn:"}),e.jsx("div",{className:"text-base font-bold text-slate-900 dark:text-slate-100",children:m(r.total)}),f?e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400",children:["ƒê√£ tr·∫£: ",m(B)]}),e.jsxs("div",{className:"text-xs font-semibold text-red-600 dark:text-red-400",children:["C√≤n n·ª£: ",m(A)]}),e.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-medium bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300",children:"‚ö†Ô∏è C√≤n n·ª£"})]}):e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",children:"‚úì ƒê√£ thanh to√°n"})}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:r.paymentMethod==="cash"?"üíµ Ti·ªÅn m·∫∑t":"üè¶ Chuy·ªÉn kho·∫£n"})]})}),e.jsxs("div",{className:"col-span-1 flex items-start justify-end gap-2 pt-1",children:[e.jsx("button",{onClick:()=>{q(r),ke(!0)},className:"p-1.5 text-slate-400 hover:text-amber-600 dark:hover:text-amber-400 transition-colors",title:"Ch·ªânh s·ª≠a",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsxs("div",{className:"relative dropdown-menu-container",children:[e.jsx("button",{onClick:w=>{const N=w.currentTarget.getBoundingClientRect();S({top:N.bottom+4,right:window.innerWidth-N.right}),l(se===r.id?null:r.id)},className:"p-1.5 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 transition-colors",title:"T√πy ch·ªçn",children:e.jsxs("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"12",cy:"5",r:"2"}),e.jsx("circle",{cx:"12",cy:"12",r:"2"}),e.jsx("circle",{cx:"12",cy:"19",r:"2"})]})}),se===r.id&&e.jsxs("div",{className:"fixed w-48 bg-white dark:bg-slate-800 rounded-lg shadow-lg border border-slate-200 dark:border-slate-700 z-[9999]",style:{top:y.top,right:y.right},children:[e.jsxs("button",{onClick:()=>{U(r),l(null)},className:"w-full text-left px-4 py-2.5 text-sm text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 flex items-center gap-2 rounded-t-lg",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"In l·∫°i h√≥a ƒë∆°n"]}),e.jsxs("button",{onClick:()=>{q(r),j(!0),l(null)},className:"w-full text-left px-4 py-2.5 text-sm text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 flex items-center gap-2",children:[e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Xem chi ti·∫øt"]}),e.jsxs("button",{onClick:()=>{z&&z(r.id),l(null)},className:"w-full text-left px-4 py-2.5 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center gap-2 rounded-b-lg",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"X√≥a h√≥a ƒë∆°n"]})]})]})]})]})]},r.id)})})]})}),e.jsx("div",{className:"p-4 border-t border-slate-200 dark:border-slate-700 flex items-center justify-between",children:e.jsxs("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Hi·ªÉn th·ªã ",ee.length," ƒë∆°n h√†ng"]})})]})}),e.jsx(_s,{isOpen:Ee,onClose:()=>{j(!1),q(null)},sale:J,onPrint:U}),e.jsx(Bs,{isOpen:Ye,onClose:()=>{ke(!1),q(null)},sale:J,onSave:async r=>{try{const{supabase:h}=await it(async()=>{const{supabase:R}=await import("./index-B2tLSL14.js").then(P=>P.bo);return{supabase:R}},__vite__mapDeps([0,1])),{profile:_}=await it(async()=>{const{profile:R}=await import("./index-B2tLSL14.js").then(P=>P.bp);return{profile:R}},__vite__mapDeps([0,1])).then(R=>({profile:null})),A=r.items.reduce((R,P)=>R+P.quantity*P.sellingPrice,0)-r.discount,{error:f}=await h.from("sales").update({items:r.items,customer:r.customer,paymentmethod:r.paymentMethod,discount:r.discount,total:A}).eq("id",r.id);if(f)throw f;await Vt(null,{action:"sale_update",tableName:"sales",recordId:r.id,newData:{items:r.items,customer:r.customer,paymentMethod:r.paymentMethod,discount:r.discount,total:A}}),queryClient.invalidateQueries({queryKey:["salesRepo"]}),queryClient.invalidateQueries({queryKey:["salesRepoPaged"]}),queryClient.invalidateQueries({queryKey:["salesRepoKeyset"]}),u.success("ƒê√£ c·∫≠p nh·∫≠t ƒë∆°n h√†ng th√†nh c√¥ng"),ke(!1),q(null)}catch(h){console.error("Error updating sale:",h),u.error("L·ªói khi c·∫≠p nh·∫≠t ƒë∆°n h√†ng: "+h.message)}}})]}):null},Fs=()=>{const{upsertCustomer:Y,cartItems:g,setCartItems:o,clearCart:O,deleteSale:U,currentBranchId:p,finalizeSale:z,setCashTransactions:Q,setPaymentSources:ne}=Ht(),M=Et(),{data:$=[],isLoading:Qe}=ks(),ye=js(),{data:X=[],isLoading:he,error:we}=Kt(),{data:Xe=[]}=Cs(),[ge,V]=a.useState(1),[be,Ne]=a.useState(20),[Ce,Se]=a.useState(""),[Te,Me]=a.useState(""),[Le,ue]=a.useState(),[te,de]=a.useState(),[H,pe]=a.useState("all"),[Z,fe]=a.useState("all"),[L,Pe]=a.useState(!1),[J,q]=a.useState(null),Ee={branchId:p,page:L?void 0:ge,pageSize:be,search:Te||void 0,fromDate:Le,toDate:te,mode:L?"keyset":"offset",afterDate:L?J==null?void 0:J.afterDate:void 0,afterId:L?J==null?void 0:J.afterId:void 0,status:H==="all"?void 0:H==="cancelled"?"refunded":H==="completed"?"completed":H,paymentMethod:Z==="all"?void 0:Z},{data:j,isLoading:Ye,error:ke}=vs(Ee),se=(j==null?void 0:j.data)||[],l=(j==null?void 0:j.meta)||{page:1,totalPages:1,total:se.length,hasMore:!1};a.useEffect(()=>{var t;L&&((t=j==null?void 0:j.meta)==null?void 0:t.mode)==="keyset"&&q({afterDate:j.meta.nextAfterDate,afterId:j.meta.nextAfterId})},[L,j]);const{mutateAsync:y}=ys(),S=Ss(),ee=a.useCallback(()=>V(t=>Math.max(1,t-1)),[]),F=a.useCallback(()=>V(t=>t+1),[]),r=a.useCallback(t=>{Ne(t),V(1),L&&q(null)},[]);a.useEffect(()=>{const t=setTimeout(()=>{Me(Ce),V(1)},300);return()=>clearTimeout(t)},[Ce]);const[h,_]=a.useState(""),[B,A]=a.useState("all"),[f,R]=a.useState(""),[P,Ze]=a.useState(!1),[xt,Je]=a.useState(!1),Ke=a.useRef(null),[ae,re]=a.useState(""),[E,je]=a.useState("products"),[I,oe]=a.useState(null),[et,w]=a.useState(!1),[N,De]=a.useState(0),[ze,Ct]=a.useState("amount"),[St,tt]=a.useState(0),[Qt,st]=a.useState(!1),[Xt,We]=a.useState(!1),[K,ve]=a.useState({name:"",phone:"",vehicleModel:"",licensePlate:""}),[Tt,Mt]=a.useState(""),[Ie,mt]=a.useState(""),[ie,ht]=a.useState(""),[Oe,Lt]=a.useState([]),[at,Pt]=a.useState(0),[le,gt]=a.useState(null),[G,rt]=a.useState(null),[_e,lt]=a.useState(0),[bt,Yt]=a.useState(!1),[ut,Dt]=a.useState(!0),[pt,Zt]=a.useState(!1),[Jt,es]=a.useState(""),[ts,ss]=a.useState("");a.useEffect(()=>{var t;P&&((t=Ke.current)==null||t.focus())},[P]);const[as,ft]=a.useState(!1),[k,kt]=a.useState(null),[i,rs]=a.useState(null);a.useEffect(()=>{(async()=>{try{const{data:s,error:n}=await At.from("store_settings").select("store_name, address, phone, email, logo_url, bank_qr_url, bank_name, bank_account_number, bank_account_holder, bank_branch").order("created_at",{ascending:!1}).limit(1).single();if(n){console.error("Error fetching store settings:",n);return}rs(s)}catch(s){console.error("Failed to fetch store settings:",s)}})()},[]);const Re=a.useCallback(t=>{var c,x;const s=((c=t.retailPrice)==null?void 0:c[p])??0,n=((x=t.stock)==null?void 0:x[p])??0,d=g.find(b=>b.partId===t.id);if(d){const b=d.quantity+1;if(b>n){u.error(`Kh√¥ng ƒë·ªß h√†ng! T·ªìn kho: ${n}`);return}o(C=>C.map(T=>T.partId===t.id?{...T,quantity:b}:T))}else{if(n<1){u.error("S·∫£n ph·∫©m ƒë√£ h·∫øt h√†ng!");return}const b={partId:t.id,partName:t.name,sku:t.sku,quantity:1,sellingPrice:s,stockSnapshot:n,discount:0};o(C=>[...C,b])}},[g,o,p]),zt=a.useCallback(t=>{o(s=>s.filter(n=>n.partId!==t))},[o]),Ve=a.useCallback((t,s)=>{if(s<=0){zt(t);return}const n=g.find(d=>d.partId===t);if(n&&s>n.stockSnapshot){u.error(`Kh√¥ng ƒë·ªß h√†ng! T·ªìn kho: ${n.stockSnapshot}`);return}o(d=>d.map(c=>c.partId===t?{...c,quantity:s}:c))},[g,o,zt]),ce=a.useMemo(()=>g.reduce((t,s)=>t+s.sellingPrice*s.quantity,0),[g]),It=a.useMemo(()=>Math.max(0,ce-N),[ce,N]),ls=a.useMemo(()=>{const t=new Map;return g.forEach(s=>t.set(s.partId,s)),t},[g]),Be=t=>{if(!t)return{bg:"bg-slate-100 dark:bg-slate-700",text:"text-slate-500 dark:text-slate-400"};const s={Nh·ªõt:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-400"},D·∫ßu:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-400"},L·ªçc:{bg:"bg-cyan-100 dark:bg-cyan-900/30",text:"text-cyan-700 dark:text-cyan-400"},"L·ªçc gi√≥":{bg:"bg-cyan-100 dark:bg-cyan-900/30",text:"text-cyan-700 dark:text-cyan-400"},"L·ªçc nh·ªõt":{bg:"bg-cyan-100 dark:bg-cyan-900/30",text:"text-cyan-700 dark:text-cyan-400"},Bugi:{bg:"bg-rose-100 dark:bg-rose-900/30",text:"text-rose-700 dark:text-rose-400"},Phanh:{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-400"},"M√° phanh":{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-400"},X√≠ch:{bg:"bg-zinc-200 dark:bg-zinc-700/50",text:"text-zinc-700 dark:text-zinc-300"},S√™n:{bg:"bg-zinc-200 dark:bg-zinc-700/50",text:"text-zinc-700 dark:text-zinc-300"},"Nh√¥ng s√™n dƒ©a":{bg:"bg-zinc-200 dark:bg-zinc-700/50",text:"text-zinc-700 dark:text-zinc-300"},L·ªëp:{bg:"bg-slate-700 dark:bg-slate-600",text:"text-white dark:text-slate-100"},"V·ªè xe":{bg:"bg-slate-700 dark:bg-slate-600",text:"text-white dark:text-slate-100"},"·∫Æc quy":{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-700 dark:text-green-400"},"B√¨nh ƒëi·ªán":{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-700 dark:text-green-400"},ƒê√®n:{bg:"bg-yellow-100 dark:bg-yellow-900/30",text:"text-yellow-700 dark:text-yellow-400"},"B√≥ng ƒë√®n":{bg:"bg-yellow-100 dark:bg-yellow-900/30",text:"text-yellow-700 dark:text-yellow-400"},ƒêi·ªán:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-400"},IC:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-400"},GioƒÉng:{bg:"bg-orange-100 dark:bg-orange-900/30",text:"text-orange-700 dark:text-orange-400"},Ron:{bg:"bg-orange-100 dark:bg-orange-900/30",text:"text-orange-700 dark:text-orange-400"},"V√≤ng bi":{bg:"bg-indigo-100 dark:bg-indigo-900/30",text:"text-indigo-700 dark:text-indigo-400"},"B·∫°c ƒë·∫°n":{bg:"bg-indigo-100 dark:bg-indigo-900/30",text:"text-indigo-700 dark:text-indigo-400"},"Cao su":{bg:"bg-stone-200 dark:bg-stone-700/50",text:"text-stone-700 dark:text-stone-300"},"Ph·ª• ki·ªán":{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-700 dark:text-purple-400"},Honda:{bg:"bg-red-100 dark:bg-red-900/40",text:"text-red-700 dark:text-red-400"},Yamaha:{bg:"bg-blue-100 dark:bg-blue-900/40",text:"text-blue-700 dark:text-blue-400"},Suzuki:{bg:"bg-blue-200 dark:bg-blue-900/50",text:"text-blue-800 dark:text-blue-300"},SYM:{bg:"bg-sky-100 dark:bg-sky-900/40",text:"text-sky-700 dark:text-sky-400"},Piaggio:{bg:"bg-emerald-100 dark:bg-emerald-900/40",text:"text-emerald-700 dark:text-emerald-400"},Vespa:{bg:"bg-emerald-100 dark:bg-emerald-900/40",text:"text-emerald-700 dark:text-emerald-400"},Kymco:{bg:"bg-orange-100 dark:bg-orange-900/40",text:"text-orange-700 dark:text-orange-400"},NGK:{bg:"bg-green-100 dark:bg-green-900/40",text:"text-green-700 dark:text-green-400"},Denso:{bg:"bg-rose-100 dark:bg-rose-900/40",text:"text-rose-700 dark:text-rose-400"},DENSO:{bg:"bg-rose-100 dark:bg-rose-900/40",text:"text-rose-700 dark:text-rose-400"},Kenda:{bg:"bg-amber-100 dark:bg-amber-900/40",text:"text-amber-700 dark:text-amber-400"},IRC:{bg:"bg-violet-100 dark:bg-violet-900/40",text:"text-violet-700 dark:text-violet-400"},"IRC Tire":{bg:"bg-violet-100 dark:bg-violet-900/40",text:"text-violet-700 dark:text-violet-400"},Michelin:{bg:"bg-indigo-100 dark:bg-indigo-900/40",text:"text-indigo-700 dark:text-indigo-400"},Dunlop:{bg:"bg-yellow-100 dark:bg-yellow-900/40",text:"text-yellow-700 dark:text-yellow-400"},Castrol:{bg:"bg-lime-100 dark:bg-lime-900/40",text:"text-lime-700 dark:text-lime-400"},Shell:{bg:"bg-amber-100 dark:bg-amber-900/40",text:"text-amber-700 dark:text-amber-400"},Motul:{bg:"bg-red-100 dark:bg-red-900/40",text:"text-red-700 dark:text-red-400"},Bosch:{bg:"bg-slate-200 dark:bg-slate-700/50",text:"text-slate-700 dark:text-slate-300"},Kh√°c:{bg:"bg-slate-100 dark:bg-slate-700",text:"text-slate-600 dark:text-slate-400"}};if(s[t])return s[t];const n=t.toLowerCase();for(const[x,b]of Object.entries(s))if(n.includes(x.toLowerCase())||x.toLowerCase().includes(n))return b;const d=[{bg:"bg-pink-100 dark:bg-pink-900/30",text:"text-pink-700 dark:text-pink-400"},{bg:"bg-violet-100 dark:bg-violet-900/30",text:"text-violet-700 dark:text-violet-400"},{bg:"bg-teal-100 dark:bg-teal-900/30",text:"text-teal-700 dark:text-teal-400"},{bg:"bg-lime-100 dark:bg-lime-900/30",text:"text-lime-700 dark:text-lime-400"},{bg:"bg-fuchsia-100 dark:bg-fuchsia-900/30",text:"text-fuchsia-700 dark:text-fuchsia-400"},{bg:"bg-emerald-100 dark:bg-emerald-900/30",text:"text-emerald-700 dark:text-emerald-400"}],c=t.split("").reduce((x,b)=>x+b.charCodeAt(0),0);return d[c%d.length]},jt=a.useMemo(()=>Oe.reduce((t,s)=>t+s.sellingPrice*s.quantity,0),[Oe]),ns=a.useMemo(()=>Math.max(0,jt-at),[jt,at]),ds=a.useMemo(()=>Oe.reduce((t,s)=>t+s.quantity,0),[Oe]),xe=a.useMemo(()=>{if(he||we)return[];let t=X;return h&&(t=t.filter(s=>s.name.toLowerCase().includes(h.toLowerCase())||s.sku.toLowerCase().includes(h.toLowerCase()))),t},[X,h,he,we]),vt=a.useMemo(()=>{if(!xe.length)return[];const t=xe.filter(n=>{var c;const d=Number(((c=n.stock)==null?void 0:c[p])??0);return B==="low"?d>0&&d<=dt:B==="out"?d<=0:!0}),s=n=>n<=0?2:n<=dt?1:0;return t.slice().sort((n,d)=>{var C,T;const c=Number(((C=n.stock)==null?void 0:C[p])??0),x=Number(((T=d.stock)==null?void 0:T[p])??0),b=s(c)-s(x);return b!==0?b:n.name.localeCompare(d.name)}).slice(0,36)},[xe,B,p]),Ae=t=>t.toLowerCase().replace(/[-\s./\\]/g,""),os=t=>{if(t.preventDefault(),!f.trim())return;const s=f.trim(),n=Ae(s),d=xe.find(c=>{var x,b,C;return Ae(c.barcode||"")===n||((x=c.barcode)==null?void 0:x.toLowerCase())===s.toLowerCase()||Ae(c.sku||"")===n||((b=c.sku)==null?void 0:b.toLowerCase())===s.toLowerCase()||((C=c.name)==null?void 0:C.toLowerCase().includes(s.toLowerCase()))});d?(Re(d),u.success(`ƒê√£ th√™m ${d.name} v√†o gi·ªè h√†ng`),R(""),setTimeout(()=>{var c;return(c=Ke.current)==null?void 0:c.focus()},100)):(u.error(`Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m c√≥ m√£: ${s}`),R(""))},is=t=>{console.log("üì∑ Camera scanned:",t);const s=Ae(t),n=X.find(d=>{var c,x;return Ae(d.barcode||"")===s||((c=d.barcode)==null?void 0:c.toLowerCase())===t.toLowerCase()||Ae(d.sku||"")===s||((x=d.sku)==null?void 0:x.toLowerCase())===t.toLowerCase()});if(n){const d=g.find(c=>c.partId===n.id);d?Ve(n.id,d.quantity+1):(Re(n),u.success(`ƒê√£ th√™m ${n.name}`))}else u.error(`Kh√¥ng t√¨m th·∫•y: ${t}`)},{lowStockCount:Fe,outOfStockCount:Ge}=Is(X,p,dt),cs=[{key:"all",label:"T·∫•t c·∫£",count:xe.length,activeClass:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white border-transparent shadow-blue-500/30",inactiveClass:"bg-white/80 dark:bg-slate-900/50 text-slate-700 dark:text-slate-200 border border-slate-200 dark:border-slate-700"},{key:"low",label:"T·ªìn th·∫•p",count:Fe,activeClass:"bg-gradient-to-r from-amber-500 to-orange-500 text-white border-transparent shadow-amber-500/30",inactiveClass:"bg-white/80 dark:bg-slate-900/50 text-amber-700 dark:text-amber-200 border border-amber-200/70 dark:border-amber-800/60"},{key:"out",label:"H·∫øt h√†ng",count:Ge,activeClass:"bg-gradient-to-r from-rose-500 to-red-500 text-white border-transparent shadow-rose-500/30",inactiveClass:"bg-white/80 dark:bg-slate-900/50 text-rose-700 dark:text-rose-200 border border-rose-200/70 dark:border-rose-800/60"}],_t=a.useRef(!1);a.useEffect(()=>{if(!_t.current&&(Fe>0||Ge>0)){const t=[];Ge>0&&t.push(`H·∫øt h√†ng: ${Ge}`),Fe>0&&t.push(`T·ªìn th·∫•p: ${Fe}`),u.info(t.join(" ¬∑ ")),_t.current=!0}},[Fe,Ge]);const Bt=a.useMemo(()=>ae?$.filter(t=>{var s;return t.name.toLowerCase().includes(ae.toLowerCase())||((s=t.phone)==null?void 0:s.includes(ae))||!1}).slice(0,10):$.slice(0,10),[$,ae]),xs=()=>{if(!K.name||!K.phone){alert("Vui l√≤ng nh·∫≠p t√™n v√† s·ªë ƒëi·ªán tho·∫°i");return}if($.find(n=>n.phone===K.phone)){alert("S·ªë ƒëi·ªán tho·∫°i n√†y ƒë√£ t·ªìn t·∫°i!");return}const s={id:`CUST-${Date.now()}`,name:K.name,phone:K.phone,vehicleModel:K.vehicleModel,licensePlate:K.licensePlate,status:"active",segment:"New",loyaltyPoints:0,totalSpent:0,visitCount:1,lastVisit:new Date().toISOString(),created_at:new Date().toISOString()};ye.mutate(s,{onSuccess:()=>{oe(s),re(s.name),ve({name:"",phone:"",vehicleModel:"",licensePlate:""}),We(!1),u.success("ƒê√£ th√™m kh√°ch h√†ng m·ªõi!")},onError:n=>{console.error("Error creating customer:",n),u.error("Kh√¥ng th·ªÉ th√™m kh√°ch h√†ng. Vui l√≤ng th·ª≠ l·∫°i.")}})},ms=t=>{kt(t),ft(!0)},yt=a.useRef(null),hs=async()=>{if(!(!yt.current||!k))try{u.info("ƒêang t·∫°o h√¨nh ·∫£nh...");const t=(await it(async()=>{const{default:b}=await import("./html2canvas.esm-QH1iLAAe.js");return{default:b}},[])).default,s=await t(yt.current,{backgroundColor:"#ffffff",scale:2,useCORS:!0,allowTaint:!0}),n=await new Promise(b=>{s.toBlob(C=>b(C),"image/png",1)}),d=`hoa-don-${k.sale_code||He(k.id)||k.id}.png`;if(navigator.share&&navigator.canShare){const b=new File([n],d,{type:"image/png"}),C={files:[b]};if(navigator.canShare(C)){await navigator.share({files:[b],title:"H√≥a ƒë∆°n b√°n h√†ng",text:`H√≥a ƒë∆°n ${k.sale_code||He(k.id)}`}),u.success("ƒê√£ chia s·∫ª h√≥a ƒë∆°n!");return}}const c=URL.createObjectURL(n),x=document.createElement("a");x.href=c,x.download=d,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(c),u.success("ƒê√£ t·∫£i xu·ªëng h√¨nh ·∫£nh h√≥a ƒë∆°n!")}catch(t){console.error("Share error:",t),u.error("Kh√¥ng th·ªÉ chia s·∫ª h√≥a ƒë∆°n")}},gs=()=>{if(!k)return;Mt(k.sale_code||He(k.id)||k.id),mt(k.customer.name),ht(k.customer.phone||"");const t=k.items.map(s=>({partId:s.partId||s.partid||"",partName:s.partName||s.partname||"",sku:s.sku||"",quantity:s.quantity||0,sellingPrice:s.sellingPrice||s.sellingprice||s.price||0,stockSnapshot:s.stockSnapshot||0,discount:s.discount||0}));Lt(t),Pt(k.discount||0),setTimeout(()=>{qt("last-receipt"),ft(!1),kt(null)},100)},{profile:v}=Wt(),bs=async t=>{var s;if(!Ns(v==null?void 0:v.role,"sale.delete")){u.error("B·∫°n kh√¥ng c√≥ quy·ªÅn x√≥a h√≥a ƒë∆°n");return}if(confirm("X√°c nh·∫≠n x√≥a h√≥a ƒë∆°n n√†y? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c."))try{const{deleteSaleById:n}=await it(async()=>{const{deleteSaleById:c}=await import("./index-B2tLSL14.js").then(x=>x.bq);return{deleteSaleById:c}},__vite__mapDeps([0,1])),d=await n(t);if(!d.ok){u.error(((s=d.error)==null?void 0:s.message)||"X√≥a h√≥a ƒë∆°n th·∫•t b·∫°i!");return}M.invalidateQueries({queryKey:["sales"]}),u.success("ƒê√£ x√≥a h√≥a ƒë∆°n th√†nh c√¥ng!"),Vt((v==null?void 0:v.id)||null,{action:"sale.delete",tableName:"sales",recordId:t,oldData:null,newData:null})}catch(n){u.error("X√≥a h√≥a ƒë∆°n th·∫•t b·∫°i!"),console.error("Delete sale error:",n)}},us=t=>{if(confirm("M·ªü l·∫°i h√≥a ƒë∆°n n√†y ƒë·ªÉ ch·ªânh s·ª≠a? Gi·ªè h√†ng hi·ªán t·∫°i s·∫Ω b·ªã x√≥a.")){if(O(),t.items.forEach(s=>{const n=X.find(d=>d.id===s.partId);if(n)for(let d=0;d<s.quantity;d++)Re(n)}),t.customer.id){const s=$.find(n=>n.id===t.customer.id);s&&(oe(s),re(s.name))}else mt(t.customer.name),ht(t.customer.phone||"");De(t.discount||0),st(!1),alert("H√≥a ƒë∆°n ƒë√£ ƒë∆∞·ª£c t·∫£i v√†o gi·ªè h√†ng ƒë·ªÉ ch·ªânh s·ª≠a")}},ps=async(t,s,n,d)=>{var c;if(!(s<=0)){console.log("[createCustomerDebtIfNeeded] CALLED with:",{saleId:t.id,totalAmount:n,paidAmount:d,remainingAmount:s,customerName:t.customer.name,timestamp:new Date().toISOString()});try{const x=t.customer.id||t.customer.phone||`CUST-ANON-${Date.now()}`,b=((c=t.customer.name)==null?void 0:c.trim())||t.customer.phone||"Kh√°ch l·∫ª";let T=`B√°n h√†ng - H√≥a ƒë∆°n ${t.sale_code||t.id}`;t.items&&t.items.length>0&&(T+=`

S·∫£n ph·∫©m ƒë√£ mua:`,t.items.forEach(D=>{const W=D.quantity*D.sellingPrice,$e=D.discount||0;T+=`
  ‚Ä¢ ${D.quantity} x ${D.partName} - ${m(W)}`,$e>0&&(T+=` (Gi·∫£m: ${m($e)})`)})),t.discount&&t.discount>0&&(T+=`

Gi·∫£m gi√° ƒë∆°n h√†ng: -${m(t.discount)}`);const me=t.paymentMethod==="cash"?"Ti·ªÅn m·∫∑t":"Chuy·ªÉn kho·∫£n";T+=`

Ph∆∞∆°ng th·ª©c: ${me}`,T+=`

NV: ${t.userName||"N/A"}`;const qe={customerId:x,customerName:b,phone:t.customer.phone||null,licensePlate:null,description:T,totalAmount:n,paidAmount:d,remainingAmount:s,createdDate:new Date().toISOString().split("T")[0],branchId:p,saleId:t.id};console.log("[SalesManager] createCustomerDebt payload:",qe);const Ue=await S.mutateAsync(qe);console.log("[SalesManager] createCustomerDebt result:",Ue),u.success(`ƒê√£ t·∫°o c√¥ng n·ª£ ${m(s)} cho ${b}`)}catch(x){console.error("Error creating customer debt:",x),console.error("Error details:",{message:x==null?void 0:x.message,cause:x==null?void 0:x.cause,stack:x==null?void 0:x.stack}),u.error(`Kh√¥ng th·ªÉ t·∫°o c√¥ng n·ª£ t·ª± ƒë·ªông: ${(x==null?void 0:x.message)||"L·ªói kh√¥ng x√°c ƒë·ªãnh"}`)}}},fs=async()=>{var t,s,n,d;if(g.length===0){alert("Vui l√≤ng th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng");return}if(!I&&!Ie&&!ie){alert("Vui l√≤ng nh·∫≠p th√¥ng tin kh√°ch h√†ng tr∆∞·ªõc khi b√°n h√†ng");return}if(!le){alert("Vui l√≤ng ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n");return}if(!G){alert("Vui l√≤ng ch·ªçn h√¨nh th·ª©c thanh to√°n");return}if(G==="partial"&&_e<=0){alert("Vui l√≤ng nh·∫≠p s·ªë ti·ªÅn kh√°ch tr·∫£");return}try{for(const D of g){const W=X.find(nt=>nt.id===D.partId);if(!W){u.error(`Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m: ${D.partName}`);return}const $e=((t=W.stock)==null?void 0:t[p])??0;if(D.quantity>$e){u.error(`Kh√¥ng ƒë·ªß h√†ng cho ${W.name}. T·ªìn kho: ${$e}`);return}}const c=`SALE-${Date.now()}`,x=g.reduce((D,W)=>D+W.sellingPrice*W.quantity,0),b=g.reduce((D,W)=>D+(W.discount||0),0),C=Math.max(0,x-b-N),T={id:I==null?void 0:I.id,name:(I==null?void 0:I.name)||Ie||"Kh√°ch l·∫ª",phone:(I==null?void 0:I.phone)||ie};Mt(c),mt(T.name),ht(T.phone||""),Lt([...g]),Pt(N+b),!I&&ie&&Ie&&($.find(W=>W.phone===ie)||Y({id:`CUST-${Date.now()}`,name:Ie,phone:ie,status:"active",segment:"New",loyaltyPoints:0,totalSpent:0,visitCount:1,lastVisit:new Date().toISOString(),created_at:new Date().toISOString()}));const me=await y({id:c,items:g,discount:N+b,customer:T,paymentMethod:le,userId:(v==null?void 0:v.id)||"local-user",userName:(v==null?void 0:v.email)||(v==null?void 0:v.full_name)||"Local User",branchId:p});if(me!=null&&me.error)throw me.error;const qe=G==="full"?C:G==="partial"?_e:0,Ue=C-qe;if(console.log("[SalesManager] Payment details:",{paymentType:G,total:C,paidAmount:qe,partialAmount:_e,remainingAmount:Ue,hasCustomer:!!(I||Ie||ie)}),Ue>0){console.log("[SalesManager] Creating debt because remaining > 0");const{data:D,error:W}=await At.from("sales").select(`
            *,
            user:userid(
              full_name,
              display_name,
              email
            )
          `).eq("id",c).single();W&&console.error("[SalesManager] Error fetching sale:",W);const nt=(D?{...D,userName:((s=D.user)==null?void 0:s.full_name)||((n=D.user)==null?void 0:n.display_name)||((d=D.user)==null?void 0:d.email)||"N/A"}:null)||{id:c,sale_code:void 0,date:new Date().toISOString(),items:g,subtotal:ce,discount:N+b,total:C,customer:T,paymentMethod:le,userName:(v==null?void 0:v.email)||(v==null?void 0:v.full_name)||"Local User",userId:(v==null?void 0:v.id)||"",branchId:p||""};console.log("[SalesManager] Sale data for debt:",nt),await ps(nt,Ue,C,qe)}else console.log("[SalesManager] No debt needed, paid in full");oe(null),re(""),De(0),tt(0),Ct("amount"),gt(null),rt(null),lt(0),O(),bt&&setTimeout(()=>{qt("last-receipt")},100)}catch(c){console.error("Error finalizing sale (atomic):",c),u.error((c==null?void 0:c.message)||"C√≥ l·ªói khi t·∫°o h√≥a ƒë∆°n (atomic)")}};return a.useEffect(()=>{const t=s=>{s.target.closest(".customer-dropdown-container")||w(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]),e.jsxs("div",{className:"min-h-screen max-w-full overflow-x-hidden bg-gradient-to-br from-slate-50 via-blue-50/20 to-indigo-50/30 dark:from-slate-900 dark:via-slate-900 dark:to-slate-800 pb-16 md:pb-0",children:[e.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-50 bg-white dark:bg-slate-800 border-t border-slate-200 dark:border-slate-700 safe-area-bottom",children:[e.jsx("div",{className:"absolute inset-0 bg-white/80 dark:bg-slate-800/80 backdrop-blur-lg -z-10"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 px-2 py-2",children:[e.jsxs("button",{onClick:()=>je("products"),className:`flex flex-col items-center gap-1 px-1 py-1.5 rounded-lg transition-all duration-200 ${E==="products"?"text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/30":"text-slate-600 dark:text-slate-400 active:scale-95"}`,children:[e.jsx(wt,{className:`w-6 h-6 transition-transform ${E==="products"?"scale-105":""}`}),e.jsx("span",{className:`text-[9px] font-medium ${E==="products"?"font-semibold":""}`,children:"S·∫£n ph·∫©m"})]}),e.jsxs("button",{onClick:()=>je("cart"),className:`flex flex-col items-center gap-1 px-1 py-1.5 rounded-lg transition-all duration-200 relative ${E==="cart"?"text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-900/30":"text-slate-600 dark:text-slate-400 active:scale-95"}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx(Nt,{className:`w-6 h-6 transition-transform ${E==="cart"?"scale-105":""}`}),g.length>0&&e.jsx("span",{className:"absolute -top-1 -right-2 px-1 min-w-[14px] h-[14px] text-[8px] font-bold rounded-full bg-red-500 text-white flex items-center justify-center",children:g.length})]}),e.jsx("span",{className:`text-[9px] font-medium ${E==="cart"?"font-semibold":""}`,children:"Gi·ªè h√†ng"})]}),e.jsxs("button",{onClick:()=>{je("history"),st(!0)},className:`flex flex-col items-center gap-1 px-1 py-1.5 rounded-lg transition-all duration-200 ${E==="history"?"text-indigo-600 dark:text-indigo-400 bg-indigo-50 dark:bg-indigo-900/30":"text-slate-600 dark:text-slate-400 active:scale-95"}`,children:[e.jsx($t,{className:`w-6 h-6 transition-transform ${E==="history"?"scale-105":""}`}),e.jsx("span",{className:`text-[9px] font-medium ${E==="history"?"font-semibold":""}`,children:"L·ªãch s·ª≠"})]})]})]}),e.jsxs("div",{className:"flex h-[calc(100vh-64px)] md:h-screen",children:[e.jsxs("div",{className:`flex-1 flex flex-col transition-all duration-300 ${E!=="products"?"hidden md:flex":"animate-fade-in"}`,children:[e.jsx("div",{className:"bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border-b border-slate-200/50 dark:border-slate-700/50 p-3 md:p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-3",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-stretch gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",placeholder:"T√¨m ki·∫øm s·∫£n ph·∫©m...",value:h,onChange:t=>_(t.target.value),className:"w-full pl-10 pr-4 py-2.5 border-2 border-slate-300/50 dark:border-slate-600/50 rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm md:text-base transition-all placeholder:text-slate-400"})]}),e.jsxs("button",{type:"button",onClick:()=>Ze(t=>!t),className:`px-4 py-2 rounded-xl border-2 font-semibold text-sm flex items-center gap-2 transition-all ${P?"border-blue-500 text-blue-600 bg-blue-50 dark:bg-blue-900/20":"border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-200 bg-white dark:bg-slate-800"}`,children:[e.jsx(zs,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:P?"ƒê√≥ng qu√©t":"Qu√©t m√£"})]}),e.jsx("button",{type:"button",onClick:()=>Je(!0),className:"md:hidden px-3 py-2 rounded-xl border-2 border-green-500 text-green-600 bg-green-50 dark:bg-green-900/20 font-semibold text-sm flex items-center gap-1.5 transition-all hover:bg-green-100",title:"Qu√©t b·∫±ng camera",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),P&&e.jsxs("form",{onSubmit:os,className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-blue-500",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})})}),e.jsx("input",{ref:Ke,type:"text",placeholder:"Nh·∫≠p ho·∫∑c qu√©t m√£ v·∫°ch...",value:f,onChange:t=>R(t.target.value),className:"w-full pl-10 pr-10 py-2.5 border-2 border-blue-400 dark:border-blue-600 rounded-xl bg-blue-50/50 dark:bg-blue-900/20 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm md:text-base transition-all placeholder:text-blue-500/70 font-mono"}),f&&e.jsx("button",{type:"button",onClick:()=>R(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsx("div",{className:"hidden md:flex items-center gap-2",children:e.jsxs("button",{onClick:()=>st(!0),className:"px-4 py-2.5 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-xl whitespace-nowrap transition-all inline-flex items-center gap-2 text-sm font-bold shadow-lg hover:shadow-xl hover:scale-105 active:scale-95",title:"L·ªãch s·ª≠ b√°n h√†ng",children:[e.jsx($t,{className:"w-5 h-5"}),e.jsx("span",{children:"L·ªãch s·ª≠"})]})})]})}),e.jsxs("div",{className:"bg-white/80 dark:bg-slate-800/80 border-b border-slate-200/60 dark:border-slate-700/60 px-3 md:px-6 py-3 flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsxs("div",{className:"text-xs md:text-sm text-slate-600 dark:text-slate-400 font-medium",children:["Hi·ªÉn th·ªã ",vt.length," / ",xe.length||0," s·∫£n ph·∫©m",h&&" theo t·ª´ kh√≥a"]}),e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pb-1",children:cs.map(t=>{const s=B===t.key;return e.jsxs("button",{type:"button","aria-pressed":s,onClick:()=>A(t.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-semibold transition-all whitespace-nowrap ${s?t.activeClass:t.inactiveClass}`,children:[e.jsx("span",{children:t.label}),e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[10px] font-black ${s?"bg-white/30":"bg-slate-100 dark:bg-slate-800"}`,children:t.count})]},t.key)})})]}),e.jsx("div",{className:"flex-1 p-0 md:p-6 overflow-y-auto bg-slate-50 dark:bg-slate-900 pb-24 md:pb-6",children:vt.length===0?e.jsxs("div",{className:"text-center text-slate-400 mt-20",children:[e.jsx("div",{className:"mb-4 flex items-center justify-center",children:e.jsx(wt,{className:"w-16 h-16 text-slate-300"})}),e.jsx("div",{className:"text-xl font-medium mb-2",children:xe.length===0?h?"Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m n√†o":"Ch∆∞a c√≥ s·∫£n ph·∫©m":B==="low"?"Kh√¥ng c√≥ s·∫£n ph·∫©m t·ªìn th·∫•p":"Kh√¥ng c√≥ s·∫£n ph·∫©m h·∫øt h√†ng"}),e.jsx("div",{className:"text-sm",children:xe.length===0?h?"H√£y th·ª≠ m·ªôt t·ª´ kh√≥a t√¨m ki·∫øm kh√°c":"Vui l√≤ng th√™m s·∫£n ph·∫©m v√†o h·ªá th·ªëng":"H√£y ch·ªçn b·ªô l·ªçc kh√°c ƒë·ªÉ xem th√™m s·∫£n ph·∫©m"})]}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2.5 md:gap-3",children:vt.map(t=>{var C,T;const s=Number(((C=t.retailPrice)==null?void 0:C[p])??0),n=Number(((T=t.stock)==null?void 0:T[p])??0),d=n<=0,c=n>0&&n<=dt,x=ls.get(t.id),b=!!x;return e.jsx("div",{className:`group relative text-left p-2.5 md:p-3 rounded-xl border transition-all duration-200 h-full ${d?"bg-slate-100/50 dark:bg-slate-900/50 border-slate-200 dark:border-slate-800 opacity-60":"bg-white dark:bg-slate-800/70 border-slate-200/70 dark:border-slate-700 md:hover:border-blue-400 md:dark:hover:border-blue-500 md:hover:shadow-xl md:hover:-translate-y-0.5 md:cursor-pointer"} ${b?"ring-2 ring-blue-400 dark:ring-blue-500/60 shadow-md shadow-blue-500/20":""}`,onClick:()=>{window.innerWidth>=768&&!d&&Re(t)},children:e.jsxs("div",{className:"flex flex-col h-full",children:[b&&e.jsx("div",{className:"absolute -top-2.5 -right-2.5 z-10",children:e.jsx("span",{className:"flex items-center justify-center min-w-[28px] h-7 px-2 text-sm font-bold rounded-full bg-blue-500 text-white shadow-lg ring-2 ring-white dark:ring-slate-800",children:x==null?void 0:x.quantity})}),e.jsxs("div",{className:"mb-2 flex-1",children:[e.jsx("h3",{className:"font-semibold text-xs md:text-sm text-slate-900 dark:text-slate-100 line-clamp-2 leading-tight",title:t.name,children:t.name}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-1",children:[e.jsx("span",{className:"px-1.5 py-0.5 bg-slate-100 dark:bg-slate-700 rounded text-[10px] font-mono text-slate-500 dark:text-slate-400 truncate max-w-[100px]",children:t.sku}),t.category&&e.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-medium truncate max-w-[70px] ${Be(t.category).bg} ${Be(t.category).text}`,children:t.category})]})]}),e.jsxs("div",{className:"flex items-end justify-between pt-2 border-t border-slate-100 dark:border-slate-700/50",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-bold ${d?"text-slate-400 dark:text-slate-500":"text-blue-600 dark:text-blue-400"}`,children:m(s)}),e.jsxs("span",{className:`inline-flex items-center justify-center px-1.5 py-0.5 text-[10px] font-bold rounded ${d?"bg-rose-100 text-rose-600 dark:bg-rose-900/30 dark:text-rose-400":c?"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400":"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400"}`,children:["T·ªìn: ",Math.max(0,Math.floor(n))]})]}),e.jsx("button",{type:"button",onClick:me=>{me.stopPropagation(),d||Re(t)},disabled:d,className:`md:hidden w-9 h-9 rounded-lg flex items-center justify-center transition-all ${d?"bg-slate-100 dark:bg-slate-700 cursor-not-allowed":"bg-blue-500 text-white shadow-md active:scale-95"}`,children:d?e.jsx("span",{className:"text-slate-400 text-xs",children:"‚úï"}):e.jsx(Ts,{className:"w-5 h-5"})})]})]})},t.id)})})})]}),e.jsxs("div",{className:`w-full md:w-[40%] bg-white dark:bg-slate-800 md:border-l border-slate-200 dark:border-slate-700 flex flex-col transition-all duration-300 overflow-y-auto ${E!=="cart"?"hidden md:flex":"animate-fade-in"}`,children:[e.jsx("div",{className:"p-3 md:p-4 border-b border-slate-200 md:border-slate-200/50 dark:border-slate-700/50 bg-white dark:bg-slate-800 md:bg-gradient-to-r md:from-emerald-50/30 md:via-teal-50/20 md:to-cyan-50/30 dark:md:from-slate-800/50 dark:md:via-slate-800/30 dark:md:to-slate-800/50",children:e.jsxs("div",{className:"customer-dropdown-container",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold md:font-bold text-slate-900 dark:text-slate-100 mb-2 md:mb-3",children:[e.jsx("div",{className:"w-7 h-7 md:w-8 md:h-8 bg-emerald-500 md:bg-gradient-to-br md:from-emerald-500 md:to-teal-500 rounded-lg flex items-center justify-center md:shadow-lg",children:e.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),e.jsx("span",{children:"Kh√°ch h√†ng"})]}),e.jsxs("div",{className:"relative flex flex-col md:flex-row gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",placeholder:"T√¨m t√™n, s·ªë ƒëi·ªán tho·∫°i...",value:ae,onChange:t=>{re(t.target.value),w(!0)},onFocus:()=>w(!0),onBlur:()=>{setTimeout(()=>w(!1),200)},className:"w-full pl-10 pr-4 py-2 md:py-2.5 border md:border-2 border-slate-300 md:border-slate-300/50 dark:border-slate-600/50 rounded-lg md:rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-all placeholder:text-slate-400"}),et&&e.jsx("div",{className:"absolute top-full left-0 right-0 z-50 mt-1 max-h-48 overflow-y-auto bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg shadow-lg",children:Bt.length>0?Bt.map(t=>e.jsxs("button",{onClick:()=>{oe(t),re(t.name),w(!1)},className:"w-full text-left px-3 py-2.5 hover:bg-slate-50 dark:hover:bg-slate-600 border-b border-slate-100 dark:border-slate-600 last:border-b-0",children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-slate-100 text-sm",children:t.name}),t.phone&&e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:["üìû ",t.phone]})]},t.id)):e.jsx("div",{className:"px-3 py-3 text-center text-slate-500 dark:text-slate-400 text-sm",children:ae?e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Kh√¥ng t√¨m th·∫•y kh√°ch h√†ng"}),e.jsx("button",{onClick:()=>We(!0),className:"mt-2 text-emerald-500 hover:text-emerald-600 font-medium",children:"+ Th√™m kh√°ch h√†ng m·ªõi"})]}):$.length===0?e.jsx("div",{children:"Ch∆∞a c√≥ kh√°ch h√†ng n√†o"}):e.jsx("div",{children:"Nh·∫≠p t√™n ho·∫∑c SƒêT ƒë·ªÉ t√¨m..."})})})]}),e.jsxs("button",{onClick:()=>We(!0),className:"px-3 py-2 md:px-4 md:py-2.5 bg-emerald-500 md:bg-gradient-to-r md:from-emerald-500 md:to-teal-500 hover:bg-emerald-600 md:hover:from-emerald-600 md:hover:to-teal-600 text-white rounded-lg md:rounded-xl flex items-center justify-center gap-2 transition-all md:shadow-lg md:hover:shadow-xl md:hover:scale-105 md:active:scale-95 font-semibold md:font-bold",title:"Th√™m kh√°ch h√†ng m·ªõi",children:[e.jsx(Ft,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"hidden sm:inline text-sm",children:"Th√™m"})]})]}),I&&e.jsx("div",{className:"mt-2 md:mt-3 p-2 md:p-3.5 bg-emerald-50 dark:bg-emerald-900/20 md:bg-gradient-to-r md:from-emerald-50 md:to-teal-50 dark:md:from-emerald-900/20 dark:md:to-teal-900/20 rounded-lg md:rounded-xl border md:border-2 border-emerald-200 dark:border-emerald-800 md:shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-2.5 flex-1 min-w-0",children:[e.jsx("div",{className:"hidden md:flex w-10 h-10 bg-gradient-to-br from-emerald-500 to-teal-500 rounded-lg items-center justify-center shadow-lg flex-shrink-0",children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium md:font-bold text-emerald-900 dark:text-emerald-100 truncate text-sm md:text-base",children:I.name}),I.phone&&e.jsxs("div",{className:"text-xs text-emerald-700 dark:text-emerald-300 flex items-center gap-1 mt-0.5",children:[e.jsx("svg",{className:"w-3 h-3 flex-shrink-0 hidden md:inline",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),e.jsx("span",{className:"truncate",children:I.phone})]})]})]}),e.jsx("button",{onClick:()=>{oe(null),re("")},className:"w-7 h-7 md:w-8 md:h-8 bg-red-100 dark:bg-red-900/30 hover:bg-red-200 dark:hover:bg-red-900/50 text-red-600 dark:text-red-400 rounded-md md:rounded-lg flex items-center justify-center transition-all flex-shrink-0 md:shadow-sm md:hover:shadow-md text-lg",title:"X√≥a",children:"√ó"})]})})]})}),e.jsxs("div",{className:"p-3 md:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 md:mb-4 pb-2 md:pb-3 border-b md:border-b-2 border-slate-200 md:border-slate-200/50 dark:border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"hidden md:flex w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-lg items-center justify-center shadow-lg",children:e.jsx(Nt,{className:"w-4 h-4 text-white"})}),e.jsx("h3",{className:"text-base md:text-lg font-semibold md:font-black text-slate-900 dark:text-slate-100",children:"Gi·ªè h√†ng"})]}),e.jsx("span",{className:"px-2 py-0.5 md:px-3 md:py-1 bg-blue-100 md:bg-gradient-to-r md:from-blue-100 md:to-indigo-100 dark:from-blue-900/30 dark:to-indigo-900/30 text-blue-700 dark:text-blue-300 rounded-full text-xs font-semibold md:font-bold md:shadow-sm",children:g.length})]}),g.length===0?e.jsxs("div",{className:"text-center py-12 md:py-16 mb-3",children:[e.jsx("div",{className:"mb-3 md:mb-4 flex items-center justify-center",children:e.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 bg-slate-100 md:bg-gradient-to-br md:from-slate-100 md:to-slate-200 dark:from-slate-800 dark:to-slate-700 rounded-2xl md:rounded-3xl flex items-center justify-center md:shadow-lg",children:e.jsx(Nt,{className:"w-8 h-8 md:w-10 md:h-10 text-slate-400 dark:text-slate-500"})})}),e.jsx("div",{className:"text-sm md:text-base font-semibold md:font-bold text-slate-600 dark:text-slate-400 mb-1",children:"Gi·ªè h√†ng tr·ªëng"}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-500",children:"Ch·ªçn s·∫£n ph·∫©m ƒë·ªÉ th√™m v√†o gi·ªè"})]}):e.jsx("div",{className:"space-y-1.5 md:space-y-2.5",children:g.map(t=>{const s=X.find(n=>n.id===t.partId);return e.jsxs("div",{className:"group p-2 md:p-3 border md:border-2 border-slate-200 md:border-slate-200/50 dark:border-slate-700/50 rounded-lg md:rounded-xl bg-white dark:bg-slate-800 md:hover:border-blue-400 dark:hover:border-blue-600 transition-all duration-200 md:hover:shadow-lg md:hover:shadow-blue-500/10",children:[e.jsx("div",{className:"md:hidden",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-semibold text-sm text-slate-900 dark:text-slate-100 leading-tight truncate",title:t.partName,children:t.partName}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5 flex-wrap",children:[e.jsx("span",{className:"text-[11px] text-slate-500 dark:text-slate-400 font-mono",children:t.sku}),(s==null?void 0:s.category)&&e.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded-full text-[9px] font-medium ${Be(s.category).bg} ${Be(s.category).text}`,children:s.category})]}),e.jsx("div",{className:"text-sm font-bold text-blue-600 dark:text-blue-400 mt-0.5",children:m(t.sellingPrice)})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx("button",{onClick:()=>Ve(t.partId,t.quantity-1),className:"w-7 h-7 flex items-center justify-center bg-slate-100 dark:bg-slate-700 rounded-md text-slate-700 dark:text-slate-300 hover:bg-red-100 dark:hover:bg-red-900/30 hover:text-red-500 transition-all font-bold text-base",children:"-"}),e.jsx("span",{className:"w-7 text-center font-bold text-xs text-slate-900 dark:text-slate-100",children:t.quantity}),e.jsx("button",{onClick:()=>Ve(t.partId,t.quantity+1),className:"w-7 h-7 flex items-center justify-center bg-blue-500 dark:bg-blue-600 rounded-md text-white hover:bg-blue-600 dark:hover:bg-blue-700 transition-all font-bold text-base",children:"+"})]})]})}),e.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-orange-100 to-amber-100 dark:from-orange-900/30 dark:to-amber-900/30 rounded-xl flex items-center justify-center flex-shrink-0 shadow-sm group-hover:scale-110 transition-transform",children:e.jsx(wt,{className:"w-6 h-6 text-orange-500 dark:text-orange-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-bold text-sm text-slate-900 dark:text-slate-100 line-clamp-1 mb-0.5",title:t.partName,children:t.partName}),e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx("span",{className:"px-1.5 py-0.5 bg-slate-100 dark:bg-slate-700 rounded text-[10px] text-slate-500 dark:text-slate-400 font-semibold",children:t.sku}),(s==null?void 0:s.category)&&e.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-medium ${Be(s.category).bg} ${Be(s.category).text}`,children:s.category})]}),e.jsx("div",{className:"text-sm font-black bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-blue-400 dark:to-indigo-400 bg-clip-text text-transparent",children:m(t.sellingPrice)})]}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[e.jsx("button",{onClick:()=>Ve(t.partId,t.quantity-1),className:"w-8 h-8 flex items-center justify-center bg-gradient-to-r from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-600 rounded-lg text-slate-700 dark:text-slate-300 hover:from-red-100 hover:to-red-200 dark:hover:from-red-900/30 dark:hover:to-red-800/30 hover:text-red-500 transition-all shadow-sm hover:shadow-md font-bold",children:"-"}),e.jsx("span",{className:"w-10 text-center font-black text-sm text-slate-900 dark:text-slate-100 px-2 py-1 bg-slate-50 dark:bg-slate-700 rounded-lg",children:t.quantity}),e.jsx("button",{onClick:()=>Ve(t.partId,t.quantity+1),className:"w-8 h-8 flex items-center justify-center bg-gradient-to-r from-blue-500 to-indigo-500 dark:from-blue-600 dark:to-indigo-600 rounded-lg text-white hover:from-blue-600 hover:to-indigo-600 dark:hover:from-blue-700 dark:hover:to-indigo-700 transition-all shadow-md hover:shadow-lg font-bold",children:"+"})]})]})]},t.partId)})})]}),g.length>0&&e.jsxs("div",{className:"border-t md:border-t-2 border-slate-200 md:border-slate-200/50 dark:border-slate-700/50 bg-slate-50 dark:bg-slate-800 md:bg-gradient-to-br md:from-slate-50 md:to-blue-50/30 dark:md:from-slate-800 dark:md:to-slate-800/50",children:[e.jsxs("div",{className:"p-3 md:p-4 space-y-2 md:space-y-3 pb-20 md:pb-3",children:[e.jsxs("div",{className:"flex justify-between text-xs md:text-sm",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400 font-medium",children:"T·ªïng ti·ªÅn h√†ng"}),e.jsx("span",{className:"font-semibold md:font-bold text-slate-900 dark:text-slate-100",children:m(ce)})]}),e.jsxs("div",{className:"space-y-2 md:space-y-2.5",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between text-xs md:text-sm gap-1.5 md:gap-2",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400 font-medium",children:"Gi·∫£m gi√°:"}),e.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2 w-full md:w-auto",children:[e.jsx("input",{type:"number",value:ze==="amount"?N:St,onChange:t=>{const s=Number(t.target.value)||0;if(ze==="amount")De(Math.min(s,ce));else{const n=Math.min(s,100);tt(n),De(Math.round(ce*n/100))}},className:"flex-1 md:w-24 px-2 md:px-3 py-1.5 md:py-2 text-right text-xs md:text-sm border md:border-2 border-slate-300 md:border-slate-300 dark:border-slate-600 rounded-lg md:rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all font-medium md:font-semibold",placeholder:"0",min:"0",max:ze==="amount"?ce:100}),e.jsxs("select",{value:ze,onChange:t=>{const s=t.target.value;Ct(s),De(0),tt(0)},className:"px-2 md:px-3 py-1.5 md:py-2 border md:border-2 border-slate-300 md:border-slate-300 dark:border-slate-600 rounded-lg md:rounded-xl bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 text-xs md:text-sm font-semibold md:font-bold focus:ring-2 focus:ring-purple-500 transition-all",children:[e.jsx("option",{value:"amount",children:"‚Ç´"}),e.jsx("option",{value:"percent",children:"%"})]})]})]}),ze==="percent"&&e.jsx("div",{className:"flex gap-1.5 md:gap-2 justify-end flex-wrap",children:[5,10,15,20].map(t=>e.jsxs("button",{onClick:()=>{tt(t),De(Math.round(ce*t/100))},className:"px-2 md:px-3 py-1 md:py-1.5 text-[10px] md:text-xs font-semibold md:font-bold bg-purple-100 md:bg-gradient-to-r md:from-purple-100 md:to-pink-100 dark:from-purple-900/30 dark:to-pink-900/30 hover:bg-purple-200 md:hover:from-purple-200 md:hover:to-pink-200 dark:hover:from-purple-900/50 dark:hover:to-pink-900/50 text-purple-700 dark:text-purple-300 rounded-md md:rounded-lg transition-all md:shadow-sm md:hover:shadow-md",children:[t,"%"]},t))}),ze==="percent"&&St>0&&e.jsxs("div",{className:"text-[10px] md:text-xs text-slate-500 dark:text-slate-400 text-right",children:["= ",m(N)]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 md:pt-3 mt-2 md:mt-3 border-t md:border-t-2 border-slate-200 dark:border-slate-700 p-2 md:p-3 -mx-3 md:-mx-4 bg-blue-600 md:bg-gradient-to-r md:from-blue-600 md:to-indigo-600 dark:from-blue-700 dark:to-indigo-700 rounded-b-lg md:rounded-b-xl md:shadow-lg",children:[e.jsx("span",{className:"font-semibold md:font-bold text-white text-xs md:text-sm",children:"Kh√°ch ph·∫£i tr·∫£"}),e.jsx("span",{className:"font-black text-lg md:text-2xl text-white",children:m(Math.max(0,It-N))})]})]}),e.jsxs("div",{className:"px-3 md:px-4 pb-3 md:pb-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs md:text-sm font-semibold md:font-bold text-slate-900 dark:text-slate-100 mb-2 md:mb-3",children:[e.jsx("span",{children:"Ph∆∞∆°ng th·ª©c thanh to√°n"}),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 md:gap-3",children:[e.jsxs("button",{onClick:()=>gt("cash"),className:`flex items-center justify-center gap-1.5 md:gap-2 px-3 md:px-4 py-2 md:py-3 rounded-lg md:rounded-xl border md:border-2 transition-all font-semibold md:font-bold md:shadow-sm md:hover:shadow-md ${le==="cash"?"border-emerald-600 bg-emerald-500 text-white dark:bg-emerald-600 dark:text-white md:shadow-lg":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:border-emerald-400"}`,children:[e.jsx(Ot,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"text-xs md:text-sm",children:"Ti·ªÅn m·∫∑t"})]}),e.jsxs("button",{onClick:()=>gt("bank"),className:`flex items-center justify-center gap-1.5 md:gap-2 px-3 md:px-4 py-2 md:py-3 rounded-lg md:rounded-xl border md:border-2 transition-all font-semibold md:font-bold md:shadow-sm md:hover:shadow-md ${le==="bank"?"border-blue-600 bg-blue-500 text-white dark:bg-blue-600 dark:text-white md:shadow-lg":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:border-blue-400"}`,children:[e.jsx(Ut,{className:"w-4 h-4 md:w-5 md:h-5"}),e.jsx("span",{className:"text-xs md:text-sm",children:"Chuy·ªÉn kho·∫£n"})]})]})]}),le&&e.jsxs("div",{className:"px-3 md:px-4 pb-3 md:pb-4",children:[e.jsx("label",{className:"block text-xs md:text-sm font-semibold md:font-bold text-slate-900 dark:text-slate-100 mb-2 md:mb-3",children:"H√¨nh th·ª©c"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1.5 md:gap-2",children:[e.jsx("button",{onClick:()=>{rt("full"),lt(0)},className:`px-2 md:px-3 py-2 md:py-2.5 text-xs md:text-sm rounded-lg md:rounded-xl border md:border-2 transition-all font-bold md:shadow-sm ${G==="full"?"border-orange-600 bg-orange-500 text-white dark:bg-orange-600 dark:text-white md:shadow-lg":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-600 dark:text-slate-400 hover:border-orange-400"}`,children:"ƒê·ªß"}),e.jsx("button",{onClick:()=>rt("partial"),className:`px-2 md:px-3 py-2 md:py-2.5 text-xs md:text-sm rounded-lg md:rounded-xl border md:border-2 transition-all font-bold md:shadow-sm ${G==="partial"?"border-orange-600 bg-orange-500 text-white dark:bg-orange-600 dark:text-white md:shadow-lg":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-600 dark:text-slate-400 hover:border-orange-400"}`,children:"1 ph·∫ßn"}),e.jsx("button",{onClick:()=>{rt("note"),lt(0)},className:`px-2 md:px-3 py-2 md:py-2.5 text-xs md:text-sm rounded-lg md:rounded-xl border md:border-2 transition-all font-bold md:shadow-sm ${G==="note"?"border-orange-600 bg-orange-500 text-white dark:bg-orange-600 dark:text-white md:shadow-lg":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-600 dark:text-slate-400 hover:border-orange-400"}`,children:"Ghi n·ª£"})]})]}),G==="partial"&&e.jsxs("div",{className:"px-4 pb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-900 dark:text-slate-100 mb-2",children:"S·ªë ti·ªÅn kh√°ch tr·∫£"}),e.jsx("input",{type:"number",value:_e,onChange:t=>lt(Number(t.target.value)||0),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100",placeholder:"0"}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["C√≤n l·∫°i:"," ",m(Math.max(0,It-N-_e))," ","ƒë"]})]}),e.jsxs("div",{className:"px-3 md:px-4 pb-3 md:pb-3 space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 dark:text-slate-400 mb-2",children:"Th·ªùi gian b√°n h√†ng"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>Dt(!0),className:`flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg border transition-all font-semibold ${ut?"border-blue-500 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:border-blue-400"}`,children:e.jsx("span",{className:"text-xs",children:"üïê Hi·ªán t·∫°i"})}),e.jsx("button",{type:"button",onClick:()=>Dt(!1),className:`flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg border transition-all font-semibold ${ut?"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:border-blue-400":"border-blue-500 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400"}`,children:e.jsx("span",{className:"text-xs",children:"üìÖ T√πy ch·ªânh"})})]}),!ut&&e.jsx("input",{type:"datetime-local",value:Jt,onChange:t=>es(t.target.value),className:"mt-2 w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>Zt(!pt),className:`flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg border transition-all font-semibold ${pt?"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:border-emerald-400"}`,children:e.jsx("span",{className:"text-xs",children:"üìù Ghi ch√∫"})}),e.jsx("button",{type:"button",onClick:()=>Yt(!bt),className:`flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg border transition-all font-semibold ${bt?"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400":"border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:border-emerald-400"}`,children:e.jsx("span",{className:"text-xs",children:"üñ®Ô∏è In ho√° ƒë∆°n"})})]}),pt&&e.jsx("textarea",{value:ts,onChange:t=>ss(t.target.value),placeholder:"Nh·∫≠p ghi ch√∫ cho ƒë∆°n h√†ng...",rows:3,className:"w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 placeholder-slate-400 dark:placeholder-slate-500 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 resize-none"})]}),e.jsxs("div",{className:"p-3 md:p-4 pt-0 flex flex-col md:flex-row gap-2 md:gap-3",children:[e.jsx("button",{onClick:O,className:"flex-1 px-3 md:px-4 py-2 md:py-3 bg-white dark:bg-slate-700 border md:border-2 border-slate-300 dark:border-slate-600 hover:border-slate-400 dark:hover:border-slate-500 hover:bg-slate-50 dark:hover:bg-slate-600 text-slate-700 dark:text-slate-300 font-semibold md:font-bold rounded-lg md:rounded-xl transition-all md:shadow-sm md:hover:shadow-md text-sm md:text-base",children:"L∆ØU NH√ÅP"}),e.jsx("button",{onClick:fs,disabled:!le||!G,className:`flex-1 px-3 md:px-4 py-2 md:py-3 font-bold md:font-black rounded-lg md:rounded-xl transition-all md:shadow-lg text-sm md:text-base ${le&&G?"bg-orange-500 md:bg-gradient-to-r md:from-orange-500 md:to-red-500 hover:bg-orange-600 md:hover:from-orange-600 md:hover:to-red-600 text-white md:shadow-orange-500/30 md:hover:shadow-xl md:hover:shadow-orange-500/40 md:hover:scale-105 md:active:scale-95":"bg-slate-300 dark:bg-slate-700 text-slate-500 dark:text-slate-500 cursor-not-allowed opacity-60"}`,children:"XU·∫§T B√ÅN"})]})]})]})]}),e.jsx(As,{isOpen:Qt,onClose:()=>{st(!1),E==="history"&&je("products")},sales:se,currentBranchId:p,onPrintReceipt:ms,onEditSale:us,onDeleteSale:bs,page:l.page,totalPages:l.totalPages,total:l.total,hasMore:l.hasMore,pageSize:be,onPrevPage:ee,onNextPage:()=>{var t,s;if(L){const n=(t=j==null?void 0:j.meta)==null?void 0:t.nextAfterDate,d=(s=j==null?void 0:j.meta)==null?void 0:s.nextAfterId;(n||d)&&q({afterDate:n,afterId:d})}else F()},onPageSizeChange:r,search:Ce,onSearchChange:t=>{Se(t),t||V(1)},fromDate:Le,toDate:te,onDateRangeChange:(t,s)=>{ue(t),de(s),V(1),L&&q(null)},status:H,onStatusChange:t=>{pe(t),V(1),L&&q(null)},paymentMethodFilter:Z,onPaymentMethodFilterChange:t=>{fe(t),V(1),L&&q(null)},keysetMode:L,onToggleKeyset:t=>{Pe(t),V(1),q(null)},customerDebts:Xe}),Tt&&e.jsx("div",{id:"last-receipt",className:"hidden print:block",children:e.jsxs("div",{style:{width:"148mm",minHeight:"210mm",margin:"0 auto",padding:"15mm",fontFamily:"Arial, sans-serif",fontSize:"12px",backgroundColor:"white",color:"#000",boxSizing:"border-box"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"15px",marginBottom:"20px",borderBottom:"2px solid #333",paddingBottom:"15px"},children:[e.jsx("img",{src:(i==null?void 0:i.logo_url)||"https://raw.githubusercontent.com/Nhan-Lam-SmartCare/Motocare/main/public/logo.png",alt:"Logo",style:{width:"60px",height:"60px",objectFit:"contain",flexShrink:0},onError:t=>{t.currentTarget.style.display="none"}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h1",{style:{fontSize:"18px",fontWeight:"bold",margin:"0 0 5px 0",color:"#1e40af"},children:(i==null?void 0:i.store_name)||"Nh·∫°n-L√¢m SmartCare"}),e.jsxs("div",{style:{fontSize:"11px",lineHeight:"1.5"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"4px"},children:[e.jsx("svg",{style:{width:"12px",height:"12px",flexShrink:0,marginTop:"2px"},viewBox:"0 0 24 24",fill:"#ef4444",children:e.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})}),e.jsx("span",{children:(i==null?void 0:i.address)||"·∫§p Ph√∫ L·ª£i B, Ph√∫ Thu·∫≠n B, H·ªìng Ng·ª±, ƒê·ªìng Th√°p"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx("svg",{style:{width:"12px",height:"12px",flexShrink:0},viewBox:"0 0 24 24",fill:"#16a34a",children:e.jsx("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})}),e.jsx("span",{children:(i==null?void 0:i.phone)||"0947-747-907"})]})]})]})]}),(i==null?void 0:i.bank_name)&&e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",backgroundColor:"#f0f9ff",border:"1px solid #dee2e6",borderRadius:"6px",padding:"10px 12px",marginBottom:"20px",fontSize:"11px"},children:[e.jsxs("div",{style:{flex:1,lineHeight:"1.5"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"3px",color:"#1e40af",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx("svg",{style:{width:"12px",height:"12px",flexShrink:0},viewBox:"0 0 24 24",fill:"#0891b2",children:e.jsx("path",{d:"M4 10h3v7H4zm6.5 0h3v7h-3zM2 19h20v3H2zm15-9h3v7h-3zm-5-9L2 6v2h20V6z"})}),e.jsx("span",{children:"Th√¥ng tin chuy·ªÉn kho·∫£n:"})]}),e.jsxs("div",{children:["‚Ä¢ Ng√¢n h√†ng: ",e.jsx("strong",{children:i.bank_name})]}),i.bank_account_number&&e.jsxs("div",{children:["‚Ä¢ S·ªë t√†i kho·∫£n:"," ",e.jsx("strong",{style:{color:"#2563eb"},children:i.bank_account_number})]}),i.bank_account_holder&&e.jsxs("div",{children:["‚Ä¢ Ch·ªß t√†i kho·∫£n:"," ",e.jsx("strong",{children:i.bank_account_holder})]})]}),i.bank_qr_url&&e.jsx("div",{style:{flexShrink:0},children:e.jsx("img",{src:i.bank_qr_url,alt:"QR Banking",style:{width:"50px",height:"50px",objectFit:"contain"}})})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:"15px"},children:[e.jsx("h2",{style:{fontSize:"18px",fontWeight:"bold",margin:"0 0 8px 0",textTransform:"uppercase",letterSpacing:"1px"},children:"H√ìA ƒê∆†N B√ÅN H√ÄNG"}),e.jsxs("div",{style:{fontSize:"11px",color:"#666"},children:["S·ªë: ",e.jsx("strong",{style:{color:"#000"},children:Tt})," - Ng√†y:"," ",e.jsx("strong",{style:{color:"#000"},children:ot(new Date,!0)})]})]}),e.jsx("div",{style:{marginBottom:"15px",padding:"10px",backgroundColor:"#f8f9fa",borderRadius:"4px"},children:e.jsxs("div",{style:{fontSize:"12px",lineHeight:"1.8"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Kh√°ch h√†ng:"})," ",Ie||"Kh√°ch l·∫ª"]}),ie&&e.jsxs("div",{children:[e.jsx("strong",{children:"ƒêi·ªán tho·∫°i:"})," ",ie]})]})}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"15px",fontSize:"11px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f1f3f5",borderTop:"2px solid #333",borderBottom:"2px solid #333"},children:[e.jsx("th",{style:{textAlign:"center",padding:"8px 4px",width:"8%",fontWeight:"bold"},children:"STT"}),e.jsx("th",{style:{textAlign:"left",padding:"8px 6px",width:"37%",fontWeight:"bold"},children:"T√™n s·∫£n ph·∫©m"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 4px",width:"10%",fontWeight:"bold"},children:"SL"}),e.jsx("th",{style:{textAlign:"right",padding:"8px 6px",width:"20%",fontWeight:"bold"},children:"ƒê∆°n gi√°"}),e.jsx("th",{style:{textAlign:"right",padding:"8px 6px",width:"25%",fontWeight:"bold"},children:"Th√†nh ti·ªÅn"})]})}),e.jsx("tbody",{children:Oe.map((t,s)=>e.jsx(Rt.Fragment,{children:e.jsxs("tr",{style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("td",{style:{textAlign:"center",padding:"10px 4px",verticalAlign:"top"},children:s+1}),e.jsxs("td",{style:{padding:"10px 6px",verticalAlign:"top"},children:[e.jsx("div",{style:{fontWeight:"600",marginBottom:"3px"},children:t.partName}),t.sku&&e.jsxs("div",{style:{fontSize:"9px",color:"#868e96"},children:["SKU: ",t.sku]})]}),e.jsx("td",{style:{textAlign:"center",padding:"10px 4px",verticalAlign:"top",fontWeight:"600"},children:t.quantity}),e.jsx("td",{style:{textAlign:"right",padding:"10px 6px",verticalAlign:"top"},children:m(t.sellingPrice)}),e.jsx("td",{style:{textAlign:"right",padding:"10px 6px",verticalAlign:"top",fontWeight:"600"},children:m(t.sellingPrice*t.quantity)})]})},t.partId))})]}),e.jsx("div",{style:{borderTop:"2px solid #333",paddingTop:"12px",marginBottom:"15px"},children:e.jsx("table",{style:{width:"100%",fontSize:"12px"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsxs("td",{style:{padding:"6px 0",textAlign:"right"},children:["T·ªïng c·ªông (",ds," s·∫£n ph·∫©m):"]}),e.jsx("td",{style:{padding:"6px 0 6px 20px",textAlign:"right",width:"30%",fontWeight:"600"},children:m(jt)})]}),at>0&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 0",textAlign:"right",color:"#c92a2a"},children:"Gi·∫£m gi√°:"}),e.jsxs("td",{style:{padding:"6px 0 6px 20px",textAlign:"right",fontWeight:"600",color:"#c92a2a"},children:["-",m(at)]})]}),e.jsxs("tr",{style:{borderTop:"1px solid #dee2e6",fontSize:"14px"},children:[e.jsx("td",{style:{padding:"10px 0",textAlign:"right",fontWeight:"bold"},children:"T·ªîNG THANH TO√ÅN:"}),e.jsx("td",{style:{padding:"10px 0 10px 20px",textAlign:"right",fontWeight:"bold",fontSize:"16px",color:"#2f9e44"},children:m(ns)})]})]})})}),e.jsxs("div",{style:{marginBottom:"20px",padding:"10px 12px",backgroundColor:"#f8f9fa",borderRadius:"4px",fontSize:"11px"},children:[e.jsxs("div",{style:{marginBottom:"4px"},children:[e.jsx("strong",{children:"H√¨nh th·ª©c thanh to√°n:"})," ",le==="cash"?"Ti·ªÅn m·∫∑t":"Chuy·ªÉn kho·∫£n"]}),e.jsx("div",{style:{fontStyle:"italic",color:"#495057"},children:G==="full"?"‚úì ƒê√£ thanh to√°n ƒë·ªß":G==="partial"?`Thanh to√°n m·ªôt ph·∫ßn: ${m(_e)}`:"Ghi n·ª£"})]}),e.jsx("div",{style:{marginTop:"30px",borderTop:"1px solid #dee2e6",paddingTop:"20px"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"11px"},children:[e.jsxs("div",{style:{textAlign:"center",width:"40%"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"50px",fontSize:"12px"},children:"Kh√°ch h√†ng"}),e.jsx("div",{style:{fontStyle:"italic",color:"#868e96"},children:"(K√Ω v√† ghi r√µ h·ªç t√™n)"})]}),e.jsxs("div",{style:{textAlign:"center",width:"40%"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"50px",fontSize:"12px"},children:"Ng∆∞·ªùi b√°n h√†ng"}),e.jsx("div",{style:{fontStyle:"italic",color:"#868e96"},children:"(K√Ω v√† ghi r√µ h·ªç t√™n)"})]})]})}),e.jsxs("div",{style:{textAlign:"center",marginTop:"25px",paddingTop:"15px",borderTop:"1px dashed #adb5bd",fontSize:"11px",fontStyle:"italic",color:"#495057"},children:[e.jsxs("div",{style:{marginBottom:"5px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[e.jsx("span",{style:{display:"inline-flex"},children:"*"}),"C·∫£m ∆°n qu√Ω kh√°ch ƒë√£ s·ª≠ d·ª•ng d·ªãch v·ª•",e.jsx("span",{style:{display:"inline-flex"},children:"*"})]}),e.jsx("div",{children:"H·∫πn g·∫∑p l·∫°i qu√Ω kh√°ch!"})]})]})}),Xt&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Th√™m kh√°ch h√†ng m·ªõi"}),e.jsx("button",{onClick:()=>{We(!1),ve({name:"",phone:"",vehicleModel:"",licensePlate:""})},className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200",children:e.jsx(Gt,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:["T√™n kh√°ch h√†ng ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:K.name,onChange:t=>ve({...K,name:t.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500",placeholder:"Nh·∫≠p t√™n kh√°ch h√†ng"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:["S·ªë ƒëi·ªán tho·∫°i ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",value:K.phone,onChange:t=>ve({...K,phone:t.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500",placeholder:"Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"D√≤ng xe"}),e.jsx("input",{type:"text",value:K.vehicleModel,onChange:t=>ve({...K,vehicleModel:t.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500",placeholder:"VD: Honda SH 2023"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Bi·ªÉn s·ªë xe"}),e.jsx("input",{type:"text",value:K.licensePlate,onChange:t=>ve({...K,licensePlate:t.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-blue-500",placeholder:"VD: 30A-12345"})]})]}),e.jsxs("div",{className:"flex gap-2 p-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("button",{onClick:()=>{We(!1),ve({name:"",phone:"",vehicleModel:"",licensePlate:""})},className:"flex-1 px-4 py-2 bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-600",children:"H·ªßy"}),e.jsx("button",{onClick:xs,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"L∆∞u"})]})]})}),as&&k&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 px-6 py-4 flex items-center justify-between rounded-t-xl flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"Xem tr∆∞·ªõc h√≥a ƒë∆°n"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:hs,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg flex items-center gap-2 transition",title:"Chia s·∫ª / T·∫£i ·∫£nh",children:[e.jsx(Ms,{className:"w-4 h-4"}),"Chia s·∫ª"]}),e.jsxs("button",{onClick:gs,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center gap-2 transition",children:[e.jsx(Ls,{className:"w-4 h-4"}),"In h√≥a ƒë∆°n"]}),e.jsx("button",{onClick:()=>{ft(!1),kt(null)},className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300","aria-label":"ƒê√≥ng",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-100 dark:bg-slate-900",children:e.jsx("div",{ref:yt,className:"bg-white shadow-lg mx-auto",style:{width:"80mm",minHeight:"100mm",color:"#000"},children:e.jsxs("div",{style:{padding:"5mm"},children:[e.jsxs("div",{style:{borderBottom:"2px solid #3b82f6",paddingBottom:"2mm",marginBottom:"3mm",display:"flex",alignItems:"center",gap:"3mm"},children:[(i==null?void 0:i.logo_url)&&e.jsx("img",{src:i.logo_url,alt:"Logo",style:{height:"14mm",width:"14mm",objectFit:"contain",flexShrink:0}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"10pt",color:"#1e40af",marginBottom:"1mm"},children:(i==null?void 0:i.store_name)||"Nh·∫°n L√¢m SmartCare"}),(i==null?void 0:i.address)&&e.jsxs("div",{style:{fontSize:"7pt",color:"#000",display:"flex",alignItems:"flex-start",gap:"1mm",lineHeight:"1.3"},children:[e.jsx("svg",{style:{width:"8px",height:"8px",flexShrink:0,marginTop:"1px"},viewBox:"0 0 24 24",fill:"#ef4444",children:e.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})}),e.jsx("span",{children:i.address})]}),(i==null?void 0:i.phone)&&e.jsxs("div",{style:{fontSize:"7pt",color:"#000",display:"flex",alignItems:"center",gap:"1mm"},children:[e.jsx("svg",{style:{width:"8px",height:"8px",flexShrink:0},viewBox:"0 0 24 24",fill:"#16a34a",children:e.jsx("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})}),e.jsx("span",{children:i.phone})]})]})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:"3mm"},children:[e.jsx("h1",{style:{fontSize:"14pt",fontWeight:"bold",margin:"0",color:"#1e40af"},children:"H√ìA ƒê∆†N B√ÅN H√ÄNG"}),e.jsx("div",{style:{fontSize:"8pt",color:"#666",marginTop:"1mm"},children:new Date(k.date).toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}),e.jsxs("div",{style:{fontSize:"8pt",fontWeight:"bold",marginTop:"0.5mm"},children:["M√£: ",He(k.id)||k.id]})]}),e.jsxs("div",{style:{border:"1px solid #ddd",padding:"2mm",marginBottom:"3mm",borderRadius:"2mm",backgroundColor:"#f8fafc",fontSize:"8.5pt"},children:[e.jsxs("div",{style:{marginBottom:"1mm"},children:[e.jsx("span",{style:{fontWeight:"bold"},children:"KH:"})," ",k.customer.name]}),k.customer.phone&&e.jsxs("div",{children:[e.jsx("span",{style:{fontWeight:"bold"},children:"SƒêT:"})," ",k.customer.phone]})]}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"3mm",fontSize:"8.5pt"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid #ddd"},children:[e.jsx("th",{style:{textAlign:"left",padding:"1mm",fontSize:"8pt"},children:"S·∫£n ph·∫©m"}),e.jsx("th",{style:{textAlign:"center",padding:"1mm",width:"15%",fontSize:"8pt"},children:"SL"}),e.jsx("th",{style:{textAlign:"right",padding:"1mm",width:"28%",fontSize:"8pt"},children:"Th√†nh ti·ªÅn"})]})}),e.jsx("tbody",{children:k.items.map((t,s)=>{const n=t.sellingPrice||t.sellingprice||t.price||0,d=t.quantity||0;return e.jsxs("tr",{style:{borderBottom:"1px dashed #ddd"},children:[e.jsx("td",{style:{padding:"1.5mm 1mm",fontSize:"8.5pt"},children:t.partName||t.partname}),e.jsx("td",{style:{textAlign:"center",padding:"1.5mm 1mm",fontSize:"8.5pt"},children:d}),e.jsx("td",{style:{textAlign:"right",padding:"1.5mm 1mm",fontSize:"8.5pt",fontWeight:"bold"},children:m(n*d)})]},s)})})]}),e.jsxs("div",{style:{borderTop:"2px solid #333",paddingTop:"2mm",marginBottom:"3mm",fontSize:"9pt"},children:[k.discount>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1mm",color:"#e74c3c"},children:[e.jsx("span",{children:"Gi·∫£m gi√°:"}),e.jsxs("span",{children:["-",m(k.discount)]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:"bold",fontSize:"11pt"},children:[e.jsx("span",{children:"T·ªîNG C·ªòNG:"}),e.jsxs("span",{style:{color:"#2563eb"},children:[m(k.total)," ‚Ç´"]})]})]}),(i==null?void 0:i.bank_name)&&e.jsx("div",{style:{marginTop:"2mm",border:"1px solid #ddd",padding:"2mm",borderRadius:"2mm",backgroundColor:"#f0f9ff",fontSize:"7.5pt"},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"2mm"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"1mm",color:"#1e40af",fontSize:"8pt"},children:["Chuy·ªÉn kho·∫£n: ",i.bank_name]}),i.bank_account_number&&e.jsxs("div",{style:{color:"#2563eb",fontWeight:"bold"},children:["STK: ",i.bank_account_number]}),i.bank_account_holder&&e.jsx("div",{children:i.bank_account_holder})]}),i.bank_qr_url&&e.jsx("div",{style:{flexShrink:0},children:e.jsx("img",{src:i.bank_qr_url,alt:"QR Banking",style:{height:"18mm",width:"18mm",objectFit:"contain"}})})]})}),e.jsxs("div",{style:{textAlign:"center",fontSize:"7.5pt",color:"#666",borderTop:"1px dashed #999",paddingTop:"2mm"},children:[e.jsx("div",{children:"C·∫£m ∆°n qu√Ω kh√°ch!"}),e.jsx("div",{children:"H·∫πn g·∫∑p l·∫°i"})]})]})})})]})}),e.jsx(ws,{isOpen:xt,onClose:()=>Je(!1),onScan:is,title:"Qu√©t m√£ v·∫°ch s·∫£n ph·∫©m"})]})};export{Fs as default};
