import{u as $,aa as K,ab as E,ac as O,ad as H,ae as V,af as z,r as s,j as e,i as k,s as P,l as F}from"./index-9wxNecOd.js";import{P as Q}from"./Icons-Dya5WI08.js";const _=()=>{const{currentBranchId:a,setCashTransactions:f,cashTransactions:v,setPaymentSources:o,paymentSources:x}=$(),{data:n=[],isLoading:b}=K(),{data:w=[],isLoading:S}=E(),C=O(),L=H();V();const T=z(),[A,u]=s.useState(!1),[D,g]=s.useState(!1),[d,p]=s.useState(!1),[j,l]=s.useState(null),[r,y]=s.useState(null),m=s.useMemo(()=>{const t=n.reduce((M,R)=>M+R.principal,0),c=n.reduce((M,R)=>M+R.remainingAmount,0),N=t-c,h=n.filter(M=>M.status==="active").length,I=n.filter(M=>M.status==="overdue").length;return{totalLoans:t,totalRemaining:c,totalPaid:N,activeLoans:h,overdueLoans:I}},[n]),i=s.useMemo(()=>({active:n.filter(t=>t.status==="active"),overdue:n.filter(t=>t.status==="overdue"),paid:n.filter(t=>t.status==="paid")}),[n]);return e.jsxs("div",{className:"h-full flex flex-col bg-slate-50 dark:bg-slate-900",children:[e.jsx("div",{className:"bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Quáº£n lÃ½ vá»‘n & vay"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"Theo dÃµi cÃ¡c khoáº£n vay vÃ  lá»‹ch tráº£ ná»£"})]}),e.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:[e.jsx(Q,{className:"w-5 h-5"}),e.jsx("span",{children:"ThÃªm khoáº£n vay"})]})]})}),e.jsx("div",{className:"p-3 md:p-4",children:b||S?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-600"}),e.jsx("span",{className:"ml-3 text-secondary-text",children:"Äang táº£i dá»¯ liá»‡u..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2 md:gap-3 mb-4",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3 border-2 border-blue-200 dark:border-blue-800",children:[e.jsx("div",{className:"text-blue-600 dark:text-blue-400 text-sm font-medium mb-2",children:"Tá»•ng vay"}),e.jsx("div",{className:"text-blue-900 dark:text-blue-100 text-xl md:text-2xl font-bold truncate",children:k(m.totalLoans)})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-3 border-2 border-red-200 dark:border-red-800",children:[e.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm font-medium mb-2",children:"CÃ²n ná»£"}),e.jsx("div",{className:"text-red-900 dark:text-red-100 text-xl md:text-2xl font-bold truncate",children:k(m.totalRemaining)})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3 border-2 border-green-200 dark:border-green-800",children:[e.jsx("div",{className:"text-green-600 dark:text-green-400 text-sm font-medium mb-2",children:"ÄÃ£ tráº£"}),e.jsx("div",{className:"text-green-900 dark:text-green-100 text-xl md:text-2xl font-bold truncate",children:k(m.totalPaid)})]}),e.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 rounded-lg p-3 border-2 border-amber-200 dark:border-amber-800",children:[e.jsx("div",{className:"text-amber-600 dark:text-amber-400 text-sm font-medium mb-2",children:"Äang vay"}),e.jsx("div",{className:"text-amber-900 dark:text-amber-100 text-xl md:text-2xl font-bold",children:m.activeLoans}),e.jsx("div",{className:"text-amber-600 dark:text-amber-400 text-xs mt-1",children:"khoáº£n"})]}),e.jsxs("div",{className:"col-span-2 md:col-span-1 bg-orange-50 dark:bg-orange-900/20 rounded-lg p-3 border-2 border-orange-200 dark:border-orange-800",children:[e.jsx("div",{className:"text-orange-600 dark:text-orange-400 text-sm font-medium mb-2",children:"QuÃ¡ háº¡n"}),e.jsx("div",{className:"text-orange-900 dark:text-orange-100 text-xl md:text-2xl font-bold",children:m.overdueLoans}),e.jsx("div",{className:"text-orange-600 dark:text-orange-400 text-xs mt-1",children:"khoáº£n"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4",children:"CÃ¡c khoáº£n vay Ä‘ang hoáº¡t Ä‘á»™ng"}),i.active.length===0?e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 p-8 text-center text-slate-500 dark:text-slate-400",children:"KhÃ´ng cÃ³ khoáº£n vay nÃ o Ä‘ang hoáº¡t Ä‘á»™ng"}):e.jsx("div",{className:"grid gap-4",children:i.active.map(t=>e.jsx(q,{loan:t,onPayment:()=>{l(t),p(!0)},onEdit:()=>{y(t),g(!0)}},t.id))})]}),i.overdue.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-orange-600 dark:text-orange-400 mb-4",children:"CÃ¡c khoáº£n vay quÃ¡ háº¡n"}),e.jsx("div",{className:"grid gap-4",children:i.overdue.map(t=>e.jsx(q,{loan:t,onPayment:()=>{l(t),p(!0)},onEdit:()=>{y(t),g(!0)},isOverdue:!0},t.id))})]}),i.paid.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4",children:"CÃ¡c khoáº£n vay Ä‘Ã£ thanh toÃ¡n"}),e.jsx("div",{className:"grid gap-4",children:i.paid.map(t=>e.jsx(q,{loan:t,isPaid:!0},t.id))})]})]})}),A&&e.jsx(G,{onClose:()=>u(!1),onSave:async t=>{try{await C.mutateAsync(t),P.success("ÄÃ£ thÃªm khoáº£n vay thÃ nh cÃ´ng"),u(!1)}catch(c){P.error(c.message||"KhÃ´ng thá»ƒ thÃªm khoáº£n vay")}}}),D&&r&&e.jsx(U,{loan:r,onClose:()=>{g(!1),y(null)},onSave:async t=>{try{await L.mutateAsync({id:r.id,updates:t}),P.success("ÄÃ£ cáº­p nháº­t khoáº£n vay thÃ nh cÃ´ng"),g(!1),y(null)}catch(c){P.error(c.message||"KhÃ´ng thá»ƒ cáº­p nháº­t khoáº£n vay")}}}),d&&j&&e.jsx(B,{loan:j,onClose:()=>{p(!1),l(null)},onSave:async t=>{try{await L.mutateAsync({id:j.id,updates:{remainingAmount:t.remainingAmount,status:t.remainingAmount===0?"paid":j.status}}),await T.mutateAsync(t),P.success("ÄÃ£ ghi nháº­n thanh toÃ¡n thÃ nh cÃ´ng");const N={id:`CT-${Date.now()}`,type:"expense",date:t.paymentDate,amount:t.totalAmount,recipient:j.lenderName,notes:`Tráº£ ná»£ vay - ${j.lenderName} (Gá»‘c: ${k(t.principalAmount)}, LÃ£i: ${k(t.interestAmount)})`,paymentSourceId:t.paymentMethod,branchId:a,category:"loan_payment"};f([N,...v]),o(x.map(h=>h.id===t.paymentMethod?{...h,balance:{...h.balance,[a]:(h.balance[a]||0)-t.totalAmount}}:h)),p(!1),l(null)}catch(c){P.error(c.message||"KhÃ´ng thá»ƒ ghi nháº­n thanh toÃ¡n")}}})]})},q=({loan:a,onPayment:f,onEdit:v,isOverdue:o,isPaid:x})=>{const n=(a.principal-a.remainingAmount)/a.principal*100,b=Math.ceil((new Date(a.endDate).getTime()-new Date().getTime())/(1e3*60*60*24));return e.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-lg border-2 p-6 ${o?"border-orange-300 dark:border-orange-700":x?"border-green-300 dark:border-green-700":"border-slate-200 dark:border-slate-700"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:a.lenderName}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a.loanType==="bank"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":a.loanType==="personal"?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400":"bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-400"}`,children:a.loanType==="bank"?"NgÃ¢n hÃ ng":a.loanType==="personal"?"CÃ¡ nhÃ¢n":"KhÃ¡c"})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:a.purpose})]}),!x&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx("button",{onClick:v,className:"px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white rounded-lg text-sm font-medium transition-colors whitespace-nowrap",children:"âœï¸ Sá»­a"}),e.jsx("button",{onClick:f,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors whitespace-nowrap",children:"ðŸ’° Tráº£ ná»£"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Sá»‘ tiá»n vay"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white truncate",children:k(a.principal)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-1",children:"CÃ²n ná»£"}),e.jsx("div",{className:"text-sm font-semibold text-red-600 dark:text-red-400 truncate",children:k(a.remainingAmount)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-1",children:"LÃ£i suáº¥t"}),e.jsxs("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:[a.interestRate,"%/nÄƒm"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Tráº£ hÃ ng thÃ¡ng"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-white truncate",children:k(a.monthlyPayment)})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-400 mb-2",children:[e.jsxs("span",{children:["ÄÃ£ tráº£ ",n.toFixed(1),"%"]}),e.jsx("span",{children:!x&&(o?"QuÃ¡ háº¡n":b>0?`CÃ²n ${b} ngÃ y`:"Äáº¿n háº¡n hÃ´m nay")})]}),e.jsx("div",{className:"h-2 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${o?"bg-orange-500":x?"bg-green-500":"bg-blue-500"}`,style:{width:`${n}%`}})})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 dark:text-slate-400",children:[e.jsxs("span",{children:["NgÃ y vay: ",F(new Date(a.startDate))]}),e.jsxs("span",{children:["Äáº¿n háº¡n: ",F(new Date(a.endDate))]})]})]})},G=({onClose:a,onSave:f})=>{const[v,o]=s.useState(""),[x,n]=s.useState("bank"),[b,w]=s.useState("0"),[S,C]=s.useState("0"),[L,T]=s.useState("12"),[A,u]=s.useState(new Date().toISOString().split("T")[0]),[D,g]=s.useState(""),[d,p]=s.useState(""),j=l=>{l.preventDefault();const r=parseFloat(b),y=parseFloat(S),m=parseInt(L),i=y/100/12,t=r*(i*Math.pow(1+i,m))/(Math.pow(1+i,m)-1),c=new Date(A),N=new Date(c);N.setMonth(N.getMonth()+m);const h={lenderName:v,loanType:x,principal:r,interestRate:y,term:m,startDate:c.toISOString(),endDate:N.toISOString(),remainingAmount:r,monthlyPayment:isNaN(t)?0:t,status:"active",purpose:D,collateral:d};f(h)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl max-w-2xl w-full border border-slate-200 dark:border-slate-700 max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200 dark:border-slate-700 sticky top-0 bg-white dark:bg-slate-800",children:e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white",children:"ThÃªm khoáº£n vay má»›i"})}),e.jsxs("form",{onSubmit:j,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"TÃªn ngÃ¢n hÃ ng/NgÆ°á»i cho vay *"}),e.jsx("input",{type:"text",value:v,onChange:l=>o(l.target.value),className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Loáº¡i vay *"}),e.jsxs("select",{value:x,onChange:l=>n(l.target.value),className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white",children:[e.jsx("option",{value:"bank",children:"NgÃ¢n hÃ ng"}),e.jsx("option",{value:"personal",children:"CÃ¡ nhÃ¢n"}),e.jsx("option",{value:"other",children:"KhÃ¡c"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Sá»‘ tiá»n vay *"}),e.jsx("input",{type:"number",value:b,onChange:l=>w(l.target.value),className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"LÃ£i suáº¥t (%/nÄƒm) *"}),e.jsx("input",{type:"number",step:"0.1",value:S,onChange:l=>C(l.target.value),className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Ká»³ háº¡n (thÃ¡ng) *"}),e.jsx("input",{type:"number",value:L,onChange:l=>T(l.target.value),className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"NgÃ y vay *"}),e.jsx("input",{type:"date",value:A,onChange:l=>u(l.target.value),className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Má»¥c Ä‘Ã­ch vay"}),e.jsx("input",{type:"text",value:D,onChange:l=>g(l.target.value),placeholder:"VÃ­ dá»¥: Má»Ÿ rá»™ng cá»­a hÃ ng, mua thiáº¿t bá»‹...",className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"TÃ i sáº£n tháº¿ cháº¥p"}),e.jsx("input",{type:"text",value:d,onChange:l=>p(l.target.value),placeholder:"VÃ­ dá»¥: Sá»• Ä‘á» nhÃ , giáº¥y tá» xe...",className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-2.5 bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 text-slate-900 dark:text-white rounded-lg font-medium transition-colors",children:"Há»§y"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"ThÃªm khoáº£n vay"})]})]})]})})},U=({loan:a,onClose:f,onSave:v})=>{const[o,x]=s.useState(a.lenderName),[n,b]=s.useState(a.loanType),[w,S]=s.useState(a.principal.toString()),[C,L]=s.useState(a.interestRate.toString()),[T,A]=s.useState(a.term.toString()),[u,D]=s.useState(a.startDate.split("T")[0]),[g,d]=s.useState(a.purpose||""),[p,j]=s.useState(a.collateral||""),l=r=>{r.preventDefault();const y=parseFloat(w),m=parseFloat(C),i=parseInt(T),t=m/100/12,c=y*(t*Math.pow(1+t,i))/(Math.pow(1+t,i)-1),N=new Date(u),h=new Date(N);h.setMonth(h.getMonth()+i);const I={lenderName:o,loanType:n,principal:y,interestRate:m,term:i,startDate:N.toISOString(),endDate:h.toISOString(),monthlyPayment:isNaN(c)?0:c,purpose:g,collateral:p};v(I)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl max-w-2xl w-full border border-slate-200 dark:border-slate-700 max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200 dark:border-slate-700 sticky top-0 bg-white dark:bg-slate-800",children:e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white",children:"Chá»‰nh sá»­a khoáº£n vay"})}),e.jsxs("form",{onSubmit:l,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"TÃªn ngÃ¢n hÃ ng/NgÆ°á»i cho vay *"}),e.jsx("input",{type:"text",value:o,onChange:r=>x(r.target.value),className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Loáº¡i vay *"}),e.jsxs("select",{value:n,onChange:r=>b(r.target.value),className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white",children:[e.jsx("option",{value:"bank",children:"NgÃ¢n hÃ ng"}),e.jsx("option",{value:"personal",children:"CÃ¡ nhÃ¢n"}),e.jsx("option",{value:"other",children:"KhÃ¡c"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Sá»‘ tiá»n vay *"}),e.jsx("input",{type:"number",value:w,onChange:r=>S(r.target.value),className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"LÃ£i suáº¥t (%/nÄƒm) *"}),e.jsx("input",{type:"number",step:"0.1",value:C,onChange:r=>L(r.target.value),className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Ká»³ háº¡n (thÃ¡ng) *"}),e.jsx("input",{type:"number",value:T,onChange:r=>A(r.target.value),className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"NgÃ y vay *"}),e.jsx("input",{type:"date",value:u,onChange:r=>D(r.target.value),className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Má»¥c Ä‘Ã­ch vay"}),e.jsx("input",{type:"text",value:g,onChange:r=>d(r.target.value),placeholder:"VÃ­ dá»¥: Má»Ÿ rá»™ng cá»­a hÃ ng, mua thiáº¿t bá»‹...",className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"TÃ i sáº£n tháº¿ cháº¥p"}),e.jsx("input",{type:"text",value:p,onChange:r=>j(r.target.value),placeholder:"VÃ­ dá»¥: Sá»• Ä‘á» nhÃ , giáº¥y tá» xe...",className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:f,className:"flex-1 px-4 py-2.5 bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 text-slate-900 dark:text-white rounded-lg font-medium transition-colors",children:"Há»§y"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"Cáº­p nháº­t"})]})]})]})})},B=({loan:a,onClose:f,onSave:v})=>{const[o,x]=s.useState(a.monthlyPayment.toString()),[n,b]=s.useState("0"),[w,S]=s.useState("bank"),[C,L]=s.useState(new Date().toISOString().split("T")[0]),[T,A]=s.useState(""),u=parseFloat(o)+parseFloat(n),D=a.remainingAmount-parseFloat(o),g=d=>{d.preventDefault();const p={id:`LOANPAY-${Date.now()}`,loanId:a.id,paymentDate:new Date(C).toISOString(),principalAmount:parseFloat(o),interestAmount:parseFloat(n),totalAmount:u,remainingAmount:Math.max(0,D),paymentMethod:w,notes:T,branchId:a.branchId};v(p)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl max-w-lg w-full border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white",children:["Tráº£ ná»£ - ",a.lenderName]}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:["CÃ²n ná»£: ",k(a.remainingAmount)]})]}),e.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Tiá»n gá»‘c *"}),e.jsx("input",{type:"number",value:o,onChange:d=>x(d.target.value),className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Tiá»n lÃ£i"}),e.jsx("input",{type:"number",value:n,onChange:d=>b(d.target.value),className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white"})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Tá»•ng tiá»n tráº£:"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-white",children:k(u)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"CÃ²n láº¡i sau khi tráº£:"}),e.jsx("span",{className:"font-semibold text-red-600 dark:text-red-400",children:k(Math.max(0,D))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"HÃ¬nh thá»©c thanh toÃ¡n"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"cash",checked:w==="cash",onChange:d=>S(d.target.value),className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-slate-900 dark:text-white",children:"Tiá»n máº·t"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"bank",checked:w==="bank",onChange:d=>S(d.target.value),className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-slate-900 dark:text-white",children:"Chuyá»ƒn khoáº£n"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"NgÃ y tráº£"}),e.jsx("input",{type:"date",value:C,onChange:d=>L(d.target.value),className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Ghi chÃº"}),e.jsx("textarea",{value:T,onChange:d=>A(d.target.value),rows:2,className:"w-full px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:f,className:"flex-1 px-4 py-2.5 bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 text-slate-900 dark:text-white rounded-lg font-medium transition-colors",children:"Há»§y"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"XÃ¡c nháº­n tráº£ ná»£"})]})]})]})})};export{_ as default};
