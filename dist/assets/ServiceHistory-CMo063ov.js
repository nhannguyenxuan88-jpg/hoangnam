import{c as U,u as oe,a1 as xe,r as o,W as v,j as e,i as c,A as he,M,l as q,D as me,n as pe}from"./index-9wxNecOd.js";import{p as ge}from"./print-TOU0k1YY.js";import{P as K}from"./pen-DaXgMpdd.js";import{P}from"./printer-CZA7AzvW.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=U("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=U("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),ke=({currentBranchId:A})=>{var R,I;const{workOrders:F}=oe(),Y=xe(),[w,G]=o.useState(""),[_,ue]=o.useState("all"),[D,X]=o.useState("all"),[N,Q]=o.useState("all"),[h,g]=o.useState("quick"),[u,y]=o.useState("7days"),[S,J]=o.useState(()=>{const t=new Date,s=String(t.getMonth()+1).padStart(2,"0");return`${t.getFullYear()}-${s}`}),[b,Z]=o.useState(""),[j,ee]=o.useState(""),[te,W]=o.useState(!1),se=()=>{const t=new Date,s=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear();return`Th√°ng ${s}/${a}`},[be,je]=o.useState(se()),[x,B]=o.useState(null),[ae,L]=o.useState(!1),[l,le]=o.useState(null);o.useEffect(()=>{(async()=>{try{const{data:s,error:a}=await pe.from("store_settings").select("store_name, address, phone, email, logo_url, bank_qr_url, bank_name, bank_account_number, bank_account_holder, bank_branch").order("created_at",{ascending:!1}).limit(1).single();if(a){console.error("Error fetching store settings:",a);return}le(s)}catch(s){console.error("Failed to fetch store settings:",s)}})()},[]);const ne=()=>{const t=new Date,s=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(h==="quick")switch(u){case"today":return{start:s,end:new Date(s.getFullYear(),s.getMonth(),s.getDate(),23,59,59)};case"yesterday":const a=new Date(s);return a.setDate(a.getDate()-1),{start:a,end:new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59)};case"3days":const n=new Date(s);return n.setDate(n.getDate()-2),{start:n,end:new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59)};case"7days":const i=new Date(s);return i.setDate(i.getDate()-6),{start:i,end:new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59)};case"thisWeek":const r=new Date(s),d=r.getDay(),m=r.getDate()-d+(d===0?-6:1);return r.setDate(m),{start:r,end:new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59)};case"lastWeek":const p=new Date(s),H=p.getDay(),k=p.getDate()-H-6;p.setDate(k);const T=new Date(p);return T.setDate(T.getDate()+6),T.setHours(23,59,59),{start:p,end:T};default:return{start:s,end:new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59)}}else if(h==="month"){const[a,n]=S.split("-").map(Number),i=new Date(a,n-1,1),r=new Date(a,n,0,23,59,59);return{start:i,end:r}}else if(h==="custom"&&b&&j){const a=new Date(b),n=new Date(j);return n.setHours(23,59,59),{start:a,end:n}}return{start:new Date(t.getFullYear(),t.getMonth(),1),end:new Date(t.getFullYear(),t.getMonth()+1,0,23,59,59)}},ie=()=>{if(h==="quick")switch(u){case"today":return"H√¥m nay";case"yesterday":return"H√¥m qua";case"3days":return"3 ng√†y qua";case"7days":return"7 ng√†y qua";case"thisWeek":return"Tu·∫ßn n√†y";case"lastWeek":return"Tu·∫ßn tr∆∞·ªõc";default:return"Ch·ªçn th·ªùi gian"}else if(h==="month"){const[t,s]=S.split("-");return`Th√°ng ${s}/${t}`}else if(h==="custom"){if(b&&j){const t=new Date(b).toLocaleDateString("vi-VN"),s=new Date(j).toLocaleDateString("vi-VN");return`${t} - ${s}`}return"T√πy ch·ªânh"}return"Ch·ªçn th·ªùi gian"},f=o.useMemo(()=>{const{start:t,end:s}=ne();return F.filter(a=>{var n,i,r,d,m;if(a.status!==v.DELIVERED||a.branchId!==A)return!1;if(w){const p=w.toLowerCase();if(![(n=a.id)==null?void 0:n.toLowerCase(),(i=a.customerName)==null?void 0:i.toLowerCase(),(r=a.customerPhone)==null?void 0:r.toLowerCase(),(d=a.vehicleModel)==null?void 0:d.toLowerCase(),(m=a.licensePlate)==null?void 0:m.toLowerCase()].some(k=>k==null?void 0:k.includes(p)))return!1}if(_!=="all"&&a.status!==_||D!=="all"&&a.technicianName!==D||N!=="all"&&(N==="paid"&&a.paymentStatus!=="paid"||N==="unpaid"&&a.paymentStatus!=="unpaid"))return!1;if(a.creationDate){const p=new Date(a.creationDate);if(p<t||p>s)return!1}return!0}).sort((a,n)=>new Date(n.creationDate||0).getTime()-new Date(a.creationDate||0).getTime())},[F,w,_,h,u,S,b,j,D,N,A]),re=f.reduce((t,s)=>t+(s.total||0),0),de=()=>{const s=[["M√£ Phi·∫øu","Ng√†y t·∫°o","Kh√°ch h√†ng","Xe","Bi·ªÉn s·ªë","Tr·∫°ng th√°i","T·ªïng chi ph√≠"].join(","),...f.map(i=>{var r;return[M(i.id,l==null?void 0:l.work_order_prefix)||"",q(i.creationDate,!0),i.customerName||"",i.vehicleModel||"",i.licensePlate||"",i.status||"",((r=i.total)==null?void 0:r.toString())||"0"].join(",")})].join(`
`),a=new Blob([s],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");if(n.download!==void 0){const i=URL.createObjectURL(a);n.setAttribute("href",i),n.setAttribute("download",`lich-su-sua-chua-${new Date().toISOString().split("T")[0]}.csv`),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)}},C=t=>{B(t),L(!0)},E=t=>{Y("/service",{state:{editOrder:t}})},ce=()=>{setTimeout(()=>{ge("work-order-receipt")},100)},$=({status:t})=>{const s={[v.RECEIVED]:{icon:"üìã",color:"text-blue-600 dark:text-blue-400"},[v.IN_PROGRESS]:{icon:"üîß",color:"text-orange-600 dark:text-orange-400"},[v.COMPLETED]:{icon:"‚úì",color:"text-purple-600 dark:text-purple-400"},[v.DELIVERED]:{icon:"‚úì",color:"text-green-600 dark:text-green-400"}},a=s[t]||s[v.RECEIVED];return e.jsxs("span",{className:`flex items-center gap-1 text-sm ${a.color}`,children:[e.jsx("span",{children:a.icon}),e.jsx("span",{children:t})]})},V=({status:t})=>t==="paid"?e.jsx("span",{className:"text-xs text-green-600 dark:text-green-400",children:"‚úì ƒê√£ thanh to√°n"}):e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:"‚óã Ch∆∞a thanh to√°n"});return e.jsxs("div",{className:"space-y-4 md:space-y-6 px-4 md:px-0",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 md:gap-4",children:[e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-3 md:p-4 border border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs md:text-sm text-slate-600 dark:text-slate-400",children:"T·ªïng phi·∫øu"}),e.jsx("p",{className:"text-xl md:text-2xl font-bold text-slate-900 dark:text-slate-100",children:f.length})]}),e.jsx("div",{className:"p-2 md:p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:e.jsx(z,{className:"w-5 h-5 md:w-6 md:h-6 text-blue-600 dark:text-blue-400"})})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-3 md:p-4 border border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs md:text-sm text-slate-600 dark:text-slate-400",children:"T·ªïng doanh thu"}),e.jsx("p",{className:"text-lg md:text-2xl font-bold text-green-600 dark:text-green-400",children:c(re)})]}),e.jsx("div",{className:"p-2 md:p-3 bg-green-100 dark:bg-green-900/30 rounded-lg",children:e.jsx(O,{className:"w-5 h-5 md:w-6 md:h-6 text-green-600 dark:text-green-400"})})]})}),e.jsx("div",{className:"col-span-2 md:col-span-1 bg-white dark:bg-slate-800 rounded-xl p-3 md:p-4 border border-slate-200 dark:border-slate-700",children:e.jsxs("button",{onClick:de,className:"w-full px-4 py-2 bg-cyan-500 hover:bg-cyan-600 text-white rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",children:[e.jsx(O,{className:"w-4 h-4"}),"Xu·∫•t Excel"]})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-3 md:p-4 border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsx("input",{type:"text",placeholder:"T√¨m theo m√£, t√™n, SƒêT, xe,...",value:w,onChange:t=>G(t.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-sm text-slate-900 dark:text-slate-100 placeholder-slate-400"}),e.jsx(he,{className:"absolute left-3 top-3 w-4 h-4 text-slate-400","aria-hidden":"true"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("button",{onClick:()=>W(!0),className:"flex-1 md:flex-none px-3 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-xs md:text-sm text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-600 transition-colors flex items-center justify-center gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{className:"truncate",children:ie()})]}),e.jsxs("select",{value:D,onChange:t=>X(t.target.value),className:"flex-1 md:flex-none px-3 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-xs md:text-sm text-slate-700 dark:text-slate-200",children:[e.jsx("option",{value:"all",children:"T·∫•t c·∫£ KTV"}),e.jsx("option",{value:"KTV 1",children:"KTV 1"}),e.jsx("option",{value:"KTV 2",children:"KTV 2"})]}),e.jsxs("select",{value:N,onChange:t=>Q(t.target.value),className:"flex-1 md:flex-none px-3 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-xs md:text-sm text-slate-700 dark:text-slate-200",children:[e.jsx("option",{value:"all",children:"T·∫•t c·∫£ thanh to√°n"}),e.jsx("option",{value:"paid",children:"ƒê√£ thanh to√°n"}),e.jsx("option",{value:"unpaid",children:"Ch∆∞a thanh to√°n"})]})]})]}),te&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl w-full max-w-lg shadow-2xl",children:[e.jsx("div",{className:"border-b border-slate-200 dark:border-slate-700 px-6 py-4",children:e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:"Ch·ªçn th·ªùi gian:"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Theo ng√†y:"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("button",{onClick:()=>{g("quick"),y("today")},className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${h==="quick"&&u==="today"?"bg-blue-500 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:"H√¥m nay"}),e.jsx("button",{onClick:()=>{g("quick"),y("yesterday")},className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${h==="quick"&&u==="yesterday"?"bg-blue-500 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:"H√¥m qua"}),e.jsx("button",{onClick:()=>{g("quick"),y("3days")},className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${h==="quick"&&u==="3days"?"bg-blue-500 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:"3 ng√†y qua"}),e.jsx("button",{onClick:()=>{g("quick"),y("thisWeek")},className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${h==="quick"&&u==="thisWeek"?"bg-blue-500 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:"Tu·∫ßn n√†y"}),e.jsx("button",{onClick:()=>{g("quick"),y("lastWeek")},className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${h==="quick"&&u==="lastWeek"?"bg-blue-500 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:"Tu·∫ßn tr∆∞·ªõc"}),e.jsx("button",{onClick:()=>{g("quick"),y("7days")},className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${h==="quick"&&u==="7days"?"bg-blue-500 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:"‚úì 7 ng√†y qua"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Theo th√°ng:"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:[0,1,2,3,4,5].map(t=>{const s=new Date;s.setMonth(s.getMonth()-t);const a=s.getFullYear(),n=String(s.getMonth()+1).padStart(2,"0"),i=`${a}-${n}`,r=`Th√°ng ${n}/${a}`;return e.jsx("button",{onClick:()=>{g("month"),J(i)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${h==="month"&&S===i?"bg-slate-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:r},i)})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"T√πy ch·ªânh:"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"date",value:b,onChange:t=>{Z(t.target.value),t.target.value&&j&&g("custom")},className:"flex-1 px-3 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-sm text-slate-900 dark:text-slate-100"}),e.jsx("span",{className:"text-slate-500",children:"-"}),e.jsx("input",{type:"date",value:j,onChange:t=>{ee(t.target.value),b&&t.target.value&&g("custom")},className:"flex-1 px-3 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-sm text-slate-900 dark:text-slate-100"})]})]})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 px-6 py-4 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>W(!1),className:"px-4 py-2 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 text-slate-700 dark:text-slate-300 rounded-lg text-sm font-medium transition-colors",children:"H·ªßy"}),e.jsx("button",{onClick:()=>W(!1),className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-sm font-medium transition-colors",children:"√Åp d·ª•ng"})]})]})}),e.jsxs("div",{className:"hidden md:block bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"px-4 py-3 bg-slate-50 dark:bg-slate-700/50 border-b border-slate-200 dark:border-slate-600",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 text-center",children:e.jsx("input",{type:"checkbox",className:"rounded border-slate-400"})}),e.jsx("div",{className:"flex-1 min-w-[180px]",children:e.jsx("span",{className:"text-xs font-semibold text-slate-600 dark:text-slate-300 uppercase",children:"M√£ phi·∫øu"})}),e.jsx("div",{className:"flex-1 min-w-[180px]",children:e.jsx("span",{className:"text-xs font-semibold text-slate-600 dark:text-slate-300 uppercase",children:"Kh√°ch h√†ng"})}),e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsx("span",{className:"text-xs font-semibold text-slate-600 dark:text-slate-300 uppercase",children:"Chi ti·∫øt"})}),e.jsx("div",{className:"w-56",children:e.jsx("span",{className:"text-xs font-semibold text-slate-600 dark:text-slate-300 uppercase",children:"H·∫πn tr·∫£"})}),e.jsx("div",{className:"w-24 text-center",children:e.jsx("span",{className:"text-xs font-semibold text-slate-600 dark:text-slate-300 uppercase",children:"Thao t√°c"})})]})}),f.length===0?e.jsx("div",{className:"px-4 py-12 text-center text-slate-400",children:"Kh√¥ng c√≥ phi·∫øu s·ª≠a ch·ªØa n√†o."}):e.jsx("div",{className:"divide-y divide-slate-700",children:f.map(t=>{var i,r;const s=((i=t.partsUsed)==null?void 0:i.reduce((d,m)=>d+m.quantity*m.price,0))||0,a=((r=t.additionalServices)==null?void 0:r.reduce((d,m)=>d+(m.price||0)*(m.quantity||1),0))||0,n=t.laborCost||0;return e.jsx("div",{className:"px-4 py-4 bg-slate-900 dark:bg-slate-950 hover:bg-slate-800 dark:hover:bg-slate-900 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"w-16 flex flex-col items-center gap-2 pt-1",children:[e.jsx("input",{type:"checkbox",className:"rounded border-slate-600"}),e.jsx("div",{className:"w-10 h-10 bg-slate-800 dark:bg-slate-700 rounded flex items-center justify-center flex-shrink-0",children:e.jsx(z,{className:"w-5 h-5 text-slate-400"})})]}),e.jsxs("div",{className:"flex-1 min-w-[180px]",children:[e.jsx("div",{className:"font-mono font-bold text-blue-400 text-sm mb-1",children:M(t.id,l==null?void 0:l.work_order_prefix)}),e.jsxs("div",{className:"text-xs text-slate-400",children:[e.jsx("span",{children:"Ng√†y: "}),e.jsx("span",{className:"text-slate-300",children:q(t.creationDate,!0)})]}),e.jsxs("div",{className:"text-xs text-cyan-400",children:["NV: ",t.technicianName||"Ch∆∞a ph√¢n c√¥ng"]})]}),e.jsxs("div",{className:"flex-1 min-w-[180px]",children:[e.jsx("div",{className:"font-semibold text-base text-white mb-1",children:t.customerName}),e.jsx("div",{className:"text-xs text-slate-400",children:t.customerPhone}),e.jsxs("div",{className:"text-xs text-slate-400",children:[e.jsx("span",{className:"font-medium",children:"Xe: "}),e.jsx("span",{children:t.vehicleModel||"N/A"}),t.licensePlate&&e.jsxs("span",{className:"ml-1",children:["- ",t.licensePlate]})]}),e.jsx("div",{className:"text-xs text-slate-500 italic mt-1",children:t.issueDescription||"Kh√¥ng c√≥ m√¥ t·∫£"})]}),e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"space-y-1",children:[t.partsUsed&&t.partsUsed.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("div",{className:"text-xs font-medium text-slate-400 mb-0.5",children:"Ph·ª• t√πng:"}),e.jsx("div",{className:"space-y-0.5",children:t.partsUsed.map((d,m)=>e.jsxs("div",{className:"text-xs text-slate-300",children:["‚Ä¢ ",d.partName," x",d.quantity]},m))})]}),t.additionalServices&&t.additionalServices.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("div",{className:"text-xs font-medium text-slate-400 mb-0.5",children:"Gia c√¥ng/ƒê·∫∑t h√†ng:"}),e.jsx("div",{className:"space-y-0.5",children:t.additionalServices.map((d,m)=>e.jsxs("div",{className:"text-xs text-slate-300",children:["‚Ä¢ ",d.description," x",d.quantity||1]},m))})]}),e.jsx("div",{className:"mt-2",children:e.jsx($,{status:t.status||"Ti·∫øp nh·∫≠n"})}),(!t.partsUsed||t.partsUsed.length===0)&&(!t.additionalServices||t.additionalServices.length===0)&&e.jsx("div",{className:"text-xs text-slate-500 italic mb-2",children:"Ch∆∞a c√≥ chi ti·∫øt"})]})}),e.jsxs("div",{className:"w-56",children:[e.jsxs("div",{className:"space-y-1 text-xs text-right mb-3",children:[n>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:"Ti·ªÅn c√¥ng:"}),e.jsx("span",{className:"text-slate-300",children:c(n)})]}),s>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:"Ti·ªÅn ph·ª• t√πng:"}),e.jsx("span",{className:"text-blue-400 font-medium",children:c(s)})]}),a>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:"Gi√° c√¥ng/ƒê·∫∑t h√†ng:"}),e.jsx("span",{className:"text-slate-300",children:c(a)})]}),t.total>0&&e.jsxs("div",{className:"flex justify-between pt-2 border-t border-slate-700 text-sm",children:[e.jsx("span",{className:"text-slate-300 font-bold",children:"T·ªïng c·ªông:"}),e.jsx("span",{className:"text-blue-400 font-bold text-sm",children:c(t.total)})]}),t.discount&&t.discount>0&&e.jsxs("div",{className:"flex justify-between text-right text-xs",children:[e.jsx("span",{className:"text-red-500",children:"Gi·∫£m gi√°:"}),e.jsx("span",{className:"text-red-500",children:c(t.discount)})]}),t.additionalPayment&&t.additionalPayment>0&&e.jsxs("div",{className:"flex justify-between text-right text-xs text-green-500",children:[e.jsx("span",{children:"Thanh to√°n tr∆∞·ªõc:"}),e.jsxs("span",{children:["-",c(t.additionalPayment)]})]}),t.remainingAmount!==void 0&&t.remainingAmount>0&&e.jsxs("div",{className:"flex justify-between text-right text-xs mt-1",children:[e.jsx("span",{children:"C√≤n ph·∫£i thu:"}),e.jsx("span",{className:`font-bold ${t.remainingAmount>0?"text-red-500":"text-green-500"}`,children:c(t.remainingAmount)})]})]}),e.jsx("div",{className:"mt-2",children:e.jsx(V,{status:t.paymentStatus})})]}),e.jsxs("div",{className:"w-24 flex flex-col items-center gap-2",children:[e.jsxs("button",{onClick:()=>E(t),className:"px-4 py-1.5 bg-cyan-500 hover:bg-cyan-600 text-white text-sm rounded-md transition-colors min-w-[70px] flex items-center justify-center gap-1",title:"Ch·ªânh s·ª≠a phi·∫øu",children:[e.jsx(K,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"S·ª≠a"})]}),e.jsxs("button",{onClick:()=>C(t),className:"px-4 py-1.5 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-md transition-colors min-w-[70px] flex items-center justify-center gap-1",children:[e.jsx("span",{children:"‚úèÔ∏è"}),e.jsx("span",{children:"Xem"})]}),e.jsx("button",{onClick:()=>C(t),className:"p-2 text-slate-400 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 dark:hover:text-blue-400 rounded transition-colors",title:"In phi·∫øu d·ªãch v·ª•",children:e.jsx(P,{className:"w-4 h-4"})})]})]})},t.id)})})]}),e.jsx("div",{className:"md:hidden space-y-3",children:f.length===0?e.jsx("div",{className:"bg-slate-800 rounded-xl p-8 text-center text-slate-400",children:"Kh√¥ng c√≥ phi·∫øu s·ª≠a ch·ªØa n√†o."}):f.map(t=>{var n,i;const s=((n=t.partsUsed)==null?void 0:n.reduce((r,d)=>r+d.quantity*d.price,0))||0,a=((i=t.additionalServices)==null?void 0:i.reduce((r,d)=>r+(d.price||0)*(d.quantity||1),0))||0;return e.jsxs("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 bg-slate-700/50 border-b border-slate-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-600 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(z,{className:"w-5 h-5 text-slate-300"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-bold text-blue-400 text-sm",children:M(t.id,l==null?void 0:l.work_order_prefix)}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Ng√†y: ",q(t.creationDate,!0)]}),e.jsxs("div",{className:"text-xs text-cyan-400",children:["NV: ",t.technicianName||"Ch∆∞a ph√¢n c√¥ng"]})]})]}),e.jsx($,{status:t.status||"Ti·∫øp nh·∫≠n"})]}),e.jsxs("div",{className:"px-4 py-3 border-b border-slate-700",children:[e.jsx("div",{className:"font-semibold text-white text-base",children:t.customerName}),e.jsx("div",{className:"text-sm text-slate-400",children:t.customerPhone}),e.jsxs("div",{className:"text-sm text-slate-400 mt-1",children:["Xe: ",t.vehicleModel||"N/A"," -"," ",t.licensePlate||"N/A"]}),t.issueDescription&&e.jsx("div",{className:"text-xs text-slate-500 italic mt-1",children:t.issueDescription})]}),e.jsxs("div",{className:"px-4 py-3 space-y-2",children:[t.laborCost>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-400",children:"Ti·ªÅn c√¥ng:"}),e.jsx("span",{className:"text-slate-300",children:c(t.laborCost)})]}),s>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-400",children:"Ph·ª• t√πng:"}),e.jsx("span",{className:"text-blue-400",children:c(s)})]}),a>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-400",children:"Gia c√¥ng:"}),e.jsx("span",{className:"text-slate-300",children:c(a)})]}),e.jsxs("div",{className:"flex justify-between text-sm font-bold pt-2 border-t border-slate-700",children:[e.jsx("span",{className:"text-slate-300",children:"T·ªïng c·ªông:"}),e.jsx("span",{className:"text-green-400",children:c(t.total)})]}),t.remainingAmount>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-400",children:"C√≤n ph·∫£i thu:"}),e.jsx("span",{className:"text-red-400 font-bold",children:c(t.remainingAmount)})]}),e.jsx("div",{className:"pt-2",children:e.jsx(V,{status:t.paymentStatus})})]}),e.jsxs("div",{className:"px-4 py-3 bg-slate-700/30 border-t border-slate-700 flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>E(t),className:"flex-1 px-3 py-2 bg-cyan-500 hover:bg-cyan-600 text-white text-sm rounded-lg transition-colors flex items-center justify-center gap-1",children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:"S·ª≠a"})]}),e.jsxs("button",{onClick:()=>C(t),className:"flex-1 px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-lg transition-colors flex items-center justify-center gap-1",children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{children:"In"})]}),e.jsx("button",{onClick:()=>C(t),className:"px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white text-sm rounded-lg transition-colors flex items-center justify-center",children:e.jsx(me,{className:"w-4 h-4"})})]})]},t.id)})}),ae&&x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-2 md:p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl w-full max-w-4xl max-h-[95vh] md:max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 px-3 md:px-6 py-3 md:py-4 flex items-center justify-between rounded-t-xl flex-shrink-0",children:[e.jsx("h2",{className:"text-base md:text-xl font-bold text-slate-900 dark:text-slate-100",children:"Xem tr∆∞·ªõc phi·∫øu in"}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[e.jsxs("button",{onClick:ce,className:"px-3 md:px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center gap-1.5 md:gap-2 transition text-sm md:text-base",children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:"In phi·∫øu"}),e.jsx("span",{className:"md:hidden",children:"In"})]}),e.jsx("button",{onClick:()=>{L(!1),B(null)},className:"p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition","aria-label":"ƒê√≥ng",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-2 md:p-6 bg-slate-100 dark:bg-slate-900",children:e.jsx("div",{className:"bg-white shadow-lg mx-auto overflow-x-auto",style:{maxWidth:"148mm",minWidth:"320px",color:"#000"},children:e.jsxs("div",{style:{padding:"10mm"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto 1fr",gap:"3mm",marginBottom:"4mm",alignItems:"start",borderBottom:"2px solid #3b82f6",paddingBottom:"3mm"},children:[e.jsxs("div",{style:{fontSize:"8.5pt",lineHeight:"1.4"},children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"11pt",marginBottom:"1mm",color:"#1e40af"},children:(l==null?void 0:l.store_name)||"Nh·∫°n L√¢m SmartCare"}),e.jsxs("div",{style:{color:"#000",display:"flex",alignItems:"center",gap:"1mm"},children:[e.jsx("svg",{style:{width:"10px",height:"10px",flexShrink:0},viewBox:"0 0 24 24",fill:"#ef4444",children:e.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})}),e.jsx("span",{children:(l==null?void 0:l.address)||"·∫§p Ph√∫ L·ª£i B, X√£ Long Ph√∫ Thu·∫≠n, ƒê√¥ng Th√°p"})]}),e.jsxs("div",{style:{color:"#000",display:"flex",alignItems:"center",gap:"1mm"},children:[e.jsx("svg",{style:{width:"10px",height:"10px",flexShrink:0},viewBox:"0 0 24 24",fill:"#16a34a",children:e.jsx("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})}),e.jsx("span",{children:(l==null?void 0:l.phone)||"0947.747.907"})]}),(l==null?void 0:l.email)&&e.jsxs("div",{style:{color:"#000",display:"flex",alignItems:"center",gap:"1mm"},children:[e.jsx("svg",{style:{width:"10px",height:"10px",flexShrink:0},viewBox:"0 0 24 24",fill:"#3b82f6",children:e.jsx("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})}),e.jsx("span",{children:l.email})]})]}),(l==null?void 0:l.logo_url)&&e.jsx("div",{style:{textAlign:"center"},children:e.jsx("img",{src:l.logo_url,alt:"Logo",style:{height:"15mm",width:"auto",objectFit:"contain"}})}),e.jsx("div",{style:{fontSize:"8pt",lineHeight:"1.4",textAlign:"right"},children:(l==null?void 0:l.bank_name)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"1mm",color:"#000",display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"1mm"},children:[e.jsx("svg",{style:{width:"10px",height:"10px",flexShrink:0},viewBox:"0 0 24 24",fill:"#0891b2",children:e.jsx("path",{d:"M4 10h3v7H4zm6.5 0h3v7h-3zM2 19h20v3H2zm15-9h3v7h-3zm-5-9L2 6v2h20V6z"})}),e.jsx("span",{children:l.bank_name})]}),l.bank_account_number&&e.jsxs("div",{style:{color:"#000"},children:["STK: ",l.bank_account_number]}),l.bank_account_holder&&e.jsx("div",{style:{color:"#000",fontSize:"7.5pt"},children:l.bank_account_holder}),l.bank_qr_url&&e.jsx("div",{style:{marginTop:"2mm",display:"inline-block"},children:e.jsx("img",{src:l.bank_qr_url,alt:"QR Banking",style:{height:"15mm",width:"15mm",objectFit:"contain"}})})]})})]}),e.jsxs("div",{style:{marginBottom:"4mm"},children:[e.jsx("div",{style:{textAlign:"center",marginBottom:"2mm"},children:e.jsx("h1",{style:{fontSize:"16pt",fontWeight:"bold",margin:"0",textTransform:"uppercase",color:"#1e40af"},children:"PHI·∫æU D·ªäCH V·ª§ S·ª¨A CH·ªÆA"})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"9pt",color:"#666"},children:[e.jsx("div",{children:new Date(x.creationDate).toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}),e.jsxs("div",{style:{fontWeight:"bold"},children:["M√£:"," ",M(x.id,l==null?void 0:l.work_order_prefix)]})]})]}),e.jsxs("div",{style:{border:"1px solid #ddd",padding:"3mm",marginBottom:"3mm",borderRadius:"2mm",backgroundColor:"#f8fafc",color:"#000",fontSize:"9pt"},children:[e.jsxs("div",{style:{display:"flex",gap:"4mm",marginBottom:"1.5mm"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("span",{style:{fontWeight:"bold"},children:"Kh√°ch h√†ng:"})," ",x.customerName]}),e.jsxs("div",{style:{flex:"0 0 auto"},children:[e.jsx("span",{style:{fontWeight:"bold"},children:"SƒêT:"})," ",x.customerPhone]})]}),e.jsxs("div",{style:{display:"flex",gap:"4mm"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("span",{style:{fontWeight:"bold"},children:"Lo·∫°i xe:"})," ",x.vehicleModel]}),e.jsxs("div",{style:{flex:"0 0 auto"},children:[e.jsx("span",{style:{fontWeight:"bold"},children:"Bi·ªÉn s·ªë:"})," ",x.licensePlate]})]})]}),e.jsx("div",{style:{border:"1px solid #ddd",padding:"4mm",marginBottom:"4mm",borderRadius:"2mm",color:"#000"},children:e.jsxs("div",{style:{display:"flex",gap:"3mm"},children:[e.jsx("div",{style:{fontWeight:"bold",minWidth:"20%",flexShrink:0},children:"M√¥ t·∫£ s·ª± c·ªë:"}),e.jsx("div",{style:{flex:1,whiteSpace:"pre-wrap"},children:x.issueDescription||"Kh√¥ng c√≥ m√¥ t·∫£"})]})}),x.partsUsed&&x.partsUsed.length>0&&e.jsxs("div",{style:{marginBottom:"4mm",color:"#000"},children:[e.jsx("p",{style:{fontWeight:"bold",margin:"0 0 2mm 0",fontSize:"11pt"},children:"Ph·ª• t√πng s·ª≠ d·ª•ng:"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #ddd"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f5f5f5"},children:[e.jsx("th",{style:{border:"1px solid #ddd",padding:"2mm",textAlign:"left",fontSize:"10pt"},children:"T√™n ph·ª• t√πng"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"2mm",textAlign:"center",fontSize:"10pt",width:"15%"},children:"SL"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"2mm",textAlign:"right",fontSize:"10pt",width:"25%"},children:"ƒê∆°n gi√°"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"2mm",textAlign:"right",fontSize:"10pt",width:"25%"},children:"Th√†nh ti·ªÅn"})]})}),e.jsx("tbody",{children:x.partsUsed.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{style:{border:"1px solid #ddd",padding:"2mm",fontSize:"10pt"},children:t.partName}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"2mm",textAlign:"center",fontSize:"10pt"},children:t.quantity}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"2mm",textAlign:"right",fontSize:"10pt"},children:c(t.price)}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"2mm",textAlign:"right",fontSize:"10pt",fontWeight:"bold"},children:c(t.price*t.quantity)})]},s))})]})]}),e.jsx("div",{style:{border:"1px solid #ddd",padding:"4mm",marginBottom:"4mm",borderRadius:"2mm",backgroundColor:"#f9f9f9",color:"#000"},children:e.jsx("table",{style:{width:"100%",borderSpacing:"0",color:"#000"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:"bold",paddingBottom:"2mm",fontSize:"10pt"},children:"Ti·ªÅn ph·ª• t√πng:"}),e.jsx("td",{style:{textAlign:"right",paddingBottom:"2mm",fontSize:"10pt"},children:c(((R=x.partsUsed)==null?void 0:R.reduce((t,s)=>t+s.price*s.quantity,0))||0)})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:"bold",paddingBottom:"2mm",fontSize:"10pt"},children:"Ph√≠ d·ªãch v·ª•:"}),e.jsx("td",{style:{textAlign:"right",paddingBottom:"2mm",fontSize:"10pt"},children:c(x.laborCost||0)})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:"bold",paddingBottom:"2mm",fontSize:"10pt"},children:"Gi√° c√¥ng/ƒê·∫∑t h√†ng:"}),e.jsx("td",{style:{textAlign:"right",paddingBottom:"2mm",fontSize:"10pt"},children:c(((I=x.additionalServices)==null?void 0:I.reduce((t,s)=>t+(s.price||0)*(s.quantity||1),0))||0)})]}),e.jsxs("tr",{style:{borderTop:"2px solid #333"},children:[e.jsx("td",{style:{fontWeight:"bold",paddingTop:"2mm",fontSize:"12pt"},children:"T·ªîNG C·ªòNG:"}),e.jsxs("td",{style:{textAlign:"right",paddingTop:"2mm",fontSize:"12pt",fontWeight:"bold",color:"#2563eb"},children:[c(x.total)," ‚Ç´"]})]})]})})}),e.jsx("div",{style:{marginTop:"8mm",paddingTop:"4mm",borderTop:"1px dashed #999",color:"#000"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"10pt"},children:[e.jsxs("div",{style:{textAlign:"center",width:"45%"},children:[e.jsx("p",{style:{fontWeight:"bold",margin:"0 0 10mm 0",color:"#000"},children:"Kh√°ch h√†ng"}),e.jsx("p",{style:{margin:"0",fontSize:"9pt",color:"#666"},children:"(K√Ω v√† ghi r√µ h·ªç t√™n)"})]}),e.jsxs("div",{style:{textAlign:"center",width:"45%"},children:[e.jsx("p",{style:{fontWeight:"bold",margin:"0 0 10mm 0",color:"#000"},children:"Nh√¢n vi√™n"}),e.jsx("p",{style:{margin:"0",fontSize:"9pt",color:"#666"},children:"(K√Ω v√† ghi r√µ h·ªç t√™n)"})]})]})}),e.jsxs("div",{style:{marginTop:"4mm",padding:"3mm",backgroundColor:"#fff9e6",border:"1px solid #ffd700",borderRadius:"2mm",fontSize:"9pt",textAlign:"center",color:"#000"},children:[e.jsx("p",{style:{margin:"0",fontStyle:"italic",color:"#000"},children:"C·∫£m ∆°n qu√Ω kh√°ch ƒë√£ s·ª≠ d·ª•ng d·ªãch v·ª•!"}),e.jsx("p",{style:{margin:"1mm 0 0 0",fontStyle:"italic",color:"#000"},children:"Vui l√≤ng gi·ªØ phi·∫øu n√†y ƒë·ªÉ ƒë·ªëi chi·∫øu khi nh·∫≠n xe"})]})]})})})]})}),e.jsx("div",{id:"work-order-receipt",className:"hidden"})]})};export{ke as ServiceHistory,ke as default};
